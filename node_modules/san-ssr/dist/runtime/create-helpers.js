"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.createHelpers = exports.emitHelpers = exports.emitHelpersAsIIFE = void 0;
const path_1 = require("path");
const underscore_1 = require("./underscore");
const resolver_1 = require("./resolver");
const san_data_1 = require("./san-data");
const fs_1 = require("../utils/fs");
/**
 * 编译成源代码时，需要包含的运行时文件
 */
const HELPER_FILES = [
    path_1.resolve(__dirname, '../../dist/runtime/underscore.js'),
    path_1.resolve(__dirname, '../../dist/runtime/san-data.js'),
    path_1.resolve(__dirname, '../../dist/runtime/resolver.js')
];
/**
 * 产出运行时代码
 */
function emitHelpersAsIIFE(emitter) {
    emitter.feedLine('(function (exports) {');
    emitter.indent();
    emitHelpers(emitter);
    emitter.writeLine('return exports;');
    emitter.unindent();
    emitter.writeLine('})({});');
}
exports.emitHelpersAsIIFE = emitHelpersAsIIFE;
/**
 * 产出运行时代码
 */
function emitHelpers(emitter) {
    for (const file of HELPER_FILES) {
        emitter.writeLines(fs_1.readStringSync(file));
        emitter.carriageReturn();
    }
}
exports.emitHelpers = emitHelpers;
/**
 * 编译成 render 函数时，使用的 helper
 */
function createHelpers() {
    return { _: underscore_1._, SanData: san_data_1.SanData, createResolver: resolver_1.createResolver };
}
exports.createHelpers = createHelpers;
//# sourceMappingURL=create-helpers.js.map
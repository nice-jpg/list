{"remainingRequest":"/Users/liaohuanyu/projects/baidu-work/baidu/feed3/multi-pages/node_modules/babel-loader/lib/index.js??ref--1-2!/Users/liaohuanyu/projects/baidu-work/baidu/feed3/multi-pages/node_modules/@baidu/nano/es/utils/stickiness.js","dependencies":[{"path":"/Users/liaohuanyu/projects/baidu-work/baidu/feed3/multi-pages/node_modules/@baidu/nano/es/utils/stickiness.js","mtime":1696919503876},{"path":"/Users/liaohuanyu/projects/baidu-work/baidu/feed3/multi-pages/node_modules/san-hot-loader/index.js","mtime":1696919525187},{"path":"/Users/liaohuanyu/projects/baidu-work/baidu/feed3/multi-pages/node_modules/cache-loader/dist/cjs.js","mtime":1696919513896},{"path":"/Users/liaohuanyu/projects/baidu-work/baidu/feed3/multi-pages/node_modules/babel-loader/lib/index.js","mtime":1696919524615}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZvci1lYWNoIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5kZXgtb2YiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zcGxpY2UiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QuYXNzaWduIik7CgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDsKCnZhciBfcmFmID0gcmVxdWlyZSgiLi9yYWYiKTsKCi8qKgogKiBAZmlsZSBzdGlja2luZXNzCiAqIEBhdXRob3IgYmFvemhpeGluIDxiYW96aGl4aW5AYmFpZHUuY29tPgogKiBAc2VlIGh0dHBzOi8vbWVkaXVtLmNvbS9AZWxhZC9jc3MtcG9zaXRpb24tc3RpY2t5LWhvdy1pdC1yZWFsbHktd29ya3MtNTRjZDAxZGMyZDQ2CiAqIEBzZWUgaHR0cHM6Ly9kZXZlbG9wZXJzLmdvb2dsZS5jb20vd2ViL3VwZGF0ZXMvMjAxNy8wOS9zdGlja3ktaGVhZGVycwogKi8KdmFyIGkgPSAwOyAvLyDkuI3nlKjliqDpgqPkuYjlpJrliKTmlq3kuobvvIznm67liY3lsLHmnIkgYmxpbmsg5ZKMIC13ZWJraXQg5Lik56eN5oOF5Ya1Cgp2YXIgcHJlZml4ID0gWycnLCAnLXdlYmtpdC0nXTsKdmFyIGxlbiA9IHByZWZpeC5sZW5ndGg7CnZhciBkdW1teSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpLnN0eWxlOwoKd2hpbGUgKGkgPCBsZW4gJiYgIWR1bW15LnBvc2l0aW9uKSB7CiAgZHVtbXkucG9zaXRpb24gPSAiIi5jb25jYXQocHJlZml4W2krK10sICJzdGlja3kiKTsKfQoKdmFyIGV2ZW50QmluZGVkID0gZmFsc2U7CnZhciBuYXRpdmUgPSAhIWR1bW15LnBvc2l0aW9uOwp2YXIgbGlzdERvbSA9IFtdOwp2YXIgbGlzdE9wdCA9IFtdOwoKdmFyIHNjcm9sbEhhbmRsZXIgPSBmdW5jdGlvbiBzY3JvbGxIYW5kbGVyKCkgewogICgwLCBfcmFmLnJhZikoZnVuY3Rpb24gKCkgewogICAgbGlzdE9wdC5mb3JFYWNoKGZ1bmN0aW9uIChvcHQpIHsKICAgICAgb3B0LmlzU3RpY2t5ID0gIW9wdC53YXNTdGlja3kgPyBvcHQudG9wID49IG9wdC5lbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3AgOiBvcHQudG9wID49IG9wdC5lbC5wYXJlbnRFbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnRvcDsKCiAgICAgIGlmIChvcHQuaXNTdGlja3kgIT09IG9wdC53YXNTdGlja3kpIHsKICAgICAgICBpZiAoIW5hdGl2ZSkgewogICAgICAgICAgaWYgKG9wdC5pc1N0aWNreSkgewogICAgICAgICAgICBPYmplY3QuYXNzaWduKG9wdC5lbC5zdHlsZSwgewogICAgICAgICAgICAgIHBvc2l0aW9uOiAnZml4ZWQnLAogICAgICAgICAgICAgIHRvcDogIiIuY29uY2F0KG9wdC50b3AsICJweCIpLAogICAgICAgICAgICAgIG1heFdpZHRoOiAnNzUwcHgnCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgb3B0LmVsLnJlbW92ZUF0dHJpYnV0ZSgnc3R5bGUnKTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIG9wdC53YXNTdGlja3kgPSBvcHQuaXNTdGlja3k7CiAgICAgICAgb3B0LmNoYW5nZShvcHQuaXNTdGlja3kpOwogICAgICB9CiAgICB9KTsKICB9KTsKfTsKCnZhciByZWZyZXNoID0gZnVuY3Rpb24gcmVmcmVzaCgpIHsKICBpZiAobGlzdERvbS5sZW5ndGgpIHsKICAgIGlmIChldmVudEJpbmRlZCkgewogICAgICByZXR1cm47CiAgICB9CgogICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIHNjcm9sbEhhbmRsZXIsIGZhbHNlKTsKICAgIGV2ZW50QmluZGVkID0gdHJ1ZTsKICB9IGVsc2UgewogICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIHNjcm9sbEhhbmRsZXIpOwogICAgZXZlbnRCaW5kZWQgPSBmYWxzZTsKICB9Cn07Cgp2YXIgX2RlZmF1bHQgPSB7CiAgbmF0aXZlOiBuYXRpdmUsCiAgYWRkOiBmdW5jdGlvbiBhZGQob3B0aW9uKSB7CiAgICBpZiAoIW9wdGlvbiB8fCAhb3B0aW9uLmVsKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBpZiAobGlzdERvbS5pbmRleE9mKG9wdGlvbi5lbCkgPiAtMSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgbGlzdERvbS5wdXNoKG9wdGlvbi5lbCk7CiAgICBsaXN0T3B0LnB1c2gob3B0aW9uKTsKICAgIHJlZnJlc2goKTsKICB9LAogIHJlbW92ZTogZnVuY3Rpb24gcmVtb3ZlKG9wdGlvbikgewogICAgaWYgKCFvcHRpb24gfHwgIW9wdGlvbi5lbCkgewogICAgICByZXR1cm47CiAgICB9CgogICAgdmFyIGluZGV4ID0gbGlzdERvbS5pbmRleE9mKG9wdGlvbi5lbCk7CgogICAgaWYgKGluZGV4ID4gLTEpIHsKICAgICAgbGlzdERvbS5zcGxpY2UoaW5kZXgsIDEpOwogICAgICBsaXN0T3B0LnNwbGljZShpbmRleCwgMSk7CiAgICAgIHJlZnJlc2goKTsKICAgIH0KICB9Cn07CmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0Ow=="},{"version":3,"sources":["/Users/liaohuanyu/projects/baidu-work/baidu/feed3/multi-pages/node_modules/@baidu/nano/es/utils/stickiness.js"],"names":["i","prefix","len","length","dummy","document","createElement","style","position","eventBinded","native","listDom","listOpt","scrollHandler","forEach","opt","isSticky","wasSticky","top","el","getBoundingClientRect","parentElement","Object","assign","maxWidth","removeAttribute","change","refresh","window","addEventListener","removeEventListener","add","option","indexOf","push","remove","index","splice"],"mappings":";;;;;;;;;;;;;;;AAOA;;AAPA;AACA;AACA;AACA;AACA;AACA;AAIA,IAAIA,CAAC,GAAG,CAAR,C,CACA;;AACA,IAAMC,MAAM,GAAG,CAAC,EAAD,EAAK,UAAL,CAAf;AACA,IAAMC,GAAG,GAAGD,MAAM,CAACE,MAAnB;AACA,IAAMC,KAAK,GAAGC,QAAQ,CAACC,aAAT,CAAuB,KAAvB,EAA8BC,KAA5C;;AAEA,OAAOP,CAAC,GAAGE,GAAJ,IAAW,CAACE,KAAK,CAACI,QAAzB,EAAmC;AAC/BJ,EAAAA,KAAK,CAACI,QAAN,aAAoBP,MAAM,CAACD,CAAC,EAAF,CAA1B;AACH;;AAED,IAAIS,WAAW,GAAG,KAAlB;AACA,IAAMC,MAAM,GAAG,CAAC,CAACN,KAAK,CAACI,QAAvB;AACA,IAAMG,OAAO,GAAG,EAAhB;AACA,IAAMC,OAAO,GAAG,EAAhB;;AACA,IAAMC,aAAa,GAAG,SAAhBA,aAAgB,GAAM;AACxB,gBAAI,YAAM;AACND,IAAAA,OAAO,CAACE,OAAR,CAAgB,UAAAC,GAAG,EAAI;AACnBA,MAAAA,GAAG,CAACC,QAAJ,GAAe,CAACD,GAAG,CAACE,SAAL,GACTF,GAAG,CAACG,GAAJ,IAAWH,GAAG,CAACI,EAAJ,CAAOC,qBAAP,GAA+BF,GADjC,GAETH,GAAG,CAACG,GAAJ,IAAWH,GAAG,CAACI,EAAJ,CAAOE,aAAP,CAAqBD,qBAArB,GAA6CF,GAF9D;;AAGA,UAAIH,GAAG,CAACC,QAAJ,KAAiBD,GAAG,CAACE,SAAzB,EAAoC;AAChC,YAAI,CAACP,MAAL,EAAa;AACT,cAAIK,GAAG,CAACC,QAAR,EAAkB;AACdM,YAAAA,MAAM,CAACC,MAAP,CAAcR,GAAG,CAACI,EAAJ,CAAOZ,KAArB,EAA4B;AACxBC,cAAAA,QAAQ,EAAE,OADc;AAExBU,cAAAA,GAAG,YAAKH,GAAG,CAACG,GAAT,OAFqB;AAGxBM,cAAAA,QAAQ,EAAE;AAHc,aAA5B;AAKH,WAND,MAMO;AACHT,YAAAA,GAAG,CAACI,EAAJ,CAAOM,eAAP,CAAuB,OAAvB;AACH;AACJ;;AACDV,QAAAA,GAAG,CAACE,SAAJ,GAAgBF,GAAG,CAACC,QAApB;AACAD,QAAAA,GAAG,CAACW,MAAJ,CAAWX,GAAG,CAACC,QAAf;AACH;AACJ,KAnBD;AAoBH,GArBD;AAsBH,CAvBD;;AAwBA,IAAMW,OAAO,GAAG,SAAVA,OAAU,GAAM;AAClB,MAAIhB,OAAO,CAACR,MAAZ,EAAoB;AAChB,QAAIM,WAAJ,EAAiB;AACb;AACH;;AACDmB,IAAAA,MAAM,CAACC,gBAAP,CAAwB,QAAxB,EAAkChB,aAAlC,EAAiD,KAAjD;AACAJ,IAAAA,WAAW,GAAG,IAAd;AACH,GAND,MAMO;AACHmB,IAAAA,MAAM,CAACE,mBAAP,CAA2B,QAA3B,EAAqCjB,aAArC;AACAJ,IAAAA,WAAW,GAAG,KAAd;AACH;AACJ,CAXD;;eAae;AACXC,EAAAA,MAAM,EAANA,MADW;AAEXqB,EAAAA,GAFW,eAEPC,MAFO,EAEC;AACR,QAAI,CAACA,MAAD,IAAW,CAACA,MAAM,CAACb,EAAvB,EAA2B;AACvB;AACH;;AACD,QAAIR,OAAO,CAACsB,OAAR,CAAgBD,MAAM,CAACb,EAAvB,IAA6B,CAAC,CAAlC,EAAqC;AACjC;AACH;;AAEDR,IAAAA,OAAO,CAACuB,IAAR,CAAaF,MAAM,CAACb,EAApB;AACAP,IAAAA,OAAO,CAACsB,IAAR,CAAaF,MAAb;AACAL,IAAAA,OAAO;AACV,GAbU;AAcXQ,EAAAA,MAdW,kBAcJH,MAdI,EAcI;AACX,QAAI,CAACA,MAAD,IAAW,CAACA,MAAM,CAACb,EAAvB,EAA2B;AACvB;AACH;;AAED,QAAMiB,KAAK,GAAGzB,OAAO,CAACsB,OAAR,CAAgBD,MAAM,CAACb,EAAvB,CAAd;;AACA,QAAIiB,KAAK,GAAG,CAAC,CAAb,EAAgB;AACZzB,MAAAA,OAAO,CAAC0B,MAAR,CAAeD,KAAf,EAAsB,CAAtB;AACAxB,MAAAA,OAAO,CAACyB,MAAR,CAAeD,KAAf,EAAsB,CAAtB;AACAT,MAAAA,OAAO;AACV;AACJ;AAzBU,C","sourcesContent":["/**\n * @file stickiness\n * @author baozhixin <baozhixin@baidu.com>\n * @see https://medium.com/@elad/css-position-sticky-how-it-really-works-54cd01dc2d46\n * @see https://developers.google.com/web/updates/2017/09/sticky-headers\n */\n\nimport {raf} from './raf';\n\nlet i = 0;\n// 不用加那么多判断了，目前就有 blink 和 -webkit 两种情况\nconst prefix = ['', '-webkit-'];\nconst len = prefix.length;\nconst dummy = document.createElement('div').style;\n\nwhile (i < len && !dummy.position) {\n    dummy.position = `${prefix[i++]}sticky`;\n}\n\nlet eventBinded = false;\nconst native = !!dummy.position;\nconst listDom = [];\nconst listOpt = [];\nconst scrollHandler = () => {\n    raf(() => {\n        listOpt.forEach(opt => {\n            opt.isSticky = !opt.wasSticky\n                ? opt.top >= opt.el.getBoundingClientRect().top\n                : opt.top >= opt.el.parentElement.getBoundingClientRect().top;\n            if (opt.isSticky !== opt.wasSticky) {\n                if (!native) {\n                    if (opt.isSticky) {\n                        Object.assign(opt.el.style, {\n                            position: 'fixed',\n                            top: `${opt.top}px`,\n                            maxWidth: '750px'\n                        });\n                    } else {\n                        opt.el.removeAttribute('style');\n                    }\n                }\n                opt.wasSticky = opt.isSticky;\n                opt.change(opt.isSticky);\n            }\n        });\n    });\n};\nconst refresh = () => {\n    if (listDom.length) {\n        if (eventBinded) {\n            return;\n        }\n        window.addEventListener('scroll', scrollHandler, false);\n        eventBinded = true;\n    } else {\n        window.removeEventListener('scroll', scrollHandler);\n        eventBinded = false;\n    }\n};\n\nexport default {\n    native,\n    add(option) {\n        if (!option || !option.el) {\n            return;\n        }\n        if (listDom.indexOf(option.el) > -1) {\n            return;\n        }\n\n        listDom.push(option.el);\n        listOpt.push(option);\n        refresh();\n    },\n    remove(option) {\n        if (!option || !option.el) {\n            return;\n        }\n\n        const index = listDom.indexOf(option.el);\n        if (index > -1) {\n            listDom.splice(index, 1);\n            listOpt.splice(index, 1);\n            refresh();\n        }\n    }\n};\n"]}]}
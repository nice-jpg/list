{"remainingRequest":"/Users/liaohuanyu/projects/baidu-work/baidu/feed3/multi-pages/node_modules/babel-loader/lib/index.js??ref--1-2!/Users/liaohuanyu/projects/baidu-work/baidu/feed3/multi-pages/src/lib/utils/pageMode.js","dependencies":[{"path":"/Users/liaohuanyu/projects/baidu-work/baidu/feed3/multi-pages/src/lib/utils/pageMode.js","mtime":1695633995643},{"path":"/Users/liaohuanyu/projects/baidu-work/baidu/feed3/multi-pages/node_modules/san-hot-loader/index.js","mtime":1696919525187},{"path":"/Users/liaohuanyu/projects/baidu-work/baidu/feed3/multi-pages/node_modules/cache-loader/dist/cjs.js","mtime":1696919513896},{"path":"/Users/liaohuanyu/projects/baidu-work/baidu/feed3/multi-pages/node_modules/babel-loader/lib/index.js","mtime":1696919524615}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKdmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKCIvVXNlcnMvbGlhb2h1YW55dS9wcm9qZWN0cy9iYWlkdS13b3JrL2JhaWR1L2ZlZWQzL211bHRpLXBhZ2VzL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2ludGVyb3BSZXF1aXJlRGVmYXVsdCIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZvci1lYWNoIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmtleXMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMucHJvbWlzZSIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC5jb25zdHJ1Y3RvciIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC5leGVjIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLnRvLXN0cmluZyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2giKTsKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKZXhwb3J0cy5zZXRQYWdlTW9kZSA9IGV4cG9ydHMucmVnaXN0ZXJNb2RlQ2hhbmdlID0gZXhwb3J0cy5nZXRQYWdlTW9kZSA9IGV4cG9ydHMuc2V0TW9kZUNsYXNzID0gdm9pZCAwOwoKdmFyIF9lbnYgPSByZXF1aXJlKCJAYmFpZHUvYXVjLWJhc2UvZW52Iik7Cgp2YXIgX2JveHggPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIkBiYWlkdS9hdWMtYmFzZS9ib3h4IikpOwoKdmFyIF9pbmRleCA9IHJlcXVpcmUoIi4vaW5kZXgiKTsKCi8qKgogKiBAZmlsZSBwYWdlTW9kZS5qcwogKiBAZGVzY3JpcHRpb24g6aG16Z2i54q25oCB6I635Y+W77yMZGFya21vZGUvbGlnaHRtb2RlCiAqIEBhdXRob3IgbGVpemhpaGFvQGJhaWR1LmNvbQogKi8KdmFyIG1vZGVDbGFzc01hcCA9IHsKICBMSUdIVF9NT0RFOiAnbGlnaHRtb2RlJywKICBOSUdIVF9NT0RFOiAnbmlnaHRtb2RlJywKICBEQVJLX01PREU6ICdkYXJrbW9kZScKfTsgLy8g5riF6Zmk6aG16Z2i54q25oCB55qE5YWo5bGAY2xhc3MKCnZhciBjbGVhck1vZGVDbGFzcyA9IGZ1bmN0aW9uIGNsZWFyTW9kZUNsYXNzKCkgewogIE9iamVjdC5rZXlzKG1vZGVDbGFzc01hcCkuZm9yRWFjaChmdW5jdGlvbiAobW9kZUtleSkgewogICAgcmV0dXJuIGRvY3VtZW50LmJvZHkucGFyZW50RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKG1vZGVDbGFzc01hcFttb2RlS2V5XSk7CiAgfSk7Cn07IC8vIOiuvue9rumhtemdoueKtuaAge+8jOiuvue9ruS5i+WJjeWFiOi/m+ihjOa4hemZpOW3peS9nAoKCnZhciBzZXRNb2RlQ2xhc3MgPSBmdW5jdGlvbiBzZXRNb2RlQ2xhc3MobW9kZSkgewogIGNsZWFyTW9kZUNsYXNzKCk7CiAgZG9jdW1lbnQuYm9keS5wYXJlbnRFbGVtZW50LmNsYXNzTGlzdC5hZGQobW9kZSk7Cn07Ci8qKgogKiBAbmFtZSBnZXRQYWdlTW9kZQogKiBAZGVzY3JpcHRpb24g6I635Y+W6aG16Z2i5qih5byPIG5pZ2h0bW9kZS9saWdodG1vZGUvZGFya21vZGXvvIzojrflj5blpLHotKXpu5jorqRsaWdodG1vZGUKICogQHJldHVybnMge1Byb21pc2V9IOiOt+WPluWujOaIkOWQjueahOWbnuiwg++8jOi/lOWbnuWGheWuueaYr3BhZ2VNb2RlRW51bemHjOeahOWAvAogKi8KCgpleHBvcnRzLnNldE1vZGVDbGFzcyA9IHNldE1vZGVDbGFzczsKCnZhciBnZXRQYWdlTW9kZSA9IGZ1bmN0aW9uIGdldFBhZ2VNb2RlKCkgewogIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkgewogICAgdmFyIHRoZW1lID0gbmV3IFJlZ0V4cChlbmNvZGVVUklDb21wb25lbnQoJ1RoZW1lL2RhcmsnKSk7CgogICAgaWYgKHRoZW1lLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCkpIHsKICAgICAgcmVzb2x2ZShtb2RlQ2xhc3NNYXAuREFSS19NT0RFKTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGlmIChfZW52LmVudi5pc0lPUykgewogICAgICBfYm94eC5kZWZhdWx0LmNhbGwoJ3N5c3RlbS5nZXRUaGVtZScsIHsKICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiBzdWNjZXNzKHJlcykgewogICAgICAgICAgaWYgKHJlcyAmJiByZXMuZGF0YSkgewogICAgICAgICAgICB2YXIgX3RoZW1lID0gcmVzLmRhdGE7CgogICAgICAgICAgICBpZiAoX3RoZW1lID09PSAnZGFyaycpIHsKICAgICAgICAgICAgICByZXNvbHZlKG1vZGVDbGFzc01hcC5EQVJLX01PREUpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHJlc29sdmUobW9kZUNsYXNzTWFwLkxJR0hUX01PREUpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KTsKICAgIH0gZWxzZSBpZiAoX2Vudi5lbnYuaXNBbmRyb2lkKSB7CiAgICAgIF9ib3h4LmRlZmF1bHQuY2FsbCgnc3lzdGVtLmdldE5pZ2h0TW9kZScsIHsKICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiBzdWNjZXNzKHJlcykgewogICAgICAgICAgaWYgKHJlcyAmJiByZXMuZGF0YSkgewogICAgICAgICAgICB2YXIgX3RoZW1lMiA9IHJlcy5kYXRhOwoKICAgICAgICAgICAgaWYgKF90aGVtZTIgPiAwIHx8IF90aGVtZTIuaXNOaWdodE1vZGUgPiAwKSB7CiAgICAgICAgICAgICAgcmVzb2x2ZShtb2RlQ2xhc3NNYXAuTklHSFRfTU9ERSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgcmVzb2x2ZShtb2RlQ2xhc3NNYXAuTElHSFRfTU9ERSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0pOwp9OyAvLyDnm5HlkKzpobXpnaLnirbmgIHlj5jljJbnmoTlh73mlbDvvIzlj6rmnIlpT1PkvJrmiafooYznm7jlhbPpgLvovpEKCgpleHBvcnRzLmdldFBhZ2VNb2RlID0gZ2V0UGFnZU1vZGU7Cgp2YXIgcmVnaXN0ZXJNb2RlQ2hhbmdlID0gZnVuY3Rpb24gcmVnaXN0ZXJNb2RlQ2hhbmdlKGNhbGxiYWNrKSB7CiAgdHJ5IHsKICAgIHZhciBhY3Rpb24gPSAnY29tLmJhaWR1LmNoYW5uZWwuZm91bmRhdGlvbi50aGVtZWNoYW5nZWQnOwoKICAgIGlmIChfZW52LmVudi5pc0FuZHJvaWQpIHsKICAgICAgYWN0aW9uID0gJ2NvbS5iYWlkdS5jaGFubmVsLmZvdW5kYXRpb24ubmlnaHRtb2RlY2hhbmdlZCc7CiAgICB9CgogICAgKDAsIF9pbmRleC5ib3h4T24pKHsKICAgICAgYWN0aW9uOiBhY3Rpb24sCiAgICAgIHBhZ2U6ICd0b3BpYycsCiAgICAgIGpzY2FsbGJhY2s6IGZ1bmN0aW9uIGpzY2FsbGJhY2soYWN0aW9uKSB7CiAgICAgICAgdmFyIHJlcyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDoge307CiAgICAgICAgdmFyIG1vZGUgPSBtb2RlQ2xhc3NNYXAuTElHSFRfTU9ERTsKCiAgICAgICAgdHJ5IHsKICAgICAgICAgIHJlcyA9IEpTT04ucGFyc2UocmVzKTsKCiAgICAgICAgICBpZiAoK3Jlcy5pc05pZ2h0TW9kZSA+IDAgJiYgX2Vudi5lbnYuaXNBbmRyb2lkKSB7CiAgICAgICAgICAgIG1vZGUgPSBtb2RlQ2xhc3NNYXAuTklHSFRfTU9ERTsKICAgICAgICAgIH0gZWxzZSBpZiAocmVzLnRoZW1lID09PSAnZGFyaycpIHsKICAgICAgICAgICAgbW9kZSA9IG1vZGVDbGFzc01hcC5EQVJLX01PREU7CiAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgY29uc29sZS5sb2coZSk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgIGNhbGxiYWNrKG1vZGUpOwogICAgICAgIH0KICAgICAgfQogICAgfSk7CiAgfSBjYXRjaCAoZSkgewogICAgY29uc29sZS5sb2coZSk7CiAgfQp9OwovKioKICogQG5hbWUgc2V0UGFnZU1vZGUKICogQGRlc2NyaXB0aW9uIOWcqGRvY3VtZW50Lmh0bWzkuIrorr7nva7pobXpnaLmqKHlvI/vvIxuaWdodG1vZGUvbGlnaHRtb2RlL2Rhcmttb2Rl5ZKMaW9zL2FuZHJvaWQKICogQHJldHVybnMge1Byb21pc2V9IOaJp+ihjOWujOavleeahOWbnuiwgwogKi8KCgpleHBvcnRzLnJlZ2lzdGVyTW9kZUNoYW5nZSA9IHJlZ2lzdGVyTW9kZUNoYW5nZTsKCnZhciBzZXRQYWdlTW9kZSA9IGZ1bmN0aW9uIHNldFBhZ2VNb2RlKCkgewogIC8vIOazqOWGjOmhtemdouaooeW8j+aUueWPmOeahOS6i+S7tgogIHJlZ2lzdGVyTW9kZUNoYW5nZShmdW5jdGlvbiAobW9kZSkgewogICAgcmV0dXJuIHNldE1vZGVDbGFzcyhtb2RlKTsKICB9KTsKICB2YXIgZGV2aWNlQ2xhc3NOYW1lID0gX2Vudi5lbnYuaXNJT1MgPyAnaW9zJyA6IF9lbnYuZW52LmlzQW5kcm9pZCA/ICdhbmRyb2lkJyA6ICdvdGgnOwogIGRvY3VtZW50LmJvZHkucGFyZW50RWxlbWVudC5jbGFzc0xpc3QuYWRkKGRldmljZUNsYXNzTmFtZSk7CiAgX2Vudi5lbnYuaXNJT1MgJiYgZG9jdW1lbnQuYm9keS5wYXJlbnRFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2lwaG9uZScpOyAvLyDojrflj5blvZPliY3pobXpnaLmqKHlvI8KCiAgcmV0dXJuIGdldFBhZ2VNb2RlKCkudGhlbihmdW5jdGlvbiAobW9kZSkgewogICAgdHJ5IHsKICAgICAgc2V0TW9kZUNsYXNzKG1vZGUpOwogICAgfSBjYXRjaCAoZSkgewogICAgICBjb25zb2xlLmVycm9yKGUpOwogICAgfQogIH0pOwp9OwoKZXhwb3J0cy5zZXRQYWdlTW9kZSA9IHNldFBhZ2VNb2RlOw=="},{"version":3,"sources":["/Users/liaohuanyu/projects/baidu-work/baidu/feed3/multi-pages/src/lib/utils/pageMode.js"],"names":["modeClassMap","LIGHT_MODE","NIGHT_MODE","DARK_MODE","clearModeClass","Object","keys","forEach","modeKey","document","body","parentElement","classList","remove","setModeClass","mode","add","getPageMode","Promise","resolve","theme","RegExp","encodeURIComponent","test","navigator","userAgent","env","isIOS","boxx","call","success","res","data","isAndroid","isNightMode","registerModeChange","callback","action","page","jscallback","JSON","parse","e","console","log","setPageMode","deviceClassName","then","error"],"mappings":"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","sourcesContent":["/**\n * @file pageMode.js\n * @description 页面状态获取，darkmode/lightmode\n * @author leizhihao@baidu.com\n */\n\nimport {env} from '@baidu/auc-base/env';\nimport boxx from '@baidu/auc-base/boxx';\nimport {boxxOn} from './index';\n\nconst modeClassMap = {\n    LIGHT_MODE: 'lightmode',\n    NIGHT_MODE: 'nightmode',\n    DARK_MODE: 'darkmode'\n};\n\n// 清除页面状态的全局class\nconst clearModeClass = () => {\n    Object.keys(modeClassMap).forEach(modeKey => document.body.parentElement.classList.remove(modeClassMap[modeKey]));\n};\n\n// 设置页面状态，设置之前先进行清除工作\nexport const setModeClass = mode => {\n    clearModeClass();\n    document.body.parentElement.classList.add(mode);\n};\n\n/**\n * @name getPageMode\n * @description 获取页面模式 nightmode/lightmode/darkmode，获取失败默认lightmode\n * @returns {Promise} 获取完成后的回调，返回内容是pageModeEnum里的值\n */\n\nexport const getPageMode = () => new Promise(resolve => {\n    let theme = new RegExp(encodeURIComponent('Theme/dark'));\n\n    if (theme.test(navigator.userAgent)) {\n        resolve(modeClassMap.DARK_MODE);\n        return;\n    }\n\n    if (env.isIOS) {\n        boxx.call('system.getTheme', {\n            success(res) {\n                if (res && res.data) {\n                    const theme = res.data;\n                    if (theme === 'dark') {\n                        resolve(modeClassMap.DARK_MODE);\n                    } else {\n                        resolve(modeClassMap.LIGHT_MODE);\n                    }\n                }\n            }\n        });\n    } else if (env.isAndroid) {\n        boxx.call('system.getNightMode', {\n            success(res) {\n                if (res && res.data) {\n                    const theme = res.data;\n                    if (theme > 0 || theme.isNightMode > 0) {\n                        resolve(modeClassMap.NIGHT_MODE);\n                    } else {\n                        resolve(modeClassMap.LIGHT_MODE);\n                    }\n                }\n            }\n        });\n    }\n});\n\n// 监听页面状态变化的函数，只有iOS会执行相关逻辑\nexport const registerModeChange = (callback) => {\n    try {\n        let action = 'com.baidu.channel.foundation.themechanged';\n        if (env.isAndroid) {\n            action = 'com.baidu.channel.foundation.nightmodechanged';\n        }\n        boxxOn({\n            action: action,\n            page: 'topic',\n            jscallback: (action, res = {}) => {\n                let mode = modeClassMap.LIGHT_MODE;\n                try {\n                    res = JSON.parse(res);\n                    if (+res.isNightMode > 0 && env.isAndroid) {\n                        mode = modeClassMap.NIGHT_MODE;\n                    } else if (res.theme === 'dark') {\n                        mode = modeClassMap.DARK_MODE;\n                    }\n                } catch (e) {\n                    console.log(e);\n                } finally {\n                    callback(mode);\n                }\n            }\n        });        \n    } catch (e) {\n        console.log(e);\n    }\n};\n\n\n/**\n * @name setPageMode\n * @description 在document.html上设置页面模式，nightmode/lightmode/darkmode和ios/android\n * @returns {Promise} 执行完毕的回调\n */\n\nexport const setPageMode = () => {\n    // 注册页面模式改变的事件\n    registerModeChange(mode => setModeClass(mode));\n\n    const deviceClassName = env.isIOS ? 'ios' : env.isAndroid ? 'android' : 'oth';\n    document.body.parentElement.classList.add(deviceClassName);\n    env.isIOS && document.body.parentElement.classList.add('iphone');\n    // 获取当前页面模式\n    return getPageMode().then(mode => {\n        try {\n            setModeClass(mode);\n        } catch (e) {\n            console.error(e);\n        }\n    });\n};\n"]}]}
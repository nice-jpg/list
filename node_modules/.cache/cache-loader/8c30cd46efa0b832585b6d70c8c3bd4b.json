{"remainingRequest":"/Users/liaohuanyu/projects/baidu-work/baidu/feed3/multi-pages/node_modules/babel-loader/lib/index.js??ref--1-2!/Users/liaohuanyu/projects/baidu-work/baidu/feed3/multi-pages/node_modules/@baidu/xbox-player-mini/plugins/Create.js","dependencies":[{"path":"/Users/liaohuanyu/projects/baidu-work/baidu/feed3/multi-pages/node_modules/@baidu/xbox-player-mini/plugins/Create.js","mtime":1696919504666},{"path":"/Users/liaohuanyu/projects/baidu-work/baidu/feed3/multi-pages/node_modules/san-hot-loader/index.js","mtime":1696919525187},{"path":"/Users/liaohuanyu/projects/baidu-work/baidu/feed3/multi-pages/node_modules/cache-loader/dist/cjs.js","mtime":1696919513896},{"path":"/Users/liaohuanyu/projects/baidu-work/baidu/feed3/multi-pages/node_modules/babel-loader/lib/index.js","mtime":1696919524615}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKdmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKCIvVXNlcnMvbGlhb2h1YW55dS9wcm9qZWN0cy9iYWlkdS13b3JrL2JhaWR1L2ZlZWQzL211bHRpLXBhZ2VzL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2ludGVyb3BSZXF1aXJlRGVmYXVsdCIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnN5bWJvbCIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmNvbmNhdCIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbHRlciIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZvci1lYWNoIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5kZXgtb2YiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QuZ2V0LW93bi1wcm9wZXJ0eS1kZXNjcmlwdG9yIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmdldC1vd24tcHJvcGVydHktZGVzY3JpcHRvcnMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3Qua2V5cyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2giKTsKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwOwoKdmFyIF9kZWZpbmVQcm9wZXJ0eTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIi9Vc2Vycy9saWFvaHVhbnl1L3Byb2plY3RzL2JhaWR1LXdvcmsvYmFpZHUvZmVlZDMvbXVsdGktcGFnZXMvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZGVmaW5lUHJvcGVydHkiKSk7Cgp2YXIgX2NsYXNzQ2FsbENoZWNrMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgiL1VzZXJzL2xpYW9odWFueXUvcHJvamVjdHMvYmFpZHUtd29yay9iYWlkdS9mZWVkMy9tdWx0aS1wYWdlcy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVjayIpKTsKCnZhciBfY3JlYXRlQ2xhc3MyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCIvVXNlcnMvbGlhb2h1YW55dS9wcm9qZWN0cy9iYWlkdS13b3JrL2JhaWR1L2ZlZWQzL211bHRpLXBhZ2VzL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2NyZWF0ZUNsYXNzIikpOwoKZnVuY3Rpb24gb3duS2V5cyhvYmplY3QsIGVudW1lcmFibGVPbmx5KSB7IHZhciBrZXlzID0gT2JqZWN0LmtleXMob2JqZWN0KTsgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHsgdmFyIHN5bWJvbHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKG9iamVjdCk7IGlmIChlbnVtZXJhYmxlT25seSkgc3ltYm9scyA9IHN5bWJvbHMuZmlsdGVyKGZ1bmN0aW9uIChzeW0pIHsgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBzeW0pLmVudW1lcmFibGU7IH0pOyBrZXlzLnB1c2guYXBwbHkoa2V5cywgc3ltYm9scyk7IH0gcmV0dXJuIGtleXM7IH0KCmZ1bmN0aW9uIF9vYmplY3RTcHJlYWQodGFyZ2V0KSB7IGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7IHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV0gIT0gbnVsbCA/IGFyZ3VtZW50c1tpXSA6IHt9OyBpZiAoaSAlIDIpIHsgb3duS2V5cyhPYmplY3Qoc291cmNlKSwgdHJ1ZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7ICgwLCBfZGVmaW5lUHJvcGVydHkyLmRlZmF1bHQpKHRhcmdldCwga2V5LCBzb3VyY2Vba2V5XSk7IH0pOyB9IGVsc2UgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMoc291cmNlKSk7IH0gZWxzZSB7IG93bktleXMoT2JqZWN0KHNvdXJjZSkpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc291cmNlLCBrZXkpKTsgfSk7IH0gfSByZXR1cm4gdGFyZ2V0OyB9CgovKioKICogQGZpbGUgQ3JlYXRlCiAqIEBhdXRob3Igemhhbmd0aW5ndGluZzEyIDx6aGFuZ3Rpbmd0aW5nMTJAYmFpZHUuY29tPgogKi8KCi8qKgogKiBpb3Pnq6/lhoXlpJbmoIfnrb7pq5jluqYKICogQHBhcmFtIHtudW1iZXJ9IGhlaWdodCDnlJ/miJBpb3PnmoTnibnmropkb23pq5jluqbvvIzpnIDopoHlhoXpg6jpq5jluqblpKfkuo7lpJbpg6jvvIzop6blj5FvdmVyZmxvdzpzY3JvbGwKICovCnZhciBnZW5Eb21IZWlnaHQgPSBmdW5jdGlvbiBnZW5Eb21IZWlnaHQoaGVpZ2h0KSB7CiAgcmV0dXJuIHsKICAgIHdyYXA6IGhlaWdodCwKICAgIGlubmVyOiBoZWlnaHQgKyAxCiAgfTsKfTsKCnZhciBDcmVhdGUgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIENyZWF0ZShhcGksIHBsdWdpbk9wdGlvbnMpIHsKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgKDAsIF9jbGFzc0NhbGxDaGVjazIuZGVmYXVsdCkodGhpcywgQ3JlYXRlKTsKICAgIHRoaXMuYXBpID0gYXBpOwogICAgdGhpcy5wbHVnaW5PcHRpb25zID0gcGx1Z2luT3B0aW9uczsgLy8g5pqC5pe25a6a5LmJ5Li6bmV3IFBsYXllcuaXtueUqOaIt+S8oOi/h+adpeeahAoKICAgIHRoaXMucGVyZiA9IHt9OyAvLyDorrDlvZXml7bpl7Tngrk6Y2xr54K55Ye7LCBjcmVhdGVTdGFydOW8gOWni+WIm+W7uixxdWVyeVN0YXJ05byA5aeL5p+l6K+iCgogICAgdGhpcy5wZXJmbG9nID0ge307IC8vIOiusOW9leiAl+aXtgoKICAgIHRoaXMuaXNFbWl0UGVyZiA9IGZhbHNlOyAvLyDmjqfliLbmgKfog73kuovku7blj5HpgIEKCiAgICB0aGlzLmFwaS5vbigncmVzZXQnLCBmdW5jdGlvbiAoZGF0YSkgewogICAgICByZXR1cm4gX3RoaXMucmVzZXQoZGF0YSk7CiAgICB9KTsKICAgIHRoaXMuYXBpLm9uKCdkZXN0cm95JywgZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gX3RoaXMuZGVzdHJveSgpOwogICAgfSk7CiAgfSAvLyDlj6/orr7nva7mn6Xor6LmrKHmlbDvvIzkvb/nlKhoNeaooeW8jyBoNU1vZGU9dHJ1ZQoKCiAgKDAsIF9jcmVhdGVDbGFzczIuZGVmYXVsdCkoQ3JlYXRlLCBbewogICAga2V5OiAicnVuIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBydW4oaW9zTWF4UXVlcnlDbnQsIGg1TW9kZSkgewogICAgICBpZiAodGhpcy5hcGkuZ2V0VmlkZW9JbnN0YW5jZSgpIHx8ICF0aGlzLmFwaS5nZXRSb290KCkpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHZhciBvcHRpb25zID0gdGhpcy5hcGkuZ2V0UGxheWVyT3B0aW9uKCk7CiAgICAgIHRoaXMucGVyZi5jcmVhdGVTdGFydCA9ICtuZXcgRGF0ZSgpOwogICAgICB0aGlzLnBlcmYuY2xrID0gb3B0aW9ucy5wcmVwYXJlSW52b2tlUGxheWVyVGltZSB8fCB0aGlzLnBlcmYuY3JlYXRlU3RhcnQ7CgogICAgICB2YXIgX3RoaXMkYXBpJGdldEJveFRvb2xzID0gdGhpcy5hcGkuZ2V0Qm94VG9vbHMoKSwKICAgICAgICAgIGlzTWFpbkJveCA9IF90aGlzJGFwaSRnZXRCb3hUb29scy5pc01haW5Cb3gsCiAgICAgICAgICB2ZXJzaW9uID0gX3RoaXMkYXBpJGdldEJveFRvb2xzLnZlcnNpb24sCiAgICAgICAgICB2ZXJzaW9uQ29tcGFyZSA9IF90aGlzJGFwaSRnZXRCb3hUb29scy52ZXJzaW9uQ29tcGFyZSwKICAgICAgICAgIGlzSU9TID0gX3RoaXMkYXBpJGdldEJveFRvb2xzLmlzSU9TLAogICAgICAgICAgaXNBbmRyb2lkID0gX3RoaXMkYXBpJGdldEJveFRvb2xzLmlzQW5kcm9pZDsKCiAgICAgIHRoaXMuaXNJT1MgPSBpc0lPUygpOwogICAgICB0aGlzLmlzQW5kcm9pZCA9IGlzQW5kcm9pZCgpOwogICAgICB2YXIgZ2V0UmFuZG9tTmFtZSA9IHRoaXMuYXBpLmdldEJveFRvb2xzKCkuZ2V0UmFuZG9tTmFtZTsKICAgICAgdGhpcy5jaWQgPSBnZXRSYW5kb21OYW1lKCdoNS1zYW1lbGF5ZXItY2lkLScpIHx8IHRoaXMuY2lkOwogICAgICB0aGlzLmFwaS5zZXRQbGF5ZXJPcHRpb24oJ2NvbnRhaW5lcklkJywgdGhpcy5jaWQpOyAvLyDkuJrliqHmlrnmjIflrprkuoblkIzlsYLlpLHotKXkuI3kvb/nlKjpu5jorqR2aWRlb+agh+etvu+8jOS5n+WNs+WPquinpuWPkW1vZGU9aDXvvIzkuI3liJvlu7p2aWRlbwoKICAgICAgb3B0aW9ucy5jdXN0b21pemVkVmlkZW8gJiYgdGhpcy5hcGkuc2V0UGxheWVyQ29udHJvbGxlcignc2xyT25seScsIHRydWUpOyAvLyBpb3PlnKgxMi455pe25Yqf6IO95a6M5YWoLGFuZHJvaWTlnKgxMi4xMOaXtuWKn+iDveWujOWFqAoKICAgICAgaWYgKCFoNU1vZGUgJiYgaXNNYWluQm94KCkgJiYgKHRoaXMuaXNJT1MgJiYgdmVyc2lvbkNvbXBhcmUodmVyc2lvbiwgJzEyLjknKSA+PSAwIHx8IHRoaXMuaXNBbmRyb2lkICYmIHZlcnNpb25Db21wYXJlKHZlcnNpb24sICcxMi4xMCcpID49IDApKSB7CiAgICAgICAgaWYgKHRoaXMuaXNJT1MpIHsKICAgICAgICAgIHRoaXMuaW9zTWF4UXVlcnlDbnQgPSBpb3NNYXhRdWVyeUNudCB8fCA1OwogICAgICAgICAgcmV0dXJuIHRoaXMuaW9zQ3JlYXRlVmlkZW8oKTsKICAgICAgICB9IGVsc2UgaWYgKHRoaXMuaXNBbmRyb2lkKSB7CiAgICAgICAgICByZXR1cm4gdGhpcy5hbmRyb2lkQ3JlYXRlVmlkZW8ob3B0aW9ucy5wYWdlVXJsKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRoaXMuaDVSdW4oKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJkZXN0cm95IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBkZXN0cm95KCkgewogICAgICB2YXIgaW52b2tlUCA9IHRoaXMuYXBpLmdldEJveFRvb2xzKCkuaW52b2tlUDsKICAgICAgdmFyIHZpZGVvID0gdGhpcy5hcGkuZ2V0VmlkZW9JbnN0YW5jZSgpOwogICAgICB2YXIgY29udHJvbGxlciA9IHRoaXMuYXBpLmdldFBsYXllckNvbnRyb2xsZXIoKTsKCiAgICAgIGlmICh0aGlzLmFwaS5nZXRNb2RlKCkgPT09ICduYScpIHsKICAgICAgICAvLyDljbjovb3pobXpnaLkuovku7YKICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigncGFnZWhpZGUnLCBjb250cm9sbGVyLnBhZ2VoaWRlSGFuZGxlcik7CiAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3BhZ2VzaG93JywgY29udHJvbGxlci5wYWdlc2hvd0hhbmRsZXIpOwoKICAgICAgICBpZiAodGhpcy5pc0lPUykgewogICAgICAgICAgdmFyIGV2ZW50Q2FsbGJhY2sgPSBjb250cm9sbGVyLmV2ZW50Q2FsbGJhY2s7CgogICAgICAgICAgd2luZG93W2V2ZW50Q2FsbGJhY2tdID0gZnVuY3Rpb24gKCkge307CgogICAgICAgICAgaW52b2tlUCgndmlkZW8vc2xyU3RvcFBsYXllcicsIHsKICAgICAgICAgICAgcGFyYW1zOiB7CiAgICAgICAgICAgICAgY29udGFpbmVySWQ6IHRoaXMuY2lkCiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOyAvLyDljbjovb3pobXpnaLmmL7pmpDkuovku7YKCiAgICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKGNvbnRyb2xsZXIudmlzaWJpbGl0eUNoYW5nZSwgY29udHJvbGxlci52aXNpYmlsaXR5SGFuZGxlcik7CiAgICAgICAgICB0aGlzLnJlbW92ZURvbSgpOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0gZWxzZSBpZiAodGhpcy5pc0FuZHJvaWQpIHsKICAgICAgICAgIHZhciBqc2NhbGxiYWNrID0gY29udHJvbGxlci5vcGVyYXRpb25qc2NhbGxiYWNrOwoKICAgICAgICAgIHdpbmRvd1tqc2NhbGxiYWNrXSA9IGZ1bmN0aW9uICgpIHt9OwoKICAgICAgICAgIGludm9rZVAoJ3Y1L2RhdGFjaGFubmVsL3VucmVnaXN0ZXInLCB7CiAgICAgICAgICAgIGFjdGlvbjogJ2NvbS5iYWlkdS52aWRlb3BsYXllci5vcGVyYXRpb25yZXN1bHQnLAogICAgICAgICAgICBqc2NhbGxiYWNrOiBqc2NhbGxiYWNrCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0gLy8g5Y246L29dmlkZW/kuovku7YKCgogICAgICBPYmplY3Qua2V5cyhjb250cm9sbGVyLnZpZGVvRXZlbnRIYW5kbGVyKS5mb3JFYWNoKGZ1bmN0aW9uIChldnRuYW1lKSB7CiAgICAgICAgcmV0dXJuIHZpZGVvLnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZ0bmFtZSwgY29udHJvbGxlci52aWRlb0V2ZW50SGFuZGxlcltldnRuYW1lXSk7CiAgICAgIH0pOyAvLyDljbjovb3lhajlsY/kuovku7YKCiAgICAgIE9iamVjdC5rZXlzKGNvbnRyb2xsZXIuZG9jRXZlbnRIYW5kbGVyKS5mb3JFYWNoKGZ1bmN0aW9uIChldnRuYW1lKSB7CiAgICAgICAgcmV0dXJuIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZ0bmFtZSwgY29udHJvbGxlci5kb2NFdmVudEhhbmRsZXJbZXZ0bmFtZV0pOwogICAgICB9KTsgLy8gYW5kcm9pZOeahE5B5pKt5pS+5Zmo5L6d6LWW5q2k5aSE6ZSA5q+BCgogICAgICB2aWRlby5zcmMgPSAnJzsKICAgICAgdGhpcy5yZW1vdmVEb20oKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZW1vdmVEb20iLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZURvbSgpIHsKICAgICAgdmFyIGRvbSA9IHRoaXMuYXBpLmdldFZpZGVvSW5zdGFuY2UoKTsKCiAgICAgIGlmIChkb20pIHsKICAgICAgICBkb20ucGFyZW50Tm9kZSAmJiBkb20ucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChkb20pOwogICAgICB9CgogICAgICB0aGlzLmFwaS5zZXRWaWRlb0luc3RhbmNlKG51bGwpOwogICAgfQogIH0sIHsKICAgIGtleTogImlvc0NyZWF0ZVZpZGVvIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBpb3NDcmVhdGVWaWRlbygpIHsKICAgICAgdmFyIHJvb3QgPSB0aGlzLmFwaS5nZXRSb290KCk7CiAgICAgIHZhciByb290UG9zID0gdGhpcy5nZXRDb250YWluZXJCb3gocm9vdCk7CiAgICAgIHZhciBvcHRpb25zID0gdGhpcy5hcGkuZ2V0UGxheWVyT3B0aW9uKCk7IC8vIOayoeacieaMh+WumuWuvemrmOWImem7mOiupOS9v+eUqOWkluWxgmRpdueahOWuvemrmAoKICAgICAgdGhpcy53aWR0aCA9IG9wdGlvbnMud2lkdGggfHwgcm9vdFBvcy53aWR0aDsKICAgICAgdGhpcy5oZWlnaHQgPSBvcHRpb25zLmhlaWdodCB8fCByb290UG9zLmhlaWdodDsKCiAgICAgIHZhciBfZ2VuRG9tSGVpZ2h0ID0gZ2VuRG9tSGVpZ2h0KHRoaXMuaGVpZ2h0KSwKICAgICAgICAgIHdyYXAgPSBfZ2VuRG9tSGVpZ2h0LndyYXAsCiAgICAgICAgICBpbm5lciA9IF9nZW5Eb21IZWlnaHQuaW5uZXI7CgogICAgICB2YXIgdmlkZW8gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgdmlkZW8uY2xhc3NOYW1lID0gdGhpcy5jaWQ7CiAgICAgIHZpZGVvLnN0eWxlID0gJ3dpZHRoOicgKyB0aGlzLndpZHRoICsgJ3B4O2hlaWdodDonICsgd3JhcCArICdweDsnICsgJ292ZXJmbG93OiBzY3JvbGw7IC13ZWJraXQtb3ZlcmZsb3ctc2Nyb2xsaW5nOiB0b3VjaDsgYmFja2dyb3VuZC1jb2xvcjogdHJhbnNwYXJlbnQ7JzsKICAgICAgdmFyIHZpZGVvSW5uZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgdmlkZW9Jbm5lci5zdHlsZSA9ICd3aWR0aDogMTAwJTsgaGVpZ2h0OicgKyBpbm5lciArICdweCc7IC8vIOmihOWIm+W7ugoKICAgICAgb3B0aW9ucy5wcmVjcmVhdGUgJiYgdmlkZW8uc2V0QXR0cmlidXRlKCdkYXRhLXByZWNyZWF0ZXZpZGVvaW5mbycsIEpTT04uc3RyaW5naWZ5KHsKICAgICAgICB2aWRlb1VybDogb3B0aW9ucy5zcmMsCiAgICAgICAgdmlkOiBvcHRpb25zLnZpZCwKICAgICAgICBwbGF5ZXJDb250cm9sVHlwZTogb3B0aW9ucy5wbGF5ZXJDb250cm9sVHlwZSB8fCAwCiAgICAgIH0pKTsgLy8g6aKE5Y+W5o6o6I2Q5L2/55So5Y2V54us55qEcHJlZmV0Y2jmlrnms5UKICAgICAgLy8gb3B0aW9ucy5wcmVmZXRjaFZpZGVvSW5mbwogICAgICAvLyAgICAgJiYgdmlkZW8uc2V0QXR0cmlidXRlKCdkYXRhLXByZWZldGNodmlkZW9pbmZvJywgSlNPTi5zdHJpbmdpZnkob3B0aW9ucy5wcmVmZXRjaFZpZGVvSW5mbykpOwoKICAgICAgdmlkZW8uYXBwZW5kQ2hpbGQodmlkZW9Jbm5lcik7CiAgICAgIHJvb3QuYXBwZW5kQ2hpbGQodmlkZW8pOwogICAgICB0aGlzLnRpbWVzID0gMDsKICAgICAgdGhpcy5pc1Njcm9sbFZpZXdGb3VuZCA9IGZhbHNlOwogICAgICB0aGlzLmlzUmVuZGVyQ29tcGxldGUgPSBmYWxzZTsKICAgICAgdGhpcy5hcGkuc2V0VmlkZW9JbnN0YW5jZSh2aWRlbyk7IC8vIOiOt+WPlnZpZGVv55qE55yf5a6e5a696auY5byA5aeL5p+l5om+CgogICAgICB2YXIgcG9zaXRpb24gPSBvcHRpb25zLnBvc2l0aW9uIHx8IHRoaXMuZ2V0Q29udGFpbmVyQm94KHZpZGVvKTsKICAgICAgdGhpcy5hcGkuc2V0UGxheWVyT3B0aW9uKCcnLCB7CiAgICAgICAgd2lkdGg6IHRoaXMud2lkdGgsCiAgICAgICAgaGVpZ2h0OiB0aGlzLmhlaWdodCwKICAgICAgICBwb3NpdGlvbjogcG9zaXRpb24KICAgICAgfSk7CiAgICAgIHRoaXMucGVyZi5xdWVyeVN0YXJ0ID0gK25ldyBEYXRlKCk7CiAgICAgIHRoaXMuaW9zUXVlcnkocG9zaXRpb24pOwogICAgfQogIH0sIHsKICAgIGtleTogImdldENvbnRhaW5lckJveCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Q29udGFpbmVyQm94KGUpIHsKICAgICAgdmFyIGJjciA9IGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICAgIHJldHVybiB7CiAgICAgICAgbGVmdDogYmNyLmxlZnQgKyB3aW5kb3cuc2Nyb2xsWCwKICAgICAgICB0b3A6IGJjci50b3AgKyB3aW5kb3cuc2Nyb2xsWSwKICAgICAgICB3aWR0aDogTWF0aC5yb3VuZChiY3Iud2lkdGgpLAogICAgICAgIGhlaWdodDogTWF0aC5yb3VuZChiY3IuaGVpZ2h0KQogICAgICB9OwogICAgfQogIH0sIHsKICAgIGtleTogImlvc1F1ZXJ5IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBpb3NRdWVyeShwb3NpdGlvbikgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHZhciBpbnZva2VQID0gdGhpcy5hcGkuZ2V0Qm94VG9vbHMoKS5pbnZva2VQOyAvLyDotoXov4dpb3NNYXhRdWVyeUNudOasoeaVsOS4lOWQjOWxgua4suafk+Wksei0pQoKICAgICAgaWYgKCsrdGhpcy50aW1lcyA+IHRoaXMuaW9zTWF4UXVlcnlDbnQgJiYgISh0aGlzLmlzU2Nyb2xsVmlld0ZvdW5kICYmIHRoaXMuaXNSZW5kZXJDb21wbGV0ZSkpIHsKICAgICAgICB0aGlzLnBlcmZsb2cucXVlcnlmYWlsID0gK25ldyBEYXRlKCkgLSB0aGlzLnBlcmYucXVlcnlTdGFydDsKICAgICAgICByZXR1cm4gdGhpcy5oNVJ1bigpOwogICAgICB9CgogICAgICB2YXIgcGFyYW1zID0gewogICAgICAgIGNvbnRhaW5lcklkOiB0aGlzLmNpZCwKICAgICAgICBwb3NpdGlvbjogcG9zaXRpb24sCiAgICAgICAgc2Nyb2xsSGVpZ2h0OiBnZW5Eb21IZWlnaHQocG9zaXRpb24uaGVpZ2h0KS5pbm5lcgogICAgICB9OyAvLyDog73lipvotoXml7blkozosIPnlKjlpLHotKXml7bvvIzph43or5XlubbkuJTpgIDljJYKCiAgICAgIGludm9rZVAoJ3ZpZGVvL3NscklzRm91bmRDb250YWluZXJWaWV3JywgewogICAgICAgIHBhcmFtczogcGFyYW1zCiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAvLyBpb3MgYWLlrp7pqozlvIDlhbPvvIzpu5jorqTlgLzkuLow5YWz6Zet5oCB77yMCiAgICAgICAgaWYgKCFkYXRhLmlzU3VwcG9ydFNhbWVMUikgewogICAgICAgICAgcmV0dXJuIF90aGlzMi5oNVJ1bigpOwogICAgICAgIH0KCiAgICAgICAgX3RoaXMyLnBlcmZsb2cubW9kZWwgPSBkYXRhLmRldGFpbE1zZyB8fCBudWxsOwoKICAgICAgICBpZiAoZGF0YS5pc1Njcm9sbFZpZXdGb3VuZCkgewogICAgICAgICAgX3RoaXMyLmlzU2Nyb2xsVmlld0ZvdW5kID0gdHJ1ZTsKCiAgICAgICAgICBpZiAoZGF0YS5pc1JlbmRlckNvbXBsZXRlKSB7CiAgICAgICAgICAgIF90aGlzMi5pc1JlbmRlckNvbXBsZXRlID0gdHJ1ZTsKICAgICAgICAgICAgX3RoaXMyLnBlcmZsb2cuY291bnQgPSBfdGhpczIudGltZXM7CiAgICAgICAgICAgIF90aGlzMi5wZXJmbG9nLnF1ZXJ5c3VjID0gK25ldyBEYXRlKCkgLSBfdGhpczIucGVyZi5xdWVyeVN0YXJ0OwogICAgICAgICAgICBfdGhpczIudGltZXMgPSA5OTk7CiAgICAgICAgICAgIHJldHVybiBfdGhpczIuaW9zSW52b2tlUGxheWVyKCk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBfdGhpczIuaW9zUXVlcnkocG9zaXRpb24pOwogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgIF90aGlzMi5wZXJmbG9nLnF1ZXJ5ZmFpbCA9ICtuZXcgRGF0ZSgpIC0gX3RoaXMyLnBlcmYucXVlcnlTdGFydDsKCiAgICAgICAgX3RoaXMyLmg1UnVuKCk7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogImlvc0ludm9rZVBsYXllciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaW9zSW52b2tlUGxheWVyKCkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIHZhciBzY2hlbWEgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6ICd2aWRlby9zbHJJbnZva2VQbGF5ZXInOwogICAgICB2YXIgY2lkID0gdGhpcy5jaWQ7CgogICAgICB2YXIgX3RoaXMkYXBpJGdldEJveFRvb2xzMiA9IHRoaXMuYXBpLmdldEJveFRvb2xzKCksCiAgICAgICAgICBpbnZva2VQID0gX3RoaXMkYXBpJGdldEJveFRvb2xzMi5pbnZva2VQLAogICAgICAgICAgZ2V0R2xvYmFsRnVuYyA9IF90aGlzJGFwaSRnZXRCb3hUb29sczIuZ2V0R2xvYmFsRnVuYzsgLy8g6K6+572u5LqL5Lu25Zue6LCDCgoKICAgICAgdmFyIGV2ZW50Q2FsbGJhY2sgPSB0aGlzLmFwaS5nZXRQbGF5ZXJDb250cm9sbGVyKCdldmVudENhbGxiYWNrJykgfHwgZ2V0R2xvYmFsRnVuYyhmdW5jdGlvbiAoZXZ0TmFtZSwgZXZ0RGF0YSkgewogICAgICAgIHJldHVybiBfdGhpczMuaW9zUGxheWVyRXZlbnREaXNwYXRjaChldnROYW1lLCBldnREYXRhKTsKICAgICAgfSk7CiAgICAgIHRoaXMuYXBpLnNldFBsYXllckNvbnRyb2xsZXIoJ2V2ZW50Q2FsbGJhY2snLCBldmVudENhbGxiYWNrKTsKICAgICAgdmFyIG9wdGlvbnMgPSB0aGlzLmFwaS5nZXRQbGF5ZXJPcHRpb24oKTsKICAgICAgdmFyIGZ1bGxTY3JlZW5UeXBlID0gb3B0aW9ucy5mdWxsU2NyZWVuVHlwZSB8fCAnd2luZG93RnVsbFNjcmVlbic7IC8vIGpzc2Rr5L2/55SodHJ1ZSBvciBmYWxzZe+8jOerr+S4iuS9v+eUqDEgb3IgMAogICAgICAvLyDpu5jorqTlv73nlaXovazlsY8KCiAgICAgIHZhciBpc0lnbm9yZURldmljZU9yaWVudGF0aW9uID0gIW9wdGlvbnMuaGFzT3duUHJvcGVydHkoJ2lzSWdub3JlRGV2aWNlT3JpZW50YXRpb24nKSB8fCAhIW9wdGlvbnMuaXNJZ25vcmVEZXZpY2VPcmllbnRhdGlvbjsKICAgICAgdmFyIHBhcmFtcyA9IHsKICAgICAgICBjb250YWluZXJJZDogY2lkLAogICAgICAgIGV2ZW50Q2FsbGJhY2s6IGV2ZW50Q2FsbGJhY2ssCiAgICAgICAgdmlkZW9pbmZvOiBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIG9wdGlvbnMpLCB7fSwgewogICAgICAgICAgdmlkOiBvcHRpb25zLnZpZCwKICAgICAgICAgIHZpZGVvVXJsOiBvcHRpb25zLnNyYywKICAgICAgICAgIHBvc3RlckltYWdlOiBvcHRpb25zLnBvc3RlciwKICAgICAgICAgIC8vIGF1dG9QbGF5OiArb3B0aW9ucy5hdXRvcGxheSwKICAgICAgICAgIG11dGVkOiArb3B0aW9ucy5tdXRlZCwKICAgICAgICAgIGxvb3A6ICtvcHRpb25zLmxvb3AsCiAgICAgICAgICBzeW5jUGxheWVyUG9zaXRpb246IDEsCiAgICAgICAgICBmdWxsU2NyZWVuVHlwZTogZnVsbFNjcmVlblR5cGUsCiAgICAgICAgICBpc0lnbm9yZURldmljZU9yaWVudGF0aW9uOiAraXNJZ25vcmVEZXZpY2VPcmllbnRhdGlvbiwKICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZQogICAgICAgICAgZXh0X2xvZzogX29iamVjdFNwcmVhZCh7CiAgICAgICAgICAgIHByZXBhcmVJbnZva2VQbGF5ZXJUaW1lOiB0aGlzLnBlcmYuY2xrCiAgICAgICAgICB9LCBvcHRpb25zLmV4dCB8fCB7fSkKICAgICAgICB9KQogICAgICB9OwogICAgICB2YXIgcGxheWVyID0gdGhpcy5hcGkuZ2V0UGxheWVySW5zdGFuY2UoKTsKICAgICAgaW52b2tlUChzY2hlbWEsIHsKICAgICAgICBwYXJhbXM6IHBhcmFtcwogICAgICB9KS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICBfdGhpczMuYXBpLnNldE1vZGUoJ25hJyk7CgogICAgICAgIF90aGlzMy5wZXJmbG9nLmNyZWF0ZSA9ICtuZXcgRGF0ZSgpIC0gX3RoaXMzLnBlcmYuY3JlYXRlU3RhcnQ7CgogICAgICAgIF90aGlzMy5hcGkuZW1pdCgncmVhZHknLCB7CiAgICAgICAgICBtb2RlOiAnbmEnLAogICAgICAgICAgaXNJT1M6IF90aGlzMy5pc0lPUywKICAgICAgICAgIGlzQW5kcm9pZDogX3RoaXMzLmlzQW5kcm9pZAogICAgICAgIH0pOwoKICAgICAgICB2YXIgX3RoaXMzJGFwaSRnZXRQbGF5ZXJDID0gX3RoaXMzLmFwaS5nZXRQbGF5ZXJDb250cm9sbGVyKCksCiAgICAgICAgICAgIGZyb21DYWNoZSA9IF90aGlzMyRhcGkkZ2V0UGxheWVyQy5mcm9tQ2FjaGUsCiAgICAgICAgICAgIGhpZGVQbGF5aW5nID0gX3RoaXMzJGFwaSRnZXRQbGF5ZXJDLmhpZGVQbGF5aW5nOwoKICAgICAgICBpZiAoZnJvbUNhY2hlICYmIGhpZGVQbGF5aW5nIHx8ICFmcm9tQ2FjaGUgJiYgb3B0aW9ucy5hdXRvcGxheSkgewogICAgICAgICAgX3RoaXMzLmlzRW1pdFBlcmYgPSB0cnVlOwogICAgICAgICAgcGxheWVyLnBsYXkoKTsKCiAgICAgICAgICBfdGhpczMuYXBpLnNldFBsYXllckNvbnRyb2xsZXIoJ2Zyb21DYWNoZScsIGZhbHNlKTsKCiAgICAgICAgICBfdGhpczMuYXBpLnNldFBsYXllckNvbnRyb2xsZXIoJ2hpZGVQbGF5aW5nJywgZmFsc2UpOwogICAgICAgIH0KICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICBfdGhpczMuaDVSdW4oKTsKICAgICAgfSk7CiAgICAgIHRoaXMuaW9zVXBkYXRlUGxheWVyU3RhdHVzKCk7CgogICAgICBpZiAob3B0aW9ucy5oYXNPd25Qcm9wZXJ0eSgndm9sdW1lJykpIHsKICAgICAgICBwbGF5ZXIudm9sdW1lID0gb3B0aW9ucy52b2x1bWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8g5pu05paw57O757uf5aOw6Z+zCiAgICAgICAgaW52b2tlUCgndmlkZW8vc2xyR2V0U3lzdGVtVm9sdW1lJywgewogICAgICAgICAgcGFyYW1zOiB7CiAgICAgICAgICAgIGNvbnRhaW5lcklkOiB0aGlzLmNpZAogICAgICAgICAgfQogICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgcmV0dXJuIF90aGlzMy5hcGkuc2V0UGxheWVyT3B0aW9uKCd2b2x1bWUnLCByZXMudm9sdW1lKTsKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgdGhpcy5hcGkuc2V0UGxheWVyT3B0aW9uKCcnLCB7CiAgICAgICAgZW5kZWQ6IGZhbHNlLAogICAgICAgIHBhdXNlZDogZmFsc2UsCiAgICAgICAgZnVsbHNjcmVlbjogZmFsc2UsCiAgICAgICAgY3VycmVudFRpbWU6IDAsCiAgICAgICAgZHVyYXRpb246IDAsCiAgICAgICAgcmVhZHlTdGF0ZTogMCwKICAgICAgICBuZXR3b3JrU3RhdGU6IDAsCiAgICAgICAgZnVsbFNjcmVlblR5cGU6IGZ1bGxTY3JlZW5UeXBlLAogICAgICAgIGlzSWdub3JlRGV2aWNlT3JpZW50YXRpb246IGlzSWdub3JlRGV2aWNlT3JpZW50YXRpb24sCiAgICAgICAgdGltZUludGVydmFsOiBvcHRpb25zLnRpbWVJbnRlcnZhbCB8fCAxLAogICAgICAgIC8vIGlvc+iuvue9ruaSreaUvuWZqOi/m+W6pumXtOmalAogICAgICAgIGFjY3VyYXRlOiBvcHRpb25zLmFjY3VyYXRlIHx8IGZhbHNlIC8vIGlvc+i3s+i9rOeyvuehruWumuS9jQoKICAgICAgfSk7IC8vIOWIneWni+WMluWFqOWxj+WHveaVsAoKICAgICAgdmFyIGV2MSA9IHRoaXMuYXBpLmdldFBsYXllckNvbnRyb2xsZXIoJ2Z1bGxzY3JlZW5FdnQnKSB8fCBmdW5jdGlvbiAoZSkgewogICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICB9OwoKICAgICAgdGhpcy5hcGkuc2V0UGxheWVyQ29udHJvbGxlcignZnVsbHNjcmVlbkV2dCcsIGV2MSk7CiAgICAgIHRoaXMuaW9zVmlkZW9WaXNpYmxlKCk7CiAgICB9CiAgfSwgewogICAga2V5OiAiaW9zVmlkZW9WaXNpYmxlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBpb3NWaWRlb1Zpc2libGUoKSB7CiAgICAgIHZhciBfdGhpczQgPSB0aGlzOwoKICAgICAgaWYgKHRoaXMuYXBpLmdldFBsYXllckNvbnRyb2xsZXIoJ3Zpc2liaWxpdHlIYW5kbGVyJykpIHsKICAgICAgICAvLyDpgb/lhY3ph43lpI3lop7liqAKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHZhciBzdGF0ZSA9ICcnOwogICAgICB2YXIgdmlzaWJpbGl0eUNoYW5nZSA9ICcnOwoKICAgICAgaWYgKHR5cGVvZiBkb2N1bWVudC52aXNpYmlsaXR5U3RhdGUgIT09ICd1bmRlZmluZWQnKSB7CiAgICAgICAgc3RhdGUgPSAndmlzaWJpbGl0eVN0YXRlJzsKICAgICAgICB2aXNpYmlsaXR5Q2hhbmdlID0gJ3Zpc2liaWxpdHljaGFuZ2UnOwogICAgICB9IGVsc2UgaWYgKHR5cGVvZiBkb2N1bWVudC53ZWJraXRWaXNpYmlsaXR5U3RhdGUgIT09ICd1bmRlZmluZWQnKSB7CiAgICAgICAgc3RhdGUgPSAnd2Via2l0VmlzaWJpbGl0eVN0YXRlJzsKICAgICAgICB2aXNpYmlsaXR5Q2hhbmdlID0gJ3dlYmtpdHZpc2liaWxpdHljaGFuZ2UnOwogICAgICB9CgogICAgICBpZiAoIXZpc2liaWxpdHlDaGFuZ2UpIHsKICAgICAgICAvKiBlc2xpbnQtZGlzYWJsZSBuby1jb25zb2xlICovCiAgICAgICAgY29uc29sZS5sb2coJ2Jyb3dzZXIgZG9ub3Qgc3VwcG9ydHMgdGhlIFBhZ2UgVmlzaWJpbGl0eSBBUEkuJyk7CiAgICAgICAgLyogZXNsaW50LWVuYWJsZSBuby1jb25zb2xlICovCgogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIGhhbmRsZXIgPSBmdW5jdGlvbiBoYW5kbGVyKCkgewogICAgICAgIHZhciBwbGF5ZXIgPSBfdGhpczQuYXBpLmdldFBsYXllckluc3RhbmNlKCk7CgogICAgICAgIGlmICghcGxheWVyKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBpZiAoZG9jdW1lbnRbc3RhdGVdID09PSAndmlzaWJsZScpIHsKICAgICAgICAgIGlmIChfdGhpczQuYXBpLmdldFBsYXllckNvbnRyb2xsZXIoJ2hpZGVOZWVkUmVzdW1lJykpIHsKICAgICAgICAgICAgcGxheWVyLnJlc2V0KHsKICAgICAgICAgICAgICBzcmM6IHBsYXllci5zcmMKICAgICAgICAgICAgfSk7IC8vIOmHjee9ruS4jeiDveWQjOatpei/m+W6pu+8jOmcgOimgeiwg+eUqOerr+iDveWKm+WQjOatpeWFt+S9k+ingeaWh+ahowoKICAgICAgICAgICAgcGxheWVyLnBsYXkoKTsKCiAgICAgICAgICAgIF90aGlzNC5hcGkuc2V0UGxheWVyQ29udHJvbGxlcignaGlkZU5lZWRSZXN1bWUnLCBmYWxzZSk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIC8vIOi1t+aSreaIkOWKn++8jOS4lOinhumikeS4jeWkhOS6juaaguWBnOaAgQogICAgICAgICAgaWYgKF90aGlzNC5hcGkuZ2V0UGxheWVyQ29udHJvbGxlcigncGxheWVyS2VybmVsSW5pdCcpICYmICFwbGF5ZXIuZW5kZWQgJiYgIXBsYXllci5wYXVzZWQpIHsKICAgICAgICAgICAgcGxheWVyLnBhdXNlKCk7CgogICAgICAgICAgICBfdGhpczQuYXBpLnNldFBsYXllckNvbnRyb2xsZXIoJ2hpZGVOZWVkUmVzdW1lJywgdHJ1ZSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9OwoKICAgICAgdGhpcy5hcGkuc2V0UGxheWVyQ29udHJvbGxlcigndmlzaWJpbGl0eUNoYW5nZScsIHZpc2liaWxpdHlDaGFuZ2UpOwogICAgICB0aGlzLmFwaS5zZXRQbGF5ZXJDb250cm9sbGVyKCd2aXNpYmlsaXR5SGFuZGxlcicsIGhhbmRsZXIpOyAvLyBzYWZhcmkgNyDlkozlhbbku5bnjrDku6PmtY/op4jlmajnlJ/mlYggYW5kcm9pZCA0LjTlj4rku6XkuIrnlJ/mlYgKCiAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIodmlzaWJpbGl0eUNoYW5nZSwgaGFuZGxlciwgZmFsc2UpOwogICAgICB0aGlzLm5hQmFja1JlY292ZXJ5KCk7CiAgICB9CiAgfSwgewogICAga2V5OiAibmFCYWNrUmVjb3ZlcnkiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG5hQmFja1JlY292ZXJ5KCkgewogICAgICB2YXIgX3RoaXM1ID0gdGhpczsKCiAgICAgIGlmICh0aGlzLmFwaS5nZXRQbGF5ZXJDb250cm9sbGVyKCdwYWdlaGlkZUhhbmRsZXInKSkgewogICAgICAgIC8vIOmBv+WFjemHjeWkjeWinuWKoAogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIHBhZ2VzaG93SGFuZGxlciA9IGZ1bmN0aW9uIHBhZ2VzaG93SGFuZGxlcihlKSB7CiAgICAgICAgaWYgKCFlLnBlcnNpc3RlZCkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0gLy8g5LuO57yT5a2Y5Lit6K+75Y+WCgoKICAgICAgICB2YXIgcGxheWVyID0gX3RoaXM1LmFwaS5nZXRQbGF5ZXJJbnN0YW5jZSgpOwoKICAgICAgICBpZiAoX3RoaXM1LmlzSU9TKSB7CiAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgX3RoaXM1LmFwaS5zZXRQbGF5ZXJDb250cm9sbGVyKCdmcm9tQ2FjaGUnLCB0cnVlKTsKCiAgICAgICAgICAgIF90aGlzNS5wZXJmLmNsayA9ICtuZXcgRGF0ZSgpOwogICAgICAgICAgICBfdGhpczUucGVyZi5jcmVhdGVTdGFydCA9IF90aGlzNS5wZXJmLmNsazsKCiAgICAgICAgICAgIF90aGlzNS5pb3NDcmVhdGVWaWRlbygpOwogICAgICAgICAgfSwgMTApOwogICAgICAgIH0gZWxzZSBpZiAoX3RoaXM1LmFwaS5nZXRQbGF5ZXJDb250cm9sbGVyKCdoaWRlUGxheWluZycpKSB7CiAgICAgICAgICAvLyDlronljZMKICAgICAgICAgIHBsYXllci5wbGF5KCk7CgogICAgICAgICAgX3RoaXM1LmFwaS5nZXRQbGF5ZXJDb250cm9sbGVyKCdoaWRlUGxheWluZycsIGZhbHNlKTsKICAgICAgICB9CiAgICAgIH07CgogICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncGFnZXNob3cnLCBwYWdlc2hvd0hhbmRsZXIpOwogICAgICB0aGlzLmFwaS5zZXRQbGF5ZXJDb250cm9sbGVyKCdwYWdlc2hvd0hhbmRsZXInLCBwYWdlc2hvd0hhbmRsZXIpOwoKICAgICAgdmFyIHBhZ2VoaWRlSGFuZGxlciA9IGZ1bmN0aW9uIHBhZ2VoaWRlSGFuZGxlcigpIHsKICAgICAgICBpZiAoX3RoaXM1LmlzSU9TKSB7CiAgICAgICAgICAvLyDljbjovb3pobXpnaLnp7vpmaRkb20KICAgICAgICAgIF90aGlzNS5yZW1vdmVEb20oKTsKCiAgICAgICAgICBfdGhpczUucGVyZiA9IHt9OwogICAgICAgIH0KCiAgICAgICAgdmFyIHBsYXllciA9IF90aGlzNS5hcGkuZ2V0UGxheWVySW5zdGFuY2UoKTsgLy8g5Yik5pat5q2j5Zyo5pKt5pS+77ya6LW35pKt5oiQ5Yqf77yM5LiU6KeG6aKR5LiN5aSE5LqO5pqC5YGc5oCBCgoKICAgICAgICB2YXIgcGxheWluZyA9IF90aGlzNS5hcGkuZ2V0UGxheWVyQ29udHJvbGxlcigncGxheWVyS2VybmVsSW5pdCcpICYmICFwbGF5ZXIuZW5kZWQgJiYgIXBsYXllci5wYXVzZWQ7IC8vIOato+WcqOaSreaUvueahOinhumikee8k+WtmOaBouWkjeWQjuS7jeeEtuaSreaUvgoKICAgICAgICBfdGhpczUuYXBpLnNldFBsYXllckNvbnRyb2xsZXIoJ2hpZGVQbGF5aW5nJywgcGxheWluZyk7CiAgICAgIH07CgogICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncGFnZWhpZGUnLCBwYWdlaGlkZUhhbmRsZXIpOwogICAgICB0aGlzLmFwaS5zZXRQbGF5ZXJDb250cm9sbGVyKCdwYWdlaGlkZUhhbmRsZXInLCBwYWdlaGlkZUhhbmRsZXIpOwogICAgfQogIH0sIHsKICAgIGtleTogImlvc1VwZGF0ZVBsYXllclN0YXR1cyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaW9zVXBkYXRlUGxheWVyU3RhdHVzKCkgewogICAgICB2YXIgX3RoaXM2ID0gdGhpczsKCiAgICAgIHZhciBpbnZva2VQID0gdGhpcy5hcGkuZ2V0Qm94VG9vbHMoKS5pbnZva2VQOyAvLyDmm7TmlrDmkq3mlL7lmajnirbmgIHliJ3lp4vlgLwKCiAgICAgIGludm9rZVAoJ3ZpZGVvL3NsckdldFBsYXllclN0YXR1cycsIHsKICAgICAgICBwYXJhbXM6IHsKICAgICAgICAgIGNvbnRhaW5lcklkOiB0aGlzLmNpZCwKICAgICAgICAgIGdhdGhlcjogWydtdXRlZCcsICdkdXJhdGlvbicsICdyYXRlJywgJ2xvb3AnXQogICAgICAgIH0KICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgcmV0dXJuIF90aGlzNi5hcGkuc2V0UGxheWVyT3B0aW9uKCcnLCB7CiAgICAgICAgICBtdXRlZDogISFyZXMubXV0ZWQsCiAgICAgICAgICBkdXJhdGlvbjogcmVzLmR1cmF0aW9uIHx8IDAsCiAgICAgICAgICBwbGF5YmFja1JhdGU6IHJlcy5yYXRlLAogICAgICAgICAgbG9vcDogISFyZXMubG9vcAogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJpb3NQbGF5ZXJFdmVudERpc3BhdGNoIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBpb3NQbGF5ZXJFdmVudERpc3BhdGNoKGV2dE5hbWUpIHsKICAgICAgdmFyIGV2dERhdGEgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IHt9OwoKICAgICAgaWYgKCFldnROYW1lIHx8IGV2dERhdGEuY29udGFpbmVySWQgIT09IHRoaXMuY2lkKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBkZWxldGUgZXZ0RGF0YS5jb250YWluZXJJZDsKCiAgICAgIHN3aXRjaCAoZXZ0TmFtZSkgewogICAgICAgIGNhc2UgJ3NsclBsYXllclN0YXRlQ2hhbmdlZCc6CiAgICAgICAgICB0aGlzLmlvc1BsYXllclN0YXR1c0Rpc3BhdGNoKGV2dERhdGEpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgJ3NsckxvYWRpbmdWaWV3U3RhdHVzQ2hhbmdlZCc6CiAgICAgICAgICB0aGlzLmFwaS5zZXRQbGF5ZXJPcHRpb24oJ25ldHdvcmtTdGF0ZScsIDIpOyAvLyBsb2FkaW5n5Lit6K+05piO6KeG6aKR5Zyo5Yqg6L295LitCgogICAgICAgICAgdGhpcy5hcGkuZW1pdCgnbG9hZGluZ2NoYW5nZScsIGV2dERhdGEubG9hZGluZ1Nob3cpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgJ3Nsck11dGVDaGFuZ2VkJzoKICAgICAgICAgIHRoaXMuYXBpLnNldFBsYXllck9wdGlvbignJywgewogICAgICAgICAgICBtdXRlZDogISFldnREYXRhLm11dGVkLAogICAgICAgICAgICB2b2x1bWU6IGV2dERhdGEudm9sdW1lCiAgICAgICAgICB9KTsKICAgICAgICAgIHRoaXMuYXBpLmVtaXQoJ211dGVkY2hhbmdlJywgISFldnREYXRhLm11dGVkKTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICdzbHJTeXN0ZW1Wb2x1bWVDaGFuZ2VkJzoKICAgICAgICAgIHRoaXMuYXBpLnNldFBsYXllck9wdGlvbigndm9sdW1lJywgZXZ0RGF0YS52b2x1bWUpOwogICAgICAgICAgdGhpcy5hcGkuZW1pdCgndm9sdW1lY2hhbmdlJywgZXZ0RGF0YS52b2x1bWUpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgJ3NsclBsYXllclByb2dyZXNzQ2hhbmdlZCc6CiAgICAgICAgICB0aGlzLmFwaS5zZXRQbGF5ZXJPcHRpb24oJycsIHsKICAgICAgICAgICAgY3VycmVudFRpbWU6IGV2dERhdGEuY3VycmVudFRpbWUsCiAgICAgICAgICAgIGR1cmF0aW9uOiBldnREYXRhLmR1cmF0aW9uCiAgICAgICAgICB9KTsKICAgICAgICAgIHRoaXMuYXBpLmVtaXQoJ3RpbWV1cGRhdGUnLCBldnREYXRhLmN1cnJlbnRUaW1lKTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICdzbHJSYXRlQ2hhbmdlZCc6CiAgICAgICAgICB0aGlzLmFwaS5zZXRQbGF5ZXJPcHRpb24oJ3BsYXliYWNrUmF0ZScsIGV2dERhdGEubmV3UmF0ZSk7CiAgICAgICAgICB0aGlzLmFwaS5lbWl0KCdyYXRlY2hhbmdlJywgZXZ0RGF0YS5uZXdSYXRlKTsKICAgICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAiaW9zUGxheWVyU3RhdHVzRGlzcGF0Y2giLAogICAgdmFsdWU6IGZ1bmN0aW9uIGlvc1BsYXllclN0YXR1c0Rpc3BhdGNoKGV2dERhdGEpIHsKICAgICAgdmFyIGV2dG5hbWUgPSAnJzsKCiAgICAgIHN3aXRjaCAoZXZ0RGF0YS5ldmVudCkgewogICAgICAgIGNhc2UgJ29uU3RhcnRQcmVwYXJlJzoKICAgICAgICAgIC8vIOW8gOWni+WHhuWkh+aSreaUvgogICAgICAgICAgZXZ0bmFtZSA9ICdwcmVwYXJlJzsKICAgICAgICAgIHRoaXMuYXBpLnNldFBsYXllck9wdGlvbignJywgewogICAgICAgICAgICBlbmRlZDogZmFsc2UsCiAgICAgICAgICAgIHJlYWR5U3RhdGU6IDEKICAgICAgICAgIH0pOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgJ29uUHJlcGFyZWQnOgogICAgICAgICAgLy8g5YeG5aSH5pKt5pS+57yT5Yay5oiQ5YqfCiAgICAgICAgICBldnRuYW1lID0gJ2NhbnBsYXknOwogICAgICAgICAgdGhpcy5hcGkuc2V0UGxheWVyT3B0aW9uKCdyZWFkeVN0YXRlJywgNCk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAnb25QbGF5U3VjY2Vzcyc6CiAgICAgICAgICAvLyDlkK/mkq3miJDlip8KICAgICAgICAgIHRoaXMuYXBpLnNldFBsYXllckNvbnRyb2xsZXIoJ3BsYXllcktlcm5lbEluaXQnLCB0cnVlKTsKICAgICAgICAgIHRoaXMucGVyZmxvZy5jbGsycGxheSA9ICtuZXcgRGF0ZSgpIC0gdGhpcy5wZXJmLmNsazsKICAgICAgICAgIHRoaXMuaW9zVXBkYXRlUGxheWVyU3RhdHVzKCk7IC8vIOWQr+aSreWQjuabtOaWsOaSreaUvuWZqOS/oeaBr++8jOWwpOWFtuaYr2R1cmF0aW9u5Zyo5ZCv5pKt5ZCO5omN6IO95b6X5YiwCgogICAgICAgICAgdGhpcy5pc0VtaXRQZXJmICYmIHRoaXMuZW1pdFBlcmZFdmVudCgpOwoKICAgICAgICBjYXNlICdvblJlcGxheSc6CiAgICAgICAgICAvLyDph43mlrDmkq3mlL4gMTIuMTPlop7liqAKICAgICAgICAgIHRoaXMuYXBpLnNldFBsYXllck9wdGlvbignZW5kZWQnLCBmYWxzZSk7CgogICAgICAgIGNhc2UgJ29uUmVzdW1lUGxheSc6CiAgICAgICAgICAvLyDnu6fnu63mkq3mlL4gMTIuMTPlop7liqAKICAgICAgICAgIHRoaXMuYXBpLmVtaXQoJ3BsYXknKTsKICAgICAgICAgIHRoaXMuYXBpLnNldFBsYXllck9wdGlvbigncGF1c2VkJywgZmFsc2UpOwogICAgICAgICAgZXZ0bmFtZSA9ICdwbGF5aW5nJzsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICdvblBhdXNlZCc6CiAgICAgICAgICAvLyDmmoLlgZwKICAgICAgICAgIGV2dG5hbWUgPSAncGF1c2UnOwogICAgICAgICAgdGhpcy5hcGkuc2V0UGxheWVyT3B0aW9uKCdwYXVzZWQnLCB0cnVlKTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICdvbkZpbmlzaGVkJzoKICAgICAgICAgIC8vIOaSreaUvuWujOaIkAogICAgICAgICAgZXZ0bmFtZSA9ICdlbmRlZCc7CiAgICAgICAgICB0aGlzLmFwaS5zZXRQbGF5ZXJPcHRpb24oJ2VuZGVkJywgdHJ1ZSk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAnb25DbG9zZWQnOgogICAgICAgICAgLy8g5pKt5pS+5Zmo5YWz6ZetCiAgICAgICAgICBldnRuYW1lID0gJ2Nsb3NlZCc7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAnb25FcnJvcic6CiAgICAgICAgICAvLyDmkq3mlL7plJnor68KICAgICAgICAgIGV2dG5hbWUgPSAnZXJyb3InOwogICAgICAgICAgdGhpcy5hcGkuc2V0UGxheWVyT3B0aW9uKCdlcnJvcicsIGV2dERhdGEpOwogICAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICAgIGV2dG5hbWUgJiYgdGhpcy5hcGkuZW1pdChldnRuYW1lKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJhbmRyb2lkQ3JlYXRlVmlkZW8iLAogICAgdmFsdWU6IGZ1bmN0aW9uIGFuZHJvaWRDcmVhdGVWaWRlbygpIHsKICAgICAgdmFyIF90aGlzNyA9IHRoaXM7CgogICAgICB2YXIgcGFnZVVybCA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogJyc7CiAgICAgIHRoaXMuYXBpLnNldE1vZGUoJ25hJyk7CiAgICAgIHRoaXMuYW5kcm9pZE5hRXZlbnQoKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICBfdGhpczcuY3JlYXRlVmlkZW9UYWcoewogICAgICAgICAgJ3Q3LXZpZGVvLXBsYXllci10eXBlJzogJ2g1c2FtZWxheWVyJywKICAgICAgICAgICd0Ny12aWRlby1wbGF5ZXItZXh0JzogcGFnZVVybAogICAgICAgIH0pOwoKICAgICAgICBfdGhpczcuYW5kcm9pZEluaXRQbGF5ZXIoKTsKICAgICAgfSk7CiAgICAgIHRoaXMubmFCYWNrUmVjb3ZlcnkoKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJhbmRyb2lkSW5pdFBsYXllciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gYW5kcm9pZEluaXRQbGF5ZXIoKSB7CiAgICAgIHZhciBfdGhpczggPSB0aGlzOwoKICAgICAgdmFyIHZpZGVvID0gdGhpcy5hcGkuZ2V0VmlkZW9JbnN0YW5jZSgpOwogICAgICB2YXIgb3B0aW9ucyA9IHRoaXMuYXBpLmdldFBsYXllck9wdGlvbigpOyAvLyDkvKDpgJLml6Xlv5cKCiAgICAgIHZhciBsb2cgPSB7fTsKICAgICAgWydmcm9tJywgJ3BhZ2UnLCAndmFsdWUnXS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICBpZiAob3B0aW9ucy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7CiAgICAgICAgICBsb2dba2V5XSA9IG9wdGlvbnNba2V5XTsKICAgICAgICB9CiAgICAgIH0pOyAvLyAxMi4yM+aWsOWinu+8mnBhc3NUaHJvdWdoIOWPr+mFjee9rueahHZpZGVvSW5mb+mAj+S8oOWPguaVsGtleQoKICAgICAgdmFyIHBhc3NUaHJvdWdoID0gWydtcGQnLCAnY2xhcml0eVVybCddLmNvbmNhdChvcHRpb25zLnBhc3NUaHJvdWdoIHx8IFtdKTsgLy8gMTIuMjPmlrDlop52aWRlb0luZm86IOeUqOS6jumAj+S8oOerr+S4iuaSreaUvuWZqOaJqeWxleeahOiDveWKm+Wtl+autQogICAgICAvLyDljY/orq7noa7lrp7mmK/opoHmsYJ2aWRlb1VybOaIlmNsYWlydHnlv4XpobvmnInkuIDkuKo6IGh0dHA6Ly93aWtpLmJhaWR1LmNvbS9wYWdlcy92aWV3cGFnZS5hY3Rpb24/cGFnZUlkPTE1MjIyNzc3MTQKICAgICAgLy8g5LyY5YWI57qn77yabXBkID4gY2xhaXJ0eSA+IHZpZGVvVXJsID4gc3JjCgogICAgICB2YXIgdmlkZW9JbmZvID0gewogICAgICAgIHZpZGVvVXJsOiBvcHRpb25zLnNyYwogICAgICB9OwogICAgICBwYXNzVGhyb3VnaC5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICBvcHRpb25zW2tleV0gJiYgKHZpZGVvSW5mb1trZXldID0gb3B0aW9uc1trZXldKTsKICAgICAgfSk7IC8vIOaMh+S7pOmVv+W6puaciemZkOWItu+8jOWboOatpG1wZOWSjGNsYXJpdHlVcmzlgZrkuIvkupLmlqXlpITnkIYKCiAgICAgIGlmICh2aWRlb0luZm8ubXBkICYmIHZpZGVvSW5mby5jbGFyaXR5VXJsKSB7CiAgICAgICAgZGVsZXRlIHZpZGVvSW5mby5jbGFyaXR5VXJsOwogICAgICB9IC8vIDEyLjnmlrDlop46IGlnbm9yZTRnVG9hc3QgbmVlZFJlYWRMb2NhbFByb2dyZXNzIOiOt+WPluezu+e7n+mfs+mHjwoKCiAgICAgIHZpZGVvLnpldXNWaWRlb0V4dCA9IEpTT04uc3RyaW5naWZ5KHsKICAgICAgICBpZDogdGhpcy5jaWQsCiAgICAgICAgbmFtZTogJ2g1c2FtZWxheWVyJywKICAgICAgICBhY3Rpb246ICdpbml0JywKICAgICAgICBkYXRhOiB7CiAgICAgICAgICB2aWQ6IG9wdGlvbnMudmlkLAogICAgICAgICAgaWdub3JlNGdUb2FzdDogKyEhb3B0aW9ucy5pZ25vcmU0Z1RvYXN0LAogICAgICAgICAgc3luY1Byb2dyZXNzOiArISFvcHRpb25zLm5lZWRSZWFkTG9jYWxQcm9ncmVzcywKICAgICAgICAgIGdldFN5c1ZvbHVtZTogKyghb3B0aW9ucy5oYXNPd25Qcm9wZXJ0eSgndm9sdW1lJykgfHwgb3B0aW9ucy5tdXRlZCksCiAgICAgICAgICB2aWRlb0luZm86IHZpZGVvSW5mbywKICAgICAgICAgIHNhbWVsckxvZzogX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBsb2cpLCB7fSwgewogICAgICAgICAgICBleHRMb2c6IF9vYmplY3RTcHJlYWQoewogICAgICAgICAgICAgIHByZXBhcmVJbnZva2VQbGF5ZXJUaW1lOiB0aGlzLnBlcmYuY2xrCiAgICAgICAgICAgIH0sIG9wdGlvbnMuZXh0IHx8IHt9KQogICAgICAgICAgfSkKICAgICAgICB9CiAgICAgIH0pOwogICAgICB2YXIgcGxheWVyID0gdGhpcy5hcGkuZ2V0UGxheWVySW5zdGFuY2UoKTsKCiAgICAgIHZhciBsb2FkSGFuZGxlciA9IGZ1bmN0aW9uIGxvYWRIYW5kbGVyKCkgewogICAgICAgIC8vIOaSreaUvuWZqOm7mOiupOmdmemfswogICAgICAgIF90aGlzOC5wZXJmbG9nLmNyZWF0ZSA9ICtuZXcgRGF0ZSgpIC0gX3RoaXM4LnBlcmYuY3JlYXRlU3RhcnQ7CgogICAgICAgIGlmIChvcHRpb25zLmhhc093blByb3BlcnR5KCd2b2x1bWUnKSkgewogICAgICAgICAgcGxheWVyLnZvbHVtZSA9IG9wdGlvbnMudm9sdW1lOwogICAgICAgIH0gLy8gMTMuMuaWsOWinu+8muaQnOe0ouaWsOWinueUseerr+S4iuaOp+WItumfs+mHj++8jOWJjeerr+S4jeWGjee7tOaKpOmdmemfs+eKtuaAgQoKCiAgICAgICAgIW9wdGlvbnMudXNlQXV0b1ZvbHVtZSAmJiAocGxheWVyLm11dGVkID0gISFvcHRpb25zLm11dGVkKTsKCiAgICAgICAgaWYgKG9wdGlvbnMuaGFzT3duUHJvcGVydHkoJ3NlZWtTZWNvbmRzJykpIHsKICAgICAgICAgIHBsYXllci5jdXJyZW50VGltZSA9IG9wdGlvbnMuc2Vla1NlY29uZHM7CiAgICAgICAgfQoKICAgICAgICB2aWRlby5yZW1vdmVFdmVudExpc3RlbmVyKCdsb2FkZWRtZXRhZGF0YScsIGxvYWRIYW5kbGVyKTsKICAgICAgfTsgLy8g5Zyo56uv5LiK6L+U5Zueb25QcmVwYXJlZOaSreaUvuWZqOWIm+W7uuWujOaIkOS6i+S7tu+8jOWGheaguOS8muiwg+eUqGxvYWRlZG1ldGFkYXRh5LqL5Lu277yM5Zyo5q2k5aSE55CG5LiA5Lqb6Z+z6YeP562J5LqL5Lu2CgoKICAgICAgdmlkZW8uYWRkRXZlbnRMaXN0ZW5lcignbG9hZGVkbWV0YWRhdGEnLCBsb2FkSGFuZGxlcik7CiAgICAgIHRoaXMuYXBpLmVtaXQoJ3JlYWR5JywgewogICAgICAgIG1vZGU6ICduYScsCiAgICAgICAgaXNJT1M6IHRoaXMuaXNJT1MsCiAgICAgICAgaXNBbmRyb2lkOiB0aGlzLmlzQW5kcm9pZAogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJhbmRyb2lkTmFFdmVudCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gYW5kcm9pZE5hRXZlbnQoKSB7CiAgICAgIHZhciBfdGhpczkgPSB0aGlzOwoKICAgICAgdmFyIF90aGlzJGFwaSRnZXRCb3hUb29sczMgPSB0aGlzLmFwaS5nZXRCb3hUb29scygpLAogICAgICAgICAgaW52b2tlUCA9IF90aGlzJGFwaSRnZXRCb3hUb29sczMuaW52b2tlUCwKICAgICAgICAgIGdldEdsb2JhbEZ1bmMgPSBfdGhpcyRhcGkkZ2V0Qm94VG9vbHMzLmdldEdsb2JhbEZ1bmM7CgogICAgICB2YXIganNjYWxsYmFjayA9IGdldEdsb2JhbEZ1bmMoZnVuY3Rpb24gKGFjdGlvbiwgZGF0YSkgewogICAgICAgIGlmIChhY3Rpb24gIT09ICdjb20uYmFpZHUudmlkZW9wbGF5ZXIub3BlcmF0aW9ucmVzdWx0JyB8fCAhX3RoaXM5LmFwaS5nZXRWaWRlb0luc3RhbmNlKCkpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIHRyeSB7CiAgICAgICAgICBkYXRhID0gSlNPTi5wYXJzZShkYXRhKTsKICAgICAgICB9IGNhdGNoIChlKSB7fQoKICAgICAgICBpZiAoZGF0YS5zdGF0dXMgPT09IDApIHsKICAgICAgICAgIHZhciBpZCA9IF90aGlzOS5hcGkuZ2V0UGxheWVyT3B0aW9uKCdjb250YWluZXJJZCcpOwoKICAgICAgICAgIHZhciB2aWRlbyA9IF90aGlzOS5hcGkuZ2V0VmlkZW9JbnN0YW5jZSgpOwoKICAgICAgICAgIHZhciBwbGF5ZXIgPSBfdGhpczkuYXBpLmdldFBsYXllckluc3RhbmNlKCk7CgogICAgICAgICAgc3dpdGNoIChkYXRhLmFjdGlvbikgewogICAgICAgICAgICBjYXNlICdpbml0JzoKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgLy8g56uv5LiK55qE5pON5L2c5Y+q5pyJ5Zyodm9sdW1l5Li6MOaXtuaJjeaYr+mdmemfs+aTjeS9nO+8jOmdmemfs+aAgeWFs+iBlOeUsXNka+e7tOaKpAoKICAgICAgICAgICAgY2FzZSAndm9sdW1lQ2hhbmdlZCc6CiAgICAgICAgICAgICAgLy8gdm9sdW1lQ2hhbmdlZOWtmOWcqOeJqeeQhuaMiemUruinpuWPkeWSjHZpZGVvLnZvbHVtZei1i+WAvOinpuWPkQogICAgICAgICAgICAgIGlmIChwbGF5ZXIudm9sdW1lID09PSBkYXRhLmRhdGEudm9sdW1lICYmICFfdGhpczkuYXBpLmdldFBsYXllck9wdGlvbigndXNlQXV0b1ZvbHVtZScpKSB7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgfSAvLyDmoLnmja7kuovku7bnu5PmnpzmnaXmjqfliLZvcHRpb27lhoXnmoR2b2x1bWXvvIx2aWRlby52b2x1bWXlj6rnlKjmnaXmlLnlj5jpn7Pph48KCgogICAgICAgICAgICAgIF90aGlzOS5hcGkuc2V0UGxheWVyT3B0aW9uKCd2b2x1bWUnLCBkYXRhLmRhdGEudm9sdW1lKTsKCiAgICAgICAgICAgICAgaWYgKHZpZGVvLnZvbHVtZSAhPT0gZGF0YS5kYXRhLnZvbHVtZSkgewogICAgICAgICAgICAgICAgcGxheWVyLnZvbHVtZSA9IGRhdGEuZGF0YS52b2x1bWU7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBfdGhpczkuYXBpLmVtaXQoJ3ZvbHVtZWNoYW5nZScsIGRhdGEuZGF0YS52b2x1bWUpOyAvLyDotbfmkq3lkI7miY3lj6/mjqfliLbpnZnpn7PnirbmgIEKCgogICAgICAgICAgICAgIGlmICghX3RoaXM5LmFwaS5nZXRQbGF5ZXJDb250cm9sbGVyKCdwbGF5ZXJLZXJuZWxJbml0JykpIHsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGlmIChkYXRhLmRhdGEudm9sdW1lID09PSAwICYmICFwbGF5ZXIubXV0ZWQpIHsKICAgICAgICAgICAgICAgIC8vIOmfs+mHj+S4ujAg572u5Li66Z2Z6Z+z5oCBCiAgICAgICAgICAgICAgICBwbGF5ZXIubXV0ZWQgPSB0cnVlOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgaWYgKGRhdGEuZGF0YS52b2x1bWUgPiAwICYmIHBsYXllci5tdXRlZCkgewogICAgICAgICAgICAgICAgLy8g6Z2Z6Z+z5oCB6Z+z6YeP5Y+Y5YyWIOWPlua2iOmdmemfswogICAgICAgICAgICAgICAgcGxheWVyLm11dGVkID0gZmFsc2U7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgJ3NldE11dGUnOgogICAgICAgICAgICAgIGlmIChwbGF5ZXIubXV0ZWQgIT09ICEhZGF0YS5kYXRhLm11dGVkKSB7CiAgICAgICAgICAgICAgICAvLyDpnZnpn7PnirbmgIHlj5jljJYKICAgICAgICAgICAgICAgIF90aGlzOS5hcGkuc2V0UGxheWVyT3B0aW9uKCdtdXRlZCcsICEhZGF0YS5kYXRhLm11dGVkKTsKCiAgICAgICAgICAgICAgICBfdGhpczkuYXBpLmVtaXQoJ211dGVkY2hhbmdlJywgISFkYXRhLmRhdGEubXV0ZWQpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlICdnZXRTeXNWb2x1bWUnOgogICAgICAgICAgICAgIHZhciBuZXdWb2x1bWUgPSArZGF0YS5kYXRhLnZvbHVtZSA9PT0gMSA/ICtkYXRhLmRhdGEudm9sdW1lIDogK2RhdGEuZGF0YS52b2x1bWUudG9GaXhlZCgzKTsgLy8g5b2Tb3B0aW9u5YaF5rKh5pyJ6YWN572udm9sdW1l5YC85pe277yM5L+d5a2Y6buY6K6k5YC877yM5b2TbG9hZGVkbWV0YWRhdGHop6blj5Hml7bnu5/kuIDorr7nva52b2x1bWUKCiAgICAgICAgICAgICAgX3RoaXM5LmFwaS5zZXRQbGF5ZXJPcHRpb24oJ3ZvbHVtZScsIG5ld1ZvbHVtZSk7CgogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7CiAgICAgIHRoaXMuYXBpLnNldFBsYXllckNvbnRyb2xsZXIoJ29wZXJhdGlvbmpzY2FsbGJhY2snLCBqc2NhbGxiYWNrKTsKICAgICAgcmV0dXJuIGludm9rZVAoJ3Y1L2RhdGFjaGFubmVsL3JlZ2lzdGVyJywgewogICAgICAgIGFjdGlvbjogJ2NvbS5iYWlkdS52aWRlb3BsYXllci5vcGVyYXRpb25yZXN1bHQnLAogICAgICAgIGpzY2FsbGJhY2s6IGpzY2FsbGJhY2sKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAidmlkZW9FdmVudERpc3BhdGNoIiwKICAgIHZhbHVlOiBmdW5jdGlvbiB2aWRlb0V2ZW50RGlzcGF0Y2goKSB7CiAgICAgIHZhciBfdGhpczEwID0gdGhpczsKCiAgICAgIHZhciB2aWRlbyA9IHRoaXMuYXBpLmdldFZpZGVvSW5zdGFuY2UoKTsKICAgICAgdmFyIGlzSDUgPSB0aGlzLmFwaS5nZXRNb2RlKCkgPT09ICdoNSc7CiAgICAgIHZhciBldnRBcnIgPSBbJ2Fib3J0JywgJ2NhbnBsYXknLCAnY2FucGxheXRocm91Z2gnLCAnZHVyYXRpb25jaGFuZ2UnLCAnZW1wdGllZCcsICdlbmRlZCcsICdlcnJvcicsICdsb2FkZWRkYXRhJywgJ2xvYWRlZG1ldGFkYXRhJywgJ2xvYWRzdGFydCcsICdwYXVzZScsICdwbGF5JywgJ3BsYXlpbmcnLCAncHJvZ3Jlc3MnLCAncmF0ZWNoYW5nZScsICdzZWVrZWQnLCAnc2Vla2luZycsICdzdGFsbGVkJywgJ3N1c3BlbmQnLCAndGltZXVwZGF0ZScsICd3YWl0aW5nJywgJ3dlYmtpdGVuZGZ1bGxzY3JlZW4nIC8vIGlPU+S4i+mAgOWHuuWFqOWxj+inpuWPkeS6i+S7tgogICAgICBdOwogICAgICBpc0g1ICYmIGV2dEFyci5wdXNoKCd2b2x1bWVjaGFuZ2UnKTsKICAgICAgdmFyIGV2dEhhbmRsZXIgPSB7fTsKICAgICAgZXZ0QXJyLmZvckVhY2goZnVuY3Rpb24gKGV2dG5hbWUpIHsKICAgICAgICBldnRIYW5kbGVyW2V2dG5hbWVdID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIHZhciBwbGF5ZXJLZXJuZWxJbml0ID0gX3RoaXMxMC5hcGkuZ2V0UGxheWVyQ29udHJvbGxlcigncGxheWVyS2VybmVsSW5pdCcpOwoKICAgICAgICAgIGlmICghaXNINSAmJiAhcGxheWVyS2VybmVsSW5pdCAmJiBldnRuYW1lID09PSAnY2FucGxheScgJiYgX3RoaXMxMC5hcGkuZ2V0UGxheWVyT3B0aW9uKCdhdXRvcGxheScpKSB7CiAgICAgICAgICAgIF90aGlzMTAuaXNFbWl0UGVyZiA9IHRydWU7IC8vIG5h5oOF5Ya15LiL6Ieq5Yqo5pKt5pS+CgogICAgICAgICAgICB2aWRlby5wbGF5KCk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKCFwbGF5ZXJLZXJuZWxJbml0ICYmIGV2dG5hbWUgPT09ICdwbGF5JykgewogICAgICAgICAgICAvLyDpppbmrKFwbGF56Kem5Y+R5omT54K5CiAgICAgICAgICAgIF90aGlzMTAuYXBpLnNldFBsYXllckNvbnRyb2xsZXIoJ3BsYXllcktlcm5lbEluaXQnLCB0cnVlKTsKCiAgICAgICAgICAgIF90aGlzMTAucGVyZmxvZy5jbGsycGxheSA9ICtuZXcgRGF0ZSgpIC0gX3RoaXMxMC5wZXJmLmNsazsKICAgICAgICAgICAgX3RoaXMxMC5pc0VtaXRQZXJmICYmIF90aGlzMTAuZW1pdFBlcmZFdmVudCgpOwogICAgICAgICAgfQoKICAgICAgICAgIF90aGlzMTAuYXBpLmVtaXQoZXZ0bmFtZSwgZSk7CiAgICAgICAgfTsKCiAgICAgICAgdmlkZW8uYWRkRXZlbnRMaXN0ZW5lcihldnRuYW1lLCBldnRIYW5kbGVyW2V2dG5hbWVdKTsKICAgICAgfSk7CiAgICAgIHRoaXMuYXBpLnNldFBsYXllckNvbnRyb2xsZXIoJ3ZpZGVvRXZlbnRIYW5kbGVyJywgZXZ0SGFuZGxlcik7CiAgICAgIHZhciBkb2NFdnRIYW5kbGVyID0ge307CiAgICAgIFsnZnVsbHNjcmVlbmNoYW5nZScsICd3ZWJraXRmdWxsc2NyZWVuY2hhbmdlJywgJ21vemZ1bGxzY3JlZW5jaGFuZ2UnLCAnTVNGdWxsc2NyZWVuQ2hhbmdlJ10uZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgIGRvY0V2dEhhbmRsZXJbaXRlbV0gPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICB2YXIgZnVsbHNjcmVlbkVsID0gZG9jdW1lbnQuZnVsbHNjcmVlbkVsZW1lbnQgfHwgZG9jdW1lbnQud2Via2l0RnVsbHNjcmVlbkVsZW1lbnQgfHwgZG9jdW1lbnQubW96RnVsbFNjcmVlbkVsZW1lbnQgfHwgZG9jdW1lbnQubXNGdWxsc2NyZWVuRWxlbWVudDsKCiAgICAgICAgICBpZiAoZnVsbHNjcmVlbkVsICYmIGZ1bGxzY3JlZW5FbCA9PT0gdmlkZW8pIHsKICAgICAgICAgICAgX3RoaXMxMC5hcGkuc2V0UGxheWVyT3B0aW9uKCdmdWxsc2NyZWVuJywgdHJ1ZSk7CgogICAgICAgICAgICBfdGhpczEwLmFwaS5lbWl0KCdlbnRlcmZ1bGxzY3JlZW4nKTsKICAgICAgICAgIH0gZWxzZSBpZiAoX3RoaXMxMC5hcGkuZ2V0UGxheWVyT3B0aW9uKCdmdWxsc2NyZWVuJykpIHsKICAgICAgICAgICAgX3RoaXMxMC5hcGkuc2V0UGxheWVyT3B0aW9uKCdmdWxsc2NyZWVuJywgZmFsc2UpOwoKICAgICAgICAgICAgX3RoaXMxMC5hcGkuZW1pdCgnZXhpdGZ1bGxzY3JlZW4nKTsKICAgICAgICAgIH0KICAgICAgICB9OwoKICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKGl0ZW0sIGRvY0V2dEhhbmRsZXJbaXRlbV0pOwogICAgICB9KTsKICAgICAgdGhpcy5hcGkuc2V0UGxheWVyQ29udHJvbGxlcignZG9jRXZlbnRIYW5kbGVyJywgZG9jRXZ0SGFuZGxlcik7CiAgICB9CiAgfSwgewogICAga2V5OiAiY3JlYXRlVmlkZW9UYWciLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNyZWF0ZVZpZGVvVGFnKCkgewogICAgICB2YXIgYXR0ciA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDoge307CiAgICAgIHZhciByb290ID0gdGhpcy5hcGkuZ2V0Um9vdCgpOwogICAgICB2YXIgb3B0aW9ucyA9IHRoaXMuYXBpLmdldFBsYXllck9wdGlvbigpOwogICAgICB2YXIgdmlkZW8gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd2aWRlbycpOwogICAgICB2YXIgd2lkdGggPSBvcHRpb25zLndpZHRoID8gb3B0aW9ucy53aWR0aCArICdweCcgOiAnMTAwJSc7CiAgICAgIHZhciBoZWlnaHQgPSBvcHRpb25zLmhlaWdodCA/IG9wdGlvbnMuaGVpZ2h0ICsgJ3B4JyA6ICcxMDAlJzsKICAgICAgdmlkZW8uc3R5bGUgPSAnd2lkdGg6JyArIHdpZHRoICsgJzsgaGVpZ2h0OiAnICsgaGVpZ2h0ICsgJzsnICsgKG9wdGlvbnMudmlkZW9HcmF2aXR5ID09PSAyID8gJ29iamVjdC1maXQ6IGNvdmVyOycgOiAnJyk7CiAgICAgIE9iamVjdC5rZXlzKGF0dHIpLmZvckVhY2goZnVuY3Rpb24gKG5hbWUpIHsKICAgICAgICByZXR1cm4gdmlkZW8uc2V0QXR0cmlidXRlKG5hbWUsIGF0dHJbbmFtZV0pOwogICAgICB9KTsKICAgICAgcm9vdC5hcHBlbmRDaGlsZCh2aWRlbyk7IC8vIOS/ruaUueaSreaUvuS/oeaBrwoKICAgICAgdmFyIHByb3BBcnIgPSBbJ2NvbnRyb2xzJywgJ2xvb3AnLCAnbWVkaWFHcm91cCcsICdwbGF5YmFja1JhdGUnLCAncHJlbG9hZCcsICdzcmMnLCAncG9zdGVyJywgJ3ZvbHVtZSddOyAvLyBoNXZpZGVv6K6+572ubXV0ZWQKCiAgICAgIHRoaXMuYXBpLmdldE1vZGUoKSA9PT0gJ2g1JyAmJiAocHJvcEFyciA9IHByb3BBcnIuY29uY2F0KFsnbXV0ZWQnLCAnYXV0b3BsYXknXSkpOwogICAgICBPYmplY3Qua2V5cyhvcHRpb25zKS5maWx0ZXIoZnVuY3Rpb24gKGVsZSkgewogICAgICAgIHJldHVybiBwcm9wQXJyLmluZGV4T2YoZWxlKSA+IC0xOwogICAgICB9KS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICB0cnkgewogICAgICAgICAgdmlkZW9ba2V5XSA9IG9wdGlvbnNba2V5XTsKICAgICAgICB9IGNhdGNoIChlKSB7fQogICAgICB9KTsKICAgICAgdGhpcy5hcGkuc2V0UGxheWVyT3B0aW9uKCdjb250YWluZXJJZCcsIHRoaXMuY2lkKTsKICAgICAgdGhpcy5hcGkuc2V0VmlkZW9JbnN0YW5jZSh2aWRlbyk7CiAgICAgIHRoaXMudmlkZW9FdmVudERpc3BhdGNoKCk7CiAgICAgIHJldHVybiB2aWRlbzsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJlbWl0UGVyZkV2ZW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBlbWl0UGVyZkV2ZW50KCkgewogICAgICB2YXIgX3RoaXMkcGVyZiA9IHRoaXMucGVyZiwKICAgICAgICAgIGNsayA9IF90aGlzJHBlcmYuY2xrLAogICAgICAgICAgcXVlcnlTdGFydCA9IF90aGlzJHBlcmYucXVlcnlTdGFydCwKICAgICAgICAgIGNyZWF0ZVN0YXJ0ID0gX3RoaXMkcGVyZi5jcmVhdGVTdGFydDsKICAgICAgdGhpcy5wZXJmbG9nLmNsazJjcmVhdGUgPSBjcmVhdGVTdGFydCAtIGNsazsKCiAgICAgIGlmIChxdWVyeVN0YXJ0KSB7CiAgICAgICAgdGhpcy5wZXJmbG9nLmNsazJxdWVyeSA9IHF1ZXJ5U3RhcnQgLSBjbGs7CiAgICAgIH0gLy8g5oyH5qCH5YyF5ous77yaCiAgICAgIC8vIOeCueWHu+WIsOaSreaUvuiAl+aXtmNsazJwbGF5CiAgICAgIC8vIGlvc+afpeivouasoeaVsO+8mmNvdW50CiAgICAgIC8vIGlvc+afpeivouaIkOWKn+iAl+aXtnF1ZXJ5c3VjCiAgICAgIC8vIGlvc+afpeivouWksei0peiAl+aXtnF1ZXJ5ZmFpbAogICAgICAvLyDliJvlu7rlvIDlp4vliLDnu5PmnZ/ogJfml7ZjcmVhdGUKICAgICAgLy8g54K55Ye75Yiw5Yib5bu65byA5aeL6ICX5pe277yaY2xrMmNyZWF0Ze+8iOWPguiAg+aMh+agh++8iQogICAgICAvLyDngrnlh7vliLDlvIDlp4vmn6Xor6LogJfml7ZjbGsycXVlcnk677yI5Y+C6ICD5oyH5qCH77yJCgoKICAgICAgdGhpcy5hcGkuZW1pdCgncGVyZicsIHRoaXMucGVyZmxvZyk7CiAgICAgIHRoaXMucGVyZmxvZyA9IHt9OwogICAgICB0aGlzLmlzRW1pdFBlcmYgPSBmYWxzZTsKICAgIH0KICAgIC8qKgogICAgKiDph43nva7mkq3mlL7lmajlrr3pq5gKICAgICovCgogIH0sIHsKICAgIGtleTogInJlc2V0UmVjdCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVzZXRSZWN0KHdpZHRoLCBoZWlnaHQpIHsKICAgICAgdmFyIF90aGlzJGFwaSRnZXRCb3hUb29sczQgPSB0aGlzLmFwaS5nZXRCb3hUb29scygpLAogICAgICAgICAgaXNJT1MgPSBfdGhpcyRhcGkkZ2V0Qm94VG9vbHM0LmlzSU9TLAogICAgICAgICAgaW52b2tlUCA9IF90aGlzJGFwaSRnZXRCb3hUb29sczQuaW52b2tlUDsKCiAgICAgIHZhciB2aWRlbyA9IHRoaXMuYXBpLmdldFZpZGVvSW5zdGFuY2UoKTsKCiAgICAgIHZhciBfdGhpcyRhcGkkZ2V0UGxheWVyT3AgPSB0aGlzLmFwaS5nZXRQbGF5ZXJPcHRpb24oKSwKICAgICAgICAgIGNvbnRhaW5lcklkID0gX3RoaXMkYXBpJGdldFBsYXllck9wLmNvbnRhaW5lcklkLAogICAgICAgICAgdmlkZW9HcmF2aXR5ID0gX3RoaXMkYXBpJGdldFBsYXllck9wLnZpZGVvR3Jhdml0eTsKCiAgICAgIHZhciBpc25hSU9TID0gdGhpcy5hcGkuZ2V0TW9kZSgpID09PSAnbmEnICYmIGlzSU9TKCk7IC8vIOiwg+aVtOS9jee9rgoKICAgICAgaWYgKGlzbmFJT1MpIHsKICAgICAgICB2YXIgX2dlbkRvbUhlaWdodDIgPSBnZW5Eb21IZWlnaHQoaGVpZ2h0KSwKICAgICAgICAgICAgd3JhcCA9IF9nZW5Eb21IZWlnaHQyLndyYXAsCiAgICAgICAgICAgIGlubmVyID0gX2dlbkRvbUhlaWdodDIuaW5uZXI7CgogICAgICAgIHZhciB2aWRlb0lubmVyID0gdmlkZW8uZmlyc3RDaGlsZDsKICAgICAgICB2aWRlby5zdHlsZS53aWR0aCA9IHdpZHRoICsgJ3B4JzsKICAgICAgICB2aWRlby5zdHlsZS5oZWlnaHQgPSB3cmFwICsgJ3B4JzsKICAgICAgICB2aWRlb0lubmVyLnN0eWxlLmhlaWdodCA9IGlubmVyICsgJ3B4JzsKICAgICAgICBpbnZva2VQKCd2aWRlby9zbHJVcGRhdGVQbGF5ZXJJbmZvJywgewogICAgICAgICAgcGFyYW1zOiB7CiAgICAgICAgICAgIGNvbnRhaW5lcklkOiBjb250YWluZXJJZCwKICAgICAgICAgICAgcG9zaXRpb246IHsKICAgICAgICAgICAgICBsZWZ0OiAwLAogICAgICAgICAgICAgIHRvcDogMCwKICAgICAgICAgICAgICB3aWR0aDogd2lkdGgsCiAgICAgICAgICAgICAgaGVpZ2h0OiBoZWlnaHQKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIHZhciB3ID0gd2lkdGggPyB3aWR0aCArICdweCcgOiAnMTAwJSc7CiAgICAgICAgdmFyIGggPSBoZWlnaHQgPyBoZWlnaHQgKyAncHgnIDogJzEwMCUnOwogICAgICAgIHZpZGVvLnN0eWxlID0gJ3dpZHRoOicgKyB3ICsgJzsgaGVpZ2h0OiAnICsgaCArICc7JyArICh2aWRlb0dyYXZpdHkgPT09IDIgPyAnb2JqZWN0LWZpdDogY292ZXI7JyA6ICcnKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAqIOmHjee9ruaSreaUvuWZqOWPguaVsAogICAgKi8KCiAgfSwgewogICAga2V5OiAicmVzZXQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlc2V0KGNvbmZpZykgewogICAgICB2YXIgdmlkZW8gPSB0aGlzLmFwaS5nZXRWaWRlb0luc3RhbmNlKCk7CgogICAgICBpZiAoIXZpZGVvKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB2YXIgb3B0aW9ucyA9IHRoaXMuYXBpLmdldFBsYXllck9wdGlvbigpOwogICAgICB2YXIgbW9kZSA9IHRoaXMuYXBpLmdldE1vZGUoKTsgLy8g5pu05pS55a696auYCgogICAgICBpZiAoY29uZmlnLndpZHRoIHx8IGNvbmZpZy5oZWlnaHQpIHsKICAgICAgICAvLyDosIPmlbTkvY3nva4KICAgICAgICB0aGlzLnJlc2V0UmVjdChvcHRpb25zLndpZHRoLCBvcHRpb25zLmhlaWdodCk7CiAgICAgICAgY29uZmlnLndpZHRoICYmIGRlbGV0ZSBjb25maWcud2lkdGg7CiAgICAgICAgY29uZmlnLmhlaWdodCAmJiBkZWxldGUgY29uZmlnLmhlaWdodDsKICAgICAgfSAvLyDlj6rosIPmlbTlpKflsI/lsLHnu5PmnZ/miJblvZPliY3orr7nva5oNeeUseeUqOaIt+iHquihjOWkhOeQhumZjee6p+aWueahiAoKCiAgICAgIGlmIChPYmplY3Qua2V5cyhjb25maWcpLmxlbmd0aCA9PT0gMCB8fCBtb2RlID09PSAnaDUnICYmIHRoaXMuYXBpLmdldFBsYXllckNvbnRyb2xsZXIoJ3Nsck9ubHknKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdGhpcy5wZXJmLmNyZWF0ZVN0YXJ0ID0gK25ldyBEYXRlKCk7CiAgICAgIHRoaXMucGVyZi5jbGsgPSBjb25maWcucHJlcGFyZUludm9rZVBsYXllclRpbWUgfHwgdGhpcy5wZXJmLmNyZWF0ZVN0YXJ0OyAvLyDlhoXmoLjph43mlrDliJ3lp4vljJYKCiAgICAgIHRoaXMuYXBpLnNldFBsYXllckNvbnRyb2xsZXIoJ3BsYXllcktlcm5lbEluaXQnLCBmYWxzZSk7IC8vIOabtOaUueWxnuaApwoKICAgICAgaWYgKG1vZGUgPT09ICduYScgJiYgdGhpcy5pc0lPUykgewogICAgICAgIHRoaXMucGVyZi5xdWVyeVN0YXJ0ID0gdGhpcy5wZXJmLmNyZWF0ZVN0YXJ0OwogICAgICAgIHRoaXMuaW9zSW52b2tlUGxheWVyKCd2aWRlby9zbHJTZXRQbGF5ZXJJbmZvJyk7CiAgICAgICAgcmV0dXJuOwogICAgICB9IC8vIOS/ruaUueaSreaUvuWcsOWdgAoKCiAgICAgIHZhciBwcm9wQXJyID0gWydjb250cm9scycsICdsb29wJywgJ21lZGlhR3JvdXAnLCAncGxheWJhY2tSYXRlJywgJ3ByZWxvYWQnLCAnc3JjJywgJ3Bvc3RlcicsICd2b2x1bWUnXTsgLy8gaDV2aWRlb+iuvue9rm11dGVkCgogICAgICBtb2RlID09PSAnaDUnICYmIChwcm9wQXJyID0gcHJvcEFyci5jb25jYXQoWydtdXRlZCcsICdhdXRvcGxheSddKSk7CiAgICAgIE9iamVjdC5rZXlzKG9wdGlvbnMpLmZpbHRlcihmdW5jdGlvbiAoZWxlKSB7CiAgICAgICAgcmV0dXJuIHByb3BBcnIuaW5kZXhPZihlbGUpID4gLTE7CiAgICAgIH0pLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIHRyeSB7CiAgICAgICAgICB2aWRlb1trZXldID0gb3B0aW9uc1trZXldOwogICAgICAgIH0gY2F0Y2ggKGUpIHt9CiAgICAgIH0pOwoKICAgICAgaWYgKG1vZGUgPT09ICdoNScpIHsKICAgICAgICB0aGlzLmFwaS5lbWl0KCdyZWFkeScsIHsKICAgICAgICAgIG1vZGU6ICdoNScsCiAgICAgICAgICBpc0lPUzogdGhpcy5pc0lPUywKICAgICAgICAgIGlzQW5kcm9pZDogdGhpcy5pc0FuZHJvaWQKICAgICAgICB9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLmlzQW5kcm9pZCkgewogICAgICAgIHZpZGVvLnNldEF0dHJpYnV0ZSgndDctdmlkZW8tcGxheWVyLWV4dCcsIG9wdGlvbnMucGFnZVVybCB8fCAnJyk7CiAgICAgICAgdGhpcy5hbmRyb2lkSW5pdFBsYXllcigpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICog5Yib5bu6aDXmkq3mlL7lmagKICAgICovCgogIH0sIHsKICAgIGtleTogImg1UnVuIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBoNVJ1bigpIHsKICAgICAgdGhpcy5hcGkuc2V0TW9kZSgnaDUnKTsgLy8g5riF6ZmkaW9z5q6L55WZZG9tCgogICAgICB0aGlzLnJlbW92ZURvbSgpOwoKICAgICAgaWYgKHRoaXMuYXBpLmdldFBsYXllckNvbnRyb2xsZXIoJ3Nsck9ubHknKSkgewogICAgICAgIC8vIGg16YCA5YyW5pa55qGI55Sx5Lia5Yqh5pa55aSE55CGCiAgICAgICAgdGhpcy5hcGkuZW1pdCgncmVhZHknLCB7CiAgICAgICAgICBtb2RlOiAnaDUnLAogICAgICAgICAgaXNJT1M6IHRoaXMuaXNJT1MsCiAgICAgICAgICBpc0FuZHJvaWQ6IHRoaXMuaXNBbmRyb2lkCiAgICAgICAgfSk7CiAgICAgICAgdGhpcy5lbWl0UGVyZkV2ZW50KCk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB0aGlzLmlzRW1pdFBlcmYgPSAhIXRoaXMuYXBpLmdldFBsYXllck9wdGlvbignYXV0b3BsYXknKTsKICAgICAgdGhpcy5jcmVhdGVWaWRlb1RhZyh7CiAgICAgICAgcGxheXNpbmxpbmU6IHRydWUsCiAgICAgICAgJ3dlYmtpdC1wbGF5c2lubGluZSc6IHRydWUKICAgICAgfSk7CiAgICAgIHRoaXMuYXBpLmVtaXQoJ3JlYWR5JywgewogICAgICAgIG1vZGU6ICdoNScsCiAgICAgICAgaXNJT1M6IHRoaXMuaXNJT1MsCiAgICAgICAgaXNBbmRyb2lkOiB0aGlzLmlzQW5kcm9pZAogICAgICB9KTsKICAgIH0KICB9XSk7CiAgcmV0dXJuIENyZWF0ZTsKfSgpOwoKZXhwb3J0cy5kZWZhdWx0ID0gQ3JlYXRlOw=="},{"version":3,"sources":["/Users/liaohuanyu/projects/baidu-work/baidu/feed3/multi-pages/node_modules/@baidu/xbox-player-mini/plugins/Create.js"],"names":["genDomHeight","height","wrap","inner","Create","api","pluginOptions","perf","perflog","isEmitPerf","on","data","reset","destroy","iosMaxQueryCnt","h5Mode","getVideoInstance","getRoot","options","getPlayerOption","createStart","Date","clk","prepareInvokePlayerTime","getBoxTools","isMainBox","version","versionCompare","isIOS","isAndroid","getRandomName","cid","setPlayerOption","customizedVideo","setPlayerController","iosCreateVideo","androidCreateVideo","pageUrl","h5Run","invokeP","video","controller","getPlayerController","getMode","window","removeEventListener","pagehideHandler","pageshowHandler","eventCallback","params","containerId","document","visibilityChange","visibilityHandler","removeDom","jscallback","operationjscallback","action","Object","keys","videoEventHandler","forEach","evtname","docEventHandler","src","dom","parentNode","removeChild","setVideoInstance","root","rootPos","getContainerBox","width","createElement","className","style","videoInner","precreate","setAttribute","JSON","stringify","videoUrl","vid","playerControlType","appendChild","times","isScrollViewFound","isRenderComplete","position","queryStart","iosQuery","e","bcr","getBoundingClientRect","left","scrollX","top","scrollY","Math","round","queryfail","scrollHeight","then","isSupportSameLR","model","detailMsg","count","querysuc","iosInvokePlayer","catch","schema","getGlobalFunc","evtName","evtData","iosPlayerEventDispatch","fullScreenType","isIgnoreDeviceOrientation","hasOwnProperty","videoinfo","posterImage","poster","muted","loop","syncPlayerPosition","ext_log","ext","player","getPlayerInstance","setMode","create","emit","mode","fromCache","hidePlaying","autoplay","play","iosUpdatePlayerStatus","volume","res","ended","paused","fullscreen","currentTime","duration","readyState","networkState","timeInterval","accurate","ev1","stopPropagation","preventDefault","iosVideoVisible","state","visibilityState","webkitVisibilityState","console","log","handler","pause","addEventListener","naBackRecovery","persisted","setTimeout","playing","gather","playbackRate","rate","iosPlayerStatusDispatch","loadingShow","newRate","event","clk2play","emitPerfEvent","androidNaEvent","createVideoTag","androidInitPlayer","key","passThrough","concat","videoInfo","mpd","clarityUrl","zeusVideoExt","id","name","ignore4gToast","syncProgress","needReadLocalProgress","getSysVolume","samelrLog","extLog","loadHandler","useAutoVolume","seekSeconds","parse","status","newVolume","toFixed","isH5","evtArr","push","evtHandler","playerKernelInit","docEvtHandler","item","fullscreenEl","fullscreenElement","webkitFullscreenElement","mozFullScreenElement","msFullscreenElement","attr","videoGravity","propArr","filter","ele","indexOf","videoEventDispatch","clk2create","clk2query","isnaIOS","firstChild","w","h","config","resetRect","length","playsinline"],"mappings":"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","sourcesContent":["/**\n * @file Create\n * @author zhangtingting12 <zhangtingting12@baidu.com>\n */\n/**\n * ios端内外标签高度\n * @param {number} height 生成ios的特殊dom高度，需要内部高度大于外部，触发overflow:scroll\n */\nconst genDomHeight = height => ({wrap: height, inner: height + 1});\nexport default class Create {\n    constructor(api, pluginOptions) {\n        this.api = api;\n        this.pluginOptions = pluginOptions; // 暂时定义为new Player时用户传过来的\n        this.perf = {}; // 记录时间点:clk点击, createStart开始创建,queryStart开始查询\n        this.perflog = {}; // 记录耗时\n        this.isEmitPerf = false; // 控制性能事件发送\n        this.api.on('reset', data => this.reset(data));\n        this.api.on('destroy', () => this.destroy());\n    }\n    // 可设置查询次数，使用h5模式 h5Mode=true\n    run(iosMaxQueryCnt, h5Mode) {\n        if (this.api.getVideoInstance() || !this.api.getRoot()) {\n            return;\n        }\n        const options = this.api.getPlayerOption();\n        this.perf.createStart = +new Date;\n        this.perf.clk = options.prepareInvokePlayerTime || this.perf.createStart;\n        const {isMainBox, version, versionCompare, isIOS, isAndroid} = this.api.getBoxTools();\n        this.isIOS = isIOS();\n        this.isAndroid = isAndroid();\n        const getRandomName = this.api.getBoxTools().getRandomName;\n        this.cid = getRandomName('h5-samelayer-cid-') || this.cid;\n        this.api.setPlayerOption('containerId', this.cid);\n        // 业务方指定了同层失败不使用默认video标签，也即只触发mode=h5，不创建video\n        options.customizedVideo && this.api.setPlayerController('slrOnly', true);\n        // ios在12.9时功能完全,android在12.10时功能完全\n        if (!h5Mode && isMainBox()\n            && (this.isIOS && versionCompare(version, '12.9') >= 0\n                 || this.isAndroid && versionCompare(version, '12.10') >= 0)\n        ) {\n            if (this.isIOS) {\n                this.iosMaxQueryCnt = iosMaxQueryCnt || 5;\n                return this.iosCreateVideo();\n            }\n            else if (this.isAndroid) {\n                return this.androidCreateVideo(options.pageUrl);\n            }\n        }\n        this.h5Run();\n    }\n    destroy() {\n        const invokeP = this.api.getBoxTools().invokeP;\n        const video = this.api.getVideoInstance();\n        const controller = this.api.getPlayerController();\n        if (this.api.getMode() === 'na') {\n            // 卸载页面事件\n            window.removeEventListener('pagehide', controller.pagehideHandler);\n            window.removeEventListener('pageshow', controller.pageshowHandler);\n            if (this.isIOS) {\n                const eventCallback = controller.eventCallback;\n                window[eventCallback] = () => {};\n                invokeP('video/slrStopPlayer', {params: {containerId: this.cid}});\n                // 卸载页面显隐事件\n                document.removeEventListener(controller.visibilityChange, controller.visibilityHandler);\n                this.removeDom();\n                return;\n            }\n            else if (this.isAndroid) {\n                const jscallback = controller.operationjscallback;\n                window[jscallback] = () => {};\n                invokeP('v5/datachannel/unregister', {\n                    action: 'com.baidu.videoplayer.operationresult',\n                    jscallback\n                });\n            }\n        }\n        // 卸载video事件\n        Object.keys(controller.videoEventHandler).forEach(evtname => (\n            video.removeEventListener(evtname, controller.videoEventHandler[evtname])\n        ));\n        // 卸载全屏事件\n        Object.keys(controller.docEventHandler).forEach(evtname => (\n            document.removeEventListener(evtname, controller.docEventHandler[evtname])\n        ));\n        // android的NA播放器依赖此处销毁\n        video.src = '';\n        this.removeDom();\n    }\n    removeDom() {\n        const dom = this.api.getVideoInstance();\n        if (dom) {\n            dom.parentNode && dom.parentNode.removeChild(dom);\n        }\n        this.api.setVideoInstance(null);\n    }\n    iosCreateVideo() {\n        const root = this.api.getRoot();\n        const rootPos = this.getContainerBox(root);\n        const options = this.api.getPlayerOption();\n        // 没有指定宽高则默认使用外层div的宽高\n        this.width = options.width || rootPos.width;\n        this.height = options.height || rootPos.height;\n        const {wrap, inner} = genDomHeight(this.height);\n        const video = document.createElement('div');\n        video.className = this.cid;\n        video.style = 'width:' + this.width + 'px;height:' + wrap + 'px;'\n            + 'overflow: scroll; -webkit-overflow-scrolling: touch; background-color: transparent;';\n        const videoInner = document.createElement('div');\n        videoInner.style = 'width: 100%; height:' + inner + 'px';\n        // 预创建\n        options.precreate && video.setAttribute('data-precreatevideoinfo', JSON.stringify({\n            videoUrl: options.src,\n            vid: options.vid,\n            playerControlType: options.playerControlType || 0\n        }));\n        // 预取推荐使用单独的prefetch方法\n        // options.prefetchVideoInfo\n        //     && video.setAttribute('data-prefetchvideoinfo', JSON.stringify(options.prefetchVideoInfo));\n        video.appendChild(videoInner);\n        root.appendChild(video);\n        this.times = 0;\n        this.isScrollViewFound = false;\n        this.isRenderComplete = false;\n        this.api.setVideoInstance(video);\n        // 获取video的真实宽高开始查找\n        const position = options.position || this.getContainerBox(video);\n        this.api.setPlayerOption('', {\n            width: this.width,\n            height: this.height,\n            position\n        });\n        this.perf.queryStart = +new Date;\n        this.iosQuery(position);\n    }\n    getContainerBox(e) {\n        const bcr = e.getBoundingClientRect();\n        return {\n            left: bcr.left + window.scrollX,\n            top: bcr.top + window.scrollY,\n            width: Math.round(bcr.width),\n            height: Math.round(bcr.height)\n        };\n    }\n    iosQuery(position) {\n        const invokeP = this.api.getBoxTools().invokeP;\n        // 超过iosMaxQueryCnt次数且同层渲染失败\n        if (++this.times > this.iosMaxQueryCnt && !(this.isScrollViewFound && this.isRenderComplete)) {\n            this.perflog.queryfail = +new Date - this.perf.queryStart;\n            return this.h5Run();\n        }\n        const params = {\n            containerId: this.cid,\n            position: position,\n            scrollHeight: genDomHeight(position.height).inner\n        };\n        // 能力超时和调用失败时，重试并且退化\n        invokeP('video/slrIsFoundContainerView', {params})\n            .then(data => {\n                // ios ab实验开关，默认值为0关闭态，\n                if (!data.isSupportSameLR) {\n                    return this.h5Run();\n                }\n                this.perflog.model = data.detailMsg || null;\n                if (data.isScrollViewFound) {\n                    this.isScrollViewFound = true;\n                    if (data.isRenderComplete) {\n                        this.isRenderComplete = true;\n                        this.perflog.count = this.times;\n                        this.perflog.querysuc = +new Date - this.perf.queryStart;\n                        this.times = 999;\n                        return this.iosInvokePlayer();\n                    }\n                }\n                this.iosQuery(position);\n            }).catch(e => {\n                this.perflog.queryfail = +new Date - this.perf.queryStart;\n                this.h5Run();\n            });\n    }\n    iosInvokePlayer(schema = 'video/slrInvokePlayer') {\n        const cid = this.cid;\n        const {invokeP, getGlobalFunc} = this.api.getBoxTools();\n        // 设置事件回调\n        const eventCallback = this.api.getPlayerController('eventCallback')\n            || (getGlobalFunc((evtName, evtData) => this.iosPlayerEventDispatch(evtName, evtData)));\n        this.api.setPlayerController('eventCallback', eventCallback);\n        const options = this.api.getPlayerOption();\n        const fullScreenType = options.fullScreenType || 'windowFullScreen';\n        // jssdk使用true or false，端上使用1 or 0\n        // 默认忽略转屏\n        const isIgnoreDeviceOrientation = !options.hasOwnProperty('isIgnoreDeviceOrientation') || !!options.isIgnoreDeviceOrientation;\n        const params = {\n            containerId: cid,\n            eventCallback,\n            videoinfo: {\n                ...options,\n                vid: options.vid,\n                videoUrl: options.src,\n                posterImage: options.poster,\n                // autoPlay: +options.autoplay,\n                muted: +options.muted,\n                loop: +options.loop,\n                syncPlayerPosition: 1,\n                fullScreenType,\n                isIgnoreDeviceOrientation: +isIgnoreDeviceOrientation,\n                // eslint-disable-next-line\n                ext_log: {\n                    prepareInvokePlayerTime: this.perf.clk,\n                    ...(options.ext || {})\n                }\n            }\n        };\n        const player = this.api.getPlayerInstance();\n        invokeP(schema, {params})\n            .then(() => {\n                this.api.setMode('na');\n                this.perflog.create = +new Date - this.perf.createStart;\n                this.api.emit('ready', {mode: 'na', isIOS: this.isIOS, isAndroid: this.isAndroid});\n                const {fromCache, hidePlaying} = this.api.getPlayerController();\n                if (fromCache && hidePlaying || !fromCache  && options.autoplay) {\n                    this.isEmitPerf = true;\n                    player.play();\n                    this.api.setPlayerController('fromCache', false);\n                    this.api.setPlayerController('hidePlaying', false);\n                }\n            }).catch(e => {\n                this.h5Run();\n            });\n        this.iosUpdatePlayerStatus();\n        if (options.hasOwnProperty('volume')) {\n            player.volume = options.volume;\n        }\n        else {\n            // 更新系统声音\n            invokeP('video/slrGetSystemVolume', {params: {containerId: this.cid}})\n                .then(res => this.api.setPlayerOption('volume', res.volume));\n        }\n        this.api.setPlayerOption('', {\n            ended: false,\n            paused: false,\n            fullscreen: false,\n            currentTime: 0,\n            duration: 0,\n            readyState: 0,\n            networkState: 0,\n            fullScreenType,\n            isIgnoreDeviceOrientation,\n            timeInterval: (options.timeInterval || 1), // ios设置播放器进度间隔\n            accurate: options.accurate || false // ios跳转精确定位\n        });\n        // 初始化全屏函数\n        const ev1 = this.api.getPlayerController('fullscreenEvt') || (e => {\n            e.stopPropagation();\n            e.preventDefault();\n        });\n        this.api.setPlayerController('fullscreenEvt', ev1);\n        this.iosVideoVisible();\n    }\n    iosVideoVisible() {\n        if (this.api.getPlayerController('visibilityHandler')) {\n            // 避免重复增加\n            return;\n        }\n        let state = '';\n        let visibilityChange = '';\n        if (typeof document.visibilityState !== 'undefined') {\n            state = 'visibilityState';\n            visibilityChange = 'visibilitychange';\n        }\n        else if (typeof document.webkitVisibilityState !== 'undefined') {\n            state = 'webkitVisibilityState';\n            visibilityChange = 'webkitvisibilitychange';\n        }\n        if (!visibilityChange) {\n            /* eslint-disable no-console */\n            console.log('browser donot supports the Page Visibility API.');\n            /* eslint-enable no-console */\n            return;\n        }\n        const handler = () => {\n            const player = this.api.getPlayerInstance();\n            if (!player) {\n                return;\n            }\n            if (document[state] === 'visible') {\n                if (this.api.getPlayerController('hideNeedResume')) {\n                    player.reset({src: player.src}); // 重置不能同步进度，需要调用端能力同步具体见文档\n                    player.play();\n                    this.api.setPlayerController('hideNeedResume', false);\n                }\n            }\n            else {\n                // 起播成功，且视频不处于暂停态\n                if (this.api.getPlayerController('playerKernelInit') && !player.ended && !player.paused) {\n                    player.pause();\n                    this.api.setPlayerController('hideNeedResume', true);\n                }\n            }\n        };\n        this.api.setPlayerController('visibilityChange', visibilityChange);\n        this.api.setPlayerController('visibilityHandler', handler);\n        // safari 7 和其他现代浏览器生效 android 4.4及以上生效\n        document.addEventListener(visibilityChange, handler, false);\n        this.naBackRecovery();\n    }\n    naBackRecovery() {\n        if (this.api.getPlayerController('pagehideHandler')) {\n            // 避免重复增加\n            return;\n        }\n        const pageshowHandler = e => {\n            if (!e.persisted) {\n                return;\n            }\n            // 从缓存中读取\n            const player = this.api.getPlayerInstance();\n            if (this.isIOS) {\n                setTimeout(() => {\n                    this.api.setPlayerController('fromCache', true);\n                    this.perf.clk = +new Date;\n                    this.perf.createStart = this.perf.clk;\n                    this.iosCreateVideo();\n                }, 10);\n            }\n            else if (this.api.getPlayerController('hidePlaying')) { // 安卓\n                player.play();\n                this.api.getPlayerController('hidePlaying', false);\n            }\n        };\n        window.addEventListener('pageshow', pageshowHandler);\n        this.api.setPlayerController('pageshowHandler', pageshowHandler);\n        const pagehideHandler = () => {\n            if (this.isIOS) {\n                // 卸载页面移除dom\n                this.removeDom();\n                this.perf = {};\n            }\n            const player = this.api.getPlayerInstance();\n            // 判断正在播放：起播成功，且视频不处于暂停态\n            const playing = this.api.getPlayerController('playerKernelInit') && !player.ended && !player.paused;\n            // 正在播放的视频缓存恢复后仍然播放\n            this.api.setPlayerController('hidePlaying', playing);\n        };\n        window.addEventListener('pagehide', pagehideHandler);\n        this.api.setPlayerController('pagehideHandler', pagehideHandler);\n    }\n    iosUpdatePlayerStatus() {\n        const invokeP = this.api.getBoxTools().invokeP;\n        // 更新播放器状态初始值\n        invokeP('video/slrGetPlayerStatus', {\n                params: {\n                    containerId: this.cid,\n                    gather: ['muted', 'duration', 'rate', 'loop']\n                }\n            })\n            .then(res => this.api.setPlayerOption('', {\n                muted: !!res.muted,\n                duration: res.duration || 0,\n                playbackRate: res.rate,\n                loop: !!res.loop\n            }));\n    }\n    iosPlayerEventDispatch(evtName, evtData = {}) {\n        if (!evtName || evtData.containerId !== this.cid) {\n            return;\n        }\n        delete evtData.containerId;\n        switch (evtName) {\n            case 'slrPlayerStateChanged':\n                this.iosPlayerStatusDispatch(evtData);\n                break;\n            case 'slrLoadingViewStatusChanged':\n                this.api.setPlayerOption('networkState', 2); // loading中说明视频在加载中\n                this.api.emit('loadingchange', evtData.loadingShow);\n                break;\n            case 'slrMuteChanged':\n                this.api.setPlayerOption('', {\n                    muted: !!evtData.muted,\n                    volume: evtData.volume\n                });\n                this.api.emit('mutedchange', !!evtData.muted);\n                break;\n            case 'slrSystemVolumeChanged':\n                this.api.setPlayerOption('volume', evtData.volume);\n                this.api.emit('volumechange', evtData.volume);\n                break;\n            case 'slrPlayerProgressChanged':\n                this.api.setPlayerOption('', {\n                    currentTime: evtData.currentTime,\n                    duration: evtData.duration\n                });\n                this.api.emit('timeupdate', evtData.currentTime);\n                break;\n            case 'slrRateChanged':\n                this.api.setPlayerOption('playbackRate', evtData.newRate);\n                this.api.emit('ratechange', evtData.newRate);\n                break;\n        }\n    }\n    iosPlayerStatusDispatch(evtData) {\n        let evtname = '';\n        switch (evtData.event) {\n            case 'onStartPrepare': // 开始准备播放\n                evtname = 'prepare';\n                this.api.setPlayerOption('', {\n                    ended: false,\n                    readyState: 1\n                });\n                break;\n            case 'onPrepared': // 准备播放缓冲成功\n                evtname = 'canplay';\n                this.api.setPlayerOption('readyState', 4);\n                break;\n            case 'onPlaySuccess': // 启播成功\n                this.api.setPlayerController('playerKernelInit', true);\n                this.perflog.clk2play = +new Date - this.perf.clk;\n                this.iosUpdatePlayerStatus(); // 启播后更新播放器信息，尤其是duration在启播后才能得到\n                this.isEmitPerf && this.emitPerfEvent();\n            case 'onReplay': // 重新播放 12.13增加\n                this.api.setPlayerOption('ended', false);\n            case 'onResumePlay': // 继续播放 12.13增加\n                this.api.emit('play');\n                this.api.setPlayerOption('paused', false);\n                evtname = 'playing';\n                break;\n            case 'onPaused': // 暂停\n                evtname = 'pause';\n                this.api.setPlayerOption('paused', true);\n                break;\n            case 'onFinished': // 播放完成\n                evtname = 'ended';\n                this.api.setPlayerOption('ended', true);\n                break;\n            case 'onClosed': // 播放器关闭\n                evtname = 'closed';\n                break;\n            case 'onError': // 播放错误\n                evtname = 'error';\n                this.api.setPlayerOption('error', evtData);\n                break;\n        }\n        evtname && this.api.emit(evtname);\n    }\n    androidCreateVideo(pageUrl = '') {\n        this.api.setMode('na');\n        this.androidNaEvent().then(() => {\n            this.createVideoTag({\n                't7-video-player-type': 'h5samelayer',\n                't7-video-player-ext': pageUrl\n            });\n            this.androidInitPlayer();\n        });\n        this.naBackRecovery();\n    }\n    androidInitPlayer() {\n        const video = this.api.getVideoInstance();\n        const options = this.api.getPlayerOption();\n        // 传递日志\n        let log = {};\n        ['from', 'page', 'value'].forEach(key => {\n            if (options.hasOwnProperty(key)) {\n                log[key] = options[key];\n            }\n        });\n        // 12.23新增：passThrough 可配置的videoInfo透传参数key\n        const passThrough = ['mpd', 'clarityUrl'].concat(options.passThrough || []);\n        // 12.23新增videoInfo: 用于透传端上播放器扩展的能力字段\n        // 协议确实是要求videoUrl或clairty必须有一个: http://wiki.baidu.com/pages/viewpage.action?pageId=1522277714\n        // 优先级：mpd > clairty > videoUrl > src\n        const videoInfo = {videoUrl: options.src};\n        passThrough.forEach(key => {\n            options[key] && (videoInfo[key] = options[key]);\n        });\n        // 指令长度有限制，因此mpd和clarityUrl做下互斥处理\n        if (videoInfo.mpd && videoInfo.clarityUrl) {\n            delete videoInfo.clarityUrl;\n        }\n        // 12.9新增: ignore4gToast needReadLocalProgress 获取系统音量\n        video.zeusVideoExt = JSON.stringify({\n            id: this.cid,\n            name: 'h5samelayer',\n            action: 'init',\n            data: {\n                vid: options.vid,\n                ignore4gToast: +(!!options.ignore4gToast),\n                syncProgress: +(!!options.needReadLocalProgress),\n                getSysVolume: +(!options.hasOwnProperty('volume') || options.muted),\n                videoInfo,\n                samelrLog: {\n                    ...log,\n                    extLog: {\n                        prepareInvokePlayerTime: this.perf.clk,\n                        ...(options.ext || {})\n                    }\n                }\n            }\n        });\n        const player = this.api.getPlayerInstance();\n        const loadHandler = () => {\n            // 播放器默认静音\n            this.perflog.create = +new Date - this.perf.createStart;\n            if (options.hasOwnProperty('volume')) {\n                player.volume = options.volume;\n            }\n            // 13.2新增：搜索新增由端上控制音量，前端不再维护静音状态\n            !options.useAutoVolume && (player.muted = !!options.muted);\n            if (options.hasOwnProperty('seekSeconds')) {\n                player.currentTime = options.seekSeconds;\n            }\n            video.removeEventListener('loadedmetadata', loadHandler);\n        };\n        // 在端上返回onPrepared播放器创建完成事件，内核会调用loadedmetadata事件，在此处理一些音量等事件\n        video.addEventListener('loadedmetadata', loadHandler);\n        this.api.emit('ready', {mode: 'na', isIOS: this.isIOS, isAndroid: this.isAndroid});\n    }\n    androidNaEvent() {\n        const {invokeP, getGlobalFunc} = this.api.getBoxTools();\n        const jscallback = getGlobalFunc((action, data) => {\n            if (action !== 'com.baidu.videoplayer.operationresult'\n                || !this.api.getVideoInstance()) {\n                return;\n            }\n            try {\n                data = JSON.parse(data);\n            }\n            catch (e) {}\n            if (data.status === 0) {\n                const id = this.api.getPlayerOption('containerId');\n                const video = this.api.getVideoInstance();\n                const player = this.api.getPlayerInstance();\n                switch (data.action) {\n                    case 'init':\n                        break;\n                    // 端上的操作只有在volume为0时才是静音操作，静音态关联由sdk维护\n                    case 'volumeChanged':\n                        // volumeChanged存在物理按键触发和video.volume赋值触发\n                        if (player.volume === data.data.volume && !this.api.getPlayerOption('useAutoVolume')) {\n                            return;\n                        }\n                        // 根据事件结果来控制option内的volume，video.volume只用来改变音量\n                        this.api.setPlayerOption('volume', data.data.volume);\n                        if (video.volume !== data.data.volume) {\n                            player.volume = data.data.volume;\n                        }\n                        this.api.emit('volumechange', data.data.volume);\n                        // 起播后才可控制静音状态\n                        if (!this.api.getPlayerController('playerKernelInit')) {\n                            return;\n                        }\n                        if (data.data.volume === 0 && !player.muted) {\n                            // 音量为0 置为静音态\n                            player.muted = true;\n                        }\n                        if (data.data.volume > 0 && player.muted) {\n                            // 静音态音量变化 取消静音\n                            player.muted = false;\n                        }\n                        break;\n                    case 'setMute':\n                        if (player.muted !== !!data.data.muted) { // 静音状态变化\n                            this.api.setPlayerOption('muted', !!data.data.muted);\n                            this.api.emit('mutedchange', !!data.data.muted);\n                        }\n                        break;\n                    case 'getSysVolume':\n                        const newVolume = +data.data.volume === 1 ? +data.data.volume : +data.data.volume.toFixed(3);\n                        // 当option内没有配置volume值时，保存默认值，当loadedmetadata触发时统一设置volume\n                        this.api.setPlayerOption('volume', newVolume);\n                        break;\n                }\n            }\n        });\n        this.api.setPlayerController('operationjscallback', jscallback);\n        return invokeP('v5/datachannel/register', {\n            action: 'com.baidu.videoplayer.operationresult',\n            jscallback\n        });\n    }\n    videoEventDispatch() {\n        const video = this.api.getVideoInstance();\n        const isH5 = this.api.getMode() === 'h5';\n        let evtArr = [\n            'abort',\n            'canplay',\n            'canplaythrough',\n            'durationchange',\n            'emptied',\n            'ended',\n            'error',\n            'loadeddata',\n            'loadedmetadata',\n            'loadstart',\n            'pause',\n            'play',\n            'playing',\n            'progress',\n            'ratechange',\n            'seeked',\n            'seeking',\n            'stalled',\n            'suspend',\n            'timeupdate',\n            'waiting',\n            'webkitendfullscreen' // iOS下退出全屏触发事件\n        ];\n        isH5 && evtArr.push('volumechange');\n        const evtHandler = {};\n        evtArr.forEach(evtname => {\n            evtHandler[evtname] = e => {\n                const playerKernelInit = this.api.getPlayerController('playerKernelInit');\n                if (!isH5 && !playerKernelInit && evtname === 'canplay'\n                    && this.api.getPlayerOption('autoplay')) {\n                    this.isEmitPerf = true;\n                    // na情况下自动播放\n                    video.play();\n                }\n                if (!playerKernelInit && evtname === 'play') {\n                    // 首次play触发打点\n                    this.api.setPlayerController('playerKernelInit', true);\n                    this.perflog.clk2play = +new Date - this.perf.clk;\n                    this.isEmitPerf && this.emitPerfEvent();\n                }\n                this.api.emit(evtname, e);\n            };\n            video.addEventListener(evtname, evtHandler[evtname]);\n        });\n        this.api.setPlayerController('videoEventHandler', evtHandler);\n        const docEvtHandler = {};\n        ['fullscreenchange', 'webkitfullscreenchange', 'mozfullscreenchange', 'MSFullscreenChange'].forEach(item => {\n            docEvtHandler[item] = () => {\n                let fullscreenEl = document.fullscreenElement || document.webkitFullscreenElement\n                    || document.mozFullScreenElement || document.msFullscreenElement;\n                if (fullscreenEl && fullscreenEl === video) {\n                    this.api.setPlayerOption('fullscreen', true);\n                    this.api.emit('enterfullscreen');\n                }\n                else if (this.api.getPlayerOption('fullscreen')) {\n                    this.api.setPlayerOption('fullscreen', false);\n                    this.api.emit('exitfullscreen');\n                }\n            };\n            document.addEventListener(item, docEvtHandler[item]);\n        });\n        this.api.setPlayerController('docEventHandler', docEvtHandler);\n    }\n    createVideoTag(attr = {}) {\n        const root = this.api.getRoot();\n        const options = this.api.getPlayerOption();\n        const video = document.createElement('video');\n        const width = options.width ? options.width + 'px' : '100%';\n        const height = options.height ? options.height + 'px' : '100%';\n        video.style = 'width:' + width + '; height: ' + height + ';'\n            + (options.videoGravity === 2 ? 'object-fit: cover;' : '');\n        Object.keys(attr).forEach(name => video.setAttribute(name, attr[name]));\n        root.appendChild(video);\n        // 修改播放信息\n        let propArr = ['controls', 'loop', 'mediaGroup', 'playbackRate',\n            'preload', 'src', 'poster', 'volume'];\n        // h5video设置muted\n        this.api.getMode() === 'h5' && (propArr = propArr.concat(['muted','autoplay']));\n        Object.keys(options).filter(ele => propArr.indexOf(ele) > -1).forEach(key => {\n            try {\n                video[key] = options[key];\n            }\n            catch (e) {}\n        });\n        this.api.setPlayerOption('containerId', this.cid);\n        this.api.setVideoInstance(video);\n        this.videoEventDispatch();\n        return video;\n    }\n    emitPerfEvent() {\n        const {clk, queryStart, createStart} = this.perf;\n        this.perflog.clk2create = createStart - clk;\n        if (queryStart) {\n            this.perflog.clk2query = queryStart - clk;\n        }\n        // 指标包括：\n        // 点击到播放耗时clk2play\n        // ios查询次数：count\n        // ios查询成功耗时querysuc\n        // ios查询失败耗时queryfail\n        // 创建开始到结束耗时create\n        // 点击到创建开始耗时：clk2create（参考指标）\n        // 点击到开始查询耗时clk2query:（参考指标）\n        this.api.emit('perf', this.perflog);\n        this.perflog = {};\n        this.isEmitPerf = false;\n    }\n    /**\n    * 重置播放器宽高\n    */\n    resetRect(width, height) {\n        const {isIOS, invokeP} = this.api.getBoxTools();\n        const video = this.api.getVideoInstance();\n        const {containerId, videoGravity} = this.api.getPlayerOption();\n        const isnaIOS = this.api.getMode() === 'na' && isIOS();\n        // 调整位置\n        if (isnaIOS) {\n            const {wrap, inner} = genDomHeight(height);\n            const videoInner = video.firstChild;\n            video.style.width = width + 'px';\n            video.style.height = wrap + 'px';\n            videoInner.style.height = inner + 'px';\n            invokeP('video/slrUpdatePlayerInfo', {\n                params: {\n                    containerId,\n                    position: {\n                        left: 0,\n                        top: 0,\n                        width,\n                        height\n                    }\n                }\n            });\n        }\n        else {\n            const w = width ? width + 'px' : '100%';\n            const h = height ? height + 'px' : '100%';\n            video.style = 'width:' + w + '; height: ' + h + ';'\n                + (videoGravity === 2 ? 'object-fit: cover;' : '');\n        }\n    }\n    /**\n    * 重置播放器参数\n    */\n    reset(config) {\n        const video = this.api.getVideoInstance();\n        if (!video) {\n            return;\n        }\n        const options = this.api.getPlayerOption();\n        const mode = this.api.getMode();\n        // 更改宽高\n        if (config.width || config.height) {\n            // 调整位置\n            this.resetRect(options.width, options.height);\n            config.width && delete config.width;\n            config.height && delete config.height;\n        }\n        // 只调整大小就结束或当前设置h5由用户自行处理降级方案\n        if (Object.keys(config).length === 0\n            || mode === 'h5' && this.api.getPlayerController('slrOnly')) {\n            return;\n        }\n        this.perf.createStart = +new Date;\n        this.perf.clk = config.prepareInvokePlayerTime || this.perf.createStart;\n        // 内核重新初始化\n        this.api.setPlayerController('playerKernelInit', false);\n        // 更改属性\n        if (mode === 'na' && this.isIOS) {\n            this.perf.queryStart = this.perf.createStart;\n            this.iosInvokePlayer('video/slrSetPlayerInfo');\n            return;\n        }\n        // 修改播放地址\n        let propArr = ['controls', 'loop', 'mediaGroup',\n            'playbackRate', 'preload', 'src', 'poster', 'volume'];\n        // h5video设置muted\n        mode === 'h5' && (propArr = propArr.concat(['muted','autoplay']));\n        Object.keys(options).filter(ele => propArr.indexOf(ele) > -1).forEach(key => {\n            try {\n                video[key] = options[key];\n            }\n            catch (e) {}\n        });\n        if (mode === 'h5') {\n            this.api.emit('ready', {mode: 'h5', isIOS: this.isIOS, isAndroid: this.isAndroid});\n            return;\n        }\n        if (this.isAndroid) {\n            video.setAttribute('t7-video-player-ext', options.pageUrl || '')\n            this.androidInitPlayer();\n        }\n    }\n    /**\n    * 创建h5播放器\n    */\n    h5Run() {\n        this.api.setMode('h5');\n        // 清除ios残留dom\n        this.removeDom();\n        if (this.api.getPlayerController('slrOnly')) { // h5退化方案由业务方处理\n            this.api.emit('ready', {mode: 'h5', isIOS: this.isIOS, isAndroid: this.isAndroid});\n            this.emitPerfEvent();\n            return;\n        }\n        this.isEmitPerf = !!this.api.getPlayerOption('autoplay');\n        this.createVideoTag({\n            playsinline: true,\n            'webkit-playsinline': true\n        });\n        this.api.emit('ready', {mode: 'h5', isIOS: this.isIOS, isAndroid: this.isAndroid});\n    }\n}\n"]}]}
{"remainingRequest":"/Users/liaohuanyu/projects/baidu-work/baidu/feed3/multi-pages/node_modules/babel-loader/lib/index.js??ref--1-2!/Users/liaohuanyu/projects/baidu-work/baidu/feed3/multi-pages/src/pages/news/components/top-carousels/index.js","dependencies":[{"path":"/Users/liaohuanyu/projects/baidu-work/baidu/feed3/multi-pages/src/pages/news/components/top-carousels/index.js","mtime":1695633995761},{"path":"/Users/liaohuanyu/projects/baidu-work/baidu/feed3/multi-pages/node_modules/san-hot-loader/index.js","mtime":1696919525187},{"path":"/Users/liaohuanyu/projects/baidu-work/baidu/feed3/multi-pages/node_modules/cache-loader/dist/cjs.js","mtime":1696919513896},{"path":"/Users/liaohuanyu/projects/baidu-work/baidu/feed3/multi-pages/node_modules/babel-loader/lib/index.js","mtime":1696919524615}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKdmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKCIvVXNlcnMvbGlhb2h1YW55dS9wcm9qZWN0cy9iYWlkdS13b3JrL2JhaWR1L2ZlZWQzL211bHRpLXBhZ2VzL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2ludGVyb3BSZXF1aXJlRGVmYXVsdCIpOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7CgpyZXF1aXJlKCIuL2luZGV4Lmxlc3MiKTsKCnZhciBfdWJjUmVwb3J0U2RrID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJAYmFpZHUvdWJjLXJlcG9ydC1zZGsiKSk7Cgp2YXIgX2luZGV4MiA9IHJlcXVpcmUoIkAvbGliL3V0aWxzL2luZGV4Iik7Cgp2YXIgX2RlZmF1bHQgPSB7CiAgdGVtcGxhdGU6IHJlcXVpcmUoJy4vaW5kZXguaHRtbCcpLAogIGluaXREYXRhOiBmdW5jdGlvbiBpbml0RGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIG1ham9yUHJvZ3JhbXM6IHt9LAogICAgICB0b3BCZzoge30sCiAgICAgIG11dGVkOiBmYWxzZQogICAgfTsKICB9LAogIHZpZGVvQ2xpY2s6IGZ1bmN0aW9uIHZpZGVvQ2xpY2soKSB7CiAgICB2YXIgbWFqb3JQcm9ncmFtcyA9IHRoaXMuZGF0YS5nZXQoJ21ham9yUHJvZ3JhbXMnKSB8fCB7fTsKICAgIHZhciBjbWQgPSBtYWpvclByb2dyYW1zLmNtZCwKICAgICAgICBfbWFqb3JQcm9ncmFtcyRpZCA9IG1ham9yUHJvZ3JhbXMuaWQsCiAgICAgICAgaWQgPSBfbWFqb3JQcm9ncmFtcyRpZCA9PT0gdm9pZCAwID8gJycgOiBfbWFqb3JQcm9ncmFtcyRpZCwKICAgICAgICBfbWFqb3JQcm9ncmFtcyRyZXNvdXIgPSBtYWpvclByb2dyYW1zLnJlc291cmNlX3R5cGUsCiAgICAgICAgcmVzb3VyY2VfdHlwZSA9IF9tYWpvclByb2dyYW1zJHJlc291ciA9PT0gdm9pZCAwID8gJycgOiBfbWFqb3JQcm9ncmFtcyRyZXNvdXI7CiAgICB0aGlzLmZpcmUoJ2NsaWNrSW52b2tlJywgY21kKTsKICAgICgwLCBfdWJjUmVwb3J0U2RrLmRlZmF1bHQpKCdjYXJkTG9nLmV2ZW50JywgewogICAgICB0eXBlOiAndG9wVmlkZW9DbGljaycsCiAgICAgIHZhbHVlOiAndG9wX3ZpZGVvJwogICAgfSk7IC8vIOinhumikeeCueWHu+WIhuWPkeaJk+eCuQoKICAgICgwLCBfaW5kZXgyLmxvZykoJ2NsaycsIHsKICAgICAgcmlkOiBpZCwKICAgICAgcmVzb3VyY2VUeXBlOiByZXNvdXJjZV90eXBlCiAgICB9KTsKICB9LAogIHZpZGVvUGxheUxvZzogZnVuY3Rpb24gdmlkZW9QbGF5TG9nKGlkKSB7CiAgICAoMCwgX3ViY1JlcG9ydFNkay5kZWZhdWx0KSgndmlkZW9Mb2cuZXZlbnQnLCB7CiAgICAgIHR5cGU6ICd2aWRlb1BsYXknLAogICAgICB2YWx1ZTogaWQsCiAgICAgIGV4dDogewogICAgICAgIG5pZDogaWQsCiAgICAgICAgdGltZTogbmV3IERhdGUoKS5nZXRUaW1lKCkKICAgICAgfQogICAgfSk7CiAgfSwKICBtdXRlQ2xpY2s6IGZ1bmN0aW9uIG11dGVDbGljaygpIHsKICAgIC8vIOmdmemfs+aMiemSrgogICAgdmFyIHZpZGVvUmVmID0gdGhpcy5yZWYoJ3ZpZGVvJyk7CiAgICB2YXIgbXV0ZVN0YXR1cyA9IHRoaXMuZGF0YS5nZXQoJ211dGVkJyk7CiAgICB2aWRlb1JlZi5tdXRlZCA9ICFtdXRlU3RhdHVzOwogICAgdGhpcy5kYXRhLnNldCgnbXV0ZWQnLCAhbXV0ZVN0YXR1cyk7CiAgfSwKICBhdHRhY2hlZDogZnVuY3Rpb24gYXR0YWNoZWQoKSB7CiAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgIHZhciB0aWNraW5nID0gZmFsc2U7CiAgICB2YXIgdmlkZW9SZWYgPSB0aGlzLnJlZigndmlkZW8nKTsKICAgIHZhciB2aWRlb1BsYXkgPSB2aWRlb1JlZi5wbGF5KCk7CiAgICB2YXIgbWFqb3JQcm9ncmFtcyA9IHRoaXMuZGF0YS5nZXQoJ21ham9yUHJvZ3JhbXMnKTsKICAgIHZhciBfbWFqb3JQcm9ncmFtcyRpZDIgPSBtYWpvclByb2dyYW1zLmlkLAogICAgICAgIGlkID0gX21ham9yUHJvZ3JhbXMkaWQyID09PSB2b2lkIDAgPyAnJyA6IF9tYWpvclByb2dyYW1zJGlkMiwKICAgICAgICBfbWFqb3JQcm9ncmFtcyRyZXNvdXIyID0gbWFqb3JQcm9ncmFtcy5yZXNvdXJjZV90eXBlLAogICAgICAgIHJlc291cmNlX3R5cGUgPSBfbWFqb3JQcm9ncmFtcyRyZXNvdXIyID09PSB2b2lkIDAgPyAnJyA6IF9tYWpvclByb2dyYW1zJHJlc291cjI7CiAgICB2aWRlb1BsYXkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgIC8vIOWPr+S7peiHquWKqOaSreaUvgogICAgICAvLyDop4bpopHpppbmrKHoh6rliqjmkq3mlL7miZPngrkKICAgICAgX3RoaXMudmlkZW9QbGF5TG9nKGlkKTsKICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHsKICAgICAgLyoqCiAgICAgICAqIOiiq3dlaXhpbuetiemZkOWItgogICAgICAgKiDkuI3lhYHorrjoh6rliqjmkq3mlL4KICAgICAgICovCiAgICAgIC8vIOWFvOWuuXdlaXhpbuiHquWKqOaSreaUvgogICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdXZWl4aW5KU0JyaWRnZVJlYWR5JywgZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gdmlkZW9SZWYucGxheSgpOwogICAgICB9LCBmYWxzZSk7IC8vIOmAieaLqemdmemfs+WQjuWGjeaSreaUvgoKICAgICAgdmlkZW9SZWYubXV0ZWQgPSB0cnVlOwogICAgICB2aWRlb1JlZi5wbGF5KCk7IC8vIOWcqOeUqOaIt+S6pOS6kuWQjuiwg+eUqC5wbGF5KCkKCiAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCd0b3VjaHN0YXJ0JywgZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gdmlkZW9SZWYucGxheSgpOwogICAgICB9KTsgLy8g6KeG6aKR6aaW5qyh6Ieq5Yqo5pKt5pS+5omT54K5CgogICAgICBfdGhpcy52aWRlb1BsYXlMb2coaWQpOwogICAgfSk7CiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgZnVuY3Rpb24gKGUpIHsKICAgICAgaWYgKCF0aWNraW5nKSB7CiAgICAgICAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZShmdW5jdGlvbiAoKSB7CiAgICAgICAgICAoMCwgX2luZGV4Mi5pc0VsZW1lbnRWaXNpYmxlKSh2aWRlb1JlZikgPyB2aWRlb1JlZi5wbGF5KCkgOiB2aWRlb1JlZi5wYXVzZSgpOwogICAgICAgICAgdGlja2luZyA9IGZhbHNlOwogICAgICAgIH0pOwogICAgICAgIHRpY2tpbmcgPSB0cnVlOwogICAgICB9CiAgICB9KTsKICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdwb3BzdGF0ZScsIGZ1bmN0aW9uIChldmVudCkgewogICAgICB2aWRlb1JlZi5jdXJyZW50VGltZSA9IDA7CiAgICAgIHZpZGVvUmVmLnBsYXkoKTsKICAgIH0pOyAvLyDmtYvor5Xml6DovrnmoYYKICAgIC8vIHRoaXMuZGF0YS5zZXQoJ21ham9yUHJvZ3JhbXMud3JhcF9pbWcnLCAnJyk7CiAgICAvLyDlsZXnjrDmiZPngrkKCiAgICAoMCwgX3ViY1JlcG9ydFNkay5kZWZhdWx0KSgnY2FyZExvZy5ldmVudCcsIHsKICAgICAgdHlwZTogJ3RvcFZpZGVvU2hvdycsCiAgICAgIHZhbHVlOiAndG9wX3ZpZGVvJwogICAgfSk7IC8vIOinhumikeWxleeOsOWIhuWPkeaJk+eCuQoKICAgICgwLCBfaW5kZXgyLmxvZykoJ3Nob3cnLCB7CiAgICAgIHJpZDogaWQsCiAgICAgIHJlc291cmNlVHlwZTogcmVzb3VyY2VfdHlwZQogICAgfSk7CiAgfQp9OwpleHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDs="},{"version":3,"sources":["/Users/liaohuanyu/projects/baidu-work/baidu/feed3/multi-pages/src/pages/news/components/top-carousels/index.js"],"names":["template","require","initData","majorPrograms","topBg","muted","videoClick","data","get","cmd","id","resource_type","fire","type","value","rid","resourceType","videoPlayLog","ext","nid","time","Date","getTime","muteClick","videoRef","ref","muteStatus","set","attached","ticking","videoPlay","play","then","res","catch","err","document","addEventListener","e","window","requestAnimationFrame","pause","event","currentTime"],"mappings":"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","sourcesContent":["\nimport './index.less';\nimport ubc from '@baidu/ubc-report-sdk';\nimport {log, isElementVisible} from '@/lib/utils/index';\n\nexport default {\n    template: require('./index.html'),\n\n    initData() {\n        return {\n            majorPrograms: {},\n            topBg: {},\n            muted: false\n        };\n    },\n\n    videoClick() {\n        const majorPrograms = this.data.get('majorPrograms') || {};\n        const {cmd, id = '', resource_type = ''} = majorPrograms;\n        this.fire('clickInvoke', cmd);\n        ubc('cardLog.event', {\n            type: 'topVideoClick',\n            value: 'top_video'\n        });\n        // 视频点击分发打点\n        log('clk', {\n            rid: id,\n            resourceType: resource_type\n        });\n    },\n\n    videoPlayLog(id) {\n        ubc('videoLog.event', {\n            type: 'videoPlay',\n            value: id,\n            ext: {\n                nid: id,\n                time: new Date().getTime()\n            }\n        });\n    },\n\n    muteClick() { // 静音按钮\n        let videoRef = this.ref('video');\n        let muteStatus = this.data.get('muted');\n        videoRef.muted = !muteStatus;\n        this.data.set('muted', !muteStatus);\n    },\n\n    attached() {\n        let ticking = false;\n        let videoRef = this.ref('video');\n        let videoPlay = videoRef.play();\n        let majorPrograms = this.data.get('majorPrograms');\n        const {\n            id = '',\n            resource_type = ''\n        } = majorPrograms;\n\n        videoPlay.then((res) => {\n            // 可以自动播放\n            // 视频首次自动播放打点\n            this.videoPlayLog(id);\n        }).catch((err) => {\n            /**\n             * 被weixin等限制\n             * 不允许自动播放\n             */\n\n            // 兼容weixin自动播放\n            document.addEventListener(\n                'WeixinJSBridgeReady',\n                e => videoRef.play(),\n                false\n            );\n\n            // 选择静音后再播放\n            videoRef.muted = true;\n            videoRef.play();\n\n            // 在用户交互后调用.play()\n            window.addEventListener('touchstart', e => videoRef.play());\n\n            // 视频首次自动播放打点\n            this.videoPlayLog(id);\n        });\n\n        window.addEventListener('scroll', (e) => {\n            if (!ticking) {\n                window.requestAnimationFrame(() => {\n                    isElementVisible(videoRef)\n                        ? videoRef.play()\n                        : videoRef.pause();\n                    ticking = false;\n                });\n\n                ticking = true;\n            }\n        });\n\n        window.addEventListener('popstate', (event) => {\n            videoRef.currentTime = 0;\n            videoRef.play();\n        });\n\n        // 测试无边框\n        // this.data.set('majorPrograms.wrap_img', '');\n        // 展现打点\n        ubc('cardLog.event', {\n            type: 'topVideoShow',\n            value: 'top_video'\n        });\n        // 视频展现分发打点\n        log('show', {\n            rid: id,\n            resourceType: resource_type\n        })\n    }\n};\n"]}]}
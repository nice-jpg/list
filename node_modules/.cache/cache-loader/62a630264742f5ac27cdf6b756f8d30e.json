{"remainingRequest":"/Users/liaohuanyu/projects/baidu-work/baidu/feed3/multi-pages/node_modules/babel-loader/lib/index.js??ref--1-2!/Users/liaohuanyu/projects/baidu-work/baidu/feed3/multi-pages/node_modules/@baidu/xbox-concern/index.js","dependencies":[{"path":"/Users/liaohuanyu/projects/baidu-work/baidu/feed3/multi-pages/node_modules/@baidu/xbox-concern/index.js","mtime":1696919504647},{"path":"/Users/liaohuanyu/projects/baidu-work/baidu/feed3/multi-pages/node_modules/san-hot-loader/index.js","mtime":1696919525187},{"path":"/Users/liaohuanyu/projects/baidu-work/baidu/feed3/multi-pages/node_modules/cache-loader/dist/cjs.js","mtime":1696919513896},{"path":"/Users/liaohuanyu/projects/baidu-work/baidu/feed3/multi-pages/node_modules/babel-loader/lib/index.js","mtime":1696919524615}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKdmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKCIvVXNlcnMvbGlhb2h1YW55dS9wcm9qZWN0cy9iYWlkdS13b3JrL2JhaWR1L2ZlZWQzL211bHRpLXBhZ2VzL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2ludGVyb3BSZXF1aXJlRGVmYXVsdCIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnN5bWJvbCIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmNvbmNhdCIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbHRlciIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZvci1lYWNoIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmdldC1vd24tcHJvcGVydHktZGVzY3JpcHRvciIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5nZXQtb3duLXByb3BlcnR5LWRlc2NyaXB0b3JzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmtleXMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoIik7CgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuZGVmYXVsdCA9IGV4cG9ydHMuU3ViTW9kdWxlID0gdm9pZCAwOwoKdmFyIF9kZWZpbmVQcm9wZXJ0eTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIi9Vc2Vycy9saWFvaHVhbnl1L3Byb2plY3RzL2JhaWR1LXdvcmsvYmFpZHUvZmVlZDMvbXVsdGktcGFnZXMvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZGVmaW5lUHJvcGVydHkiKSk7Cgp2YXIgX3R5cGVvZjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIi9Vc2Vycy9saWFvaHVhbnl1L3Byb2plY3RzL2JhaWR1LXdvcmsvYmFpZHUvZmVlZDMvbXVsdGktcGFnZXMvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvdHlwZW9mIikpOwoKdmFyIF9jbGFzc0NhbGxDaGVjazIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIi9Vc2Vycy9saWFvaHVhbnl1L3Byb2plY3RzL2JhaWR1LXdvcmsvYmFpZHUvZmVlZDMvbXVsdGktcGFnZXMvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvY2xhc3NDYWxsQ2hlY2siKSk7Cgp2YXIgX2NyZWF0ZUNsYXNzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgiL1VzZXJzL2xpYW9odWFueXUvcHJvamVjdHMvYmFpZHUtd29yay9iYWlkdS9mZWVkMy9tdWx0aS1wYWdlcy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9jcmVhdGVDbGFzcyIpKTsKCnZhciBfanNvbjJxdWVyeSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgiQGJhaWR1L3hib3gvanNvbjJxdWVyeSIpKTsKCnZhciBfaXMgPSByZXF1aXJlKCJAYmFpZHUveGJveC9pcyIpOwoKdmFyIF9nZXRCb3hWZXJzaW9uID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJAYmFpZHUveGJveC9nZXQtYm94LXZlcnNpb24iKSk7Cgp2YXIgX3ZlcnNpb25fY29tcGFyZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgiQGJhaWR1L3hib3gvdmVyc2lvbl9jb21wYXJlIikpOwoKdmFyIF9kZXRlY3QgPSByZXF1aXJlKCJAYmFpZHUveGJveC9icm93c2VyL2RldGVjdCIpOwoKdmFyIF9wYmxvZyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgiQGJhaWR1L3hib3gvbW9uaXRvci9wYmxvZyIpKTsKCnZhciBfY2xhc3MgPSByZXF1aXJlKCJAYmFpZHUveGJveC9icm93c2VyL2NsYXNzIik7Cgp2YXIgX2ludm9rZSA9IHJlcXVpcmUoIi4vY29uY2Vybi9pbnZva2UiKTsKCnZhciBfcmVxdWVzdCA9IHJlcXVpcmUoIi4vY29uY2Vybi9yZXF1ZXN0Iik7CgpyZXF1aXJlKCIuL3N0eWxlL2NvbmNlcm4ubGVzcyIpOwoKZnVuY3Rpb24gb3duS2V5cyhvYmplY3QsIGVudW1lcmFibGVPbmx5KSB7IHZhciBrZXlzID0gT2JqZWN0LmtleXMob2JqZWN0KTsgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHsgdmFyIHN5bWJvbHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKG9iamVjdCk7IGlmIChlbnVtZXJhYmxlT25seSkgc3ltYm9scyA9IHN5bWJvbHMuZmlsdGVyKGZ1bmN0aW9uIChzeW0pIHsgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBzeW0pLmVudW1lcmFibGU7IH0pOyBrZXlzLnB1c2guYXBwbHkoa2V5cywgc3ltYm9scyk7IH0gcmV0dXJuIGtleXM7IH0KCmZ1bmN0aW9uIF9vYmplY3RTcHJlYWQodGFyZ2V0KSB7IGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7IHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV0gIT0gbnVsbCA/IGFyZ3VtZW50c1tpXSA6IHt9OyBpZiAoaSAlIDIpIHsgb3duS2V5cyhPYmplY3Qoc291cmNlKSwgdHJ1ZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7ICgwLCBfZGVmaW5lUHJvcGVydHkyLmRlZmF1bHQpKHRhcmdldCwga2V5LCBzb3VyY2Vba2V5XSk7IH0pOyB9IGVsc2UgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMoc291cmNlKSk7IH0gZWxzZSB7IG93bktleXMoT2JqZWN0KHNvdXJjZSkpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc291cmNlLCBrZXkpKTsgfSk7IH0gfSByZXR1cm4gdGFyZ2V0OyB9Cgp2YXIgbGl0ZSA9ICgwLCBfZGV0ZWN0LmlzQm94KSgnbGl0ZScpOwp2YXIgbWlzc2lvbiA9ICgwLCBfZGV0ZWN0LmlzQm94KSgnbWlzc2lvbicpOwp2YXIgaW5mbyA9ICgwLCBfZGV0ZWN0LmlzQm94KSgnaW5mbycpOwp2YXIgdmVyc2lvbiA9ICgwLCBfZ2V0Qm94VmVyc2lvbi5kZWZhdWx0KSgpOwp2YXIgYm9keSA9IGRvY3VtZW50LmJvZHk7CnZhciBlcnJNZXNzYWdlID0ge307CnZhciBob3N0Owp2YXIgZXh0SG9zdDsKdmFyIGlzTWF0cml4ID0gKDAsIF9kZXRlY3QuaXNNYXRyaXgpKCk7IC8vIOefqemYte+8jOWMheaLrOeZvuW6pueci+eciwoKdmFyIGJveEFwcCA9ICgwLCBfZGV0ZWN0LmlzQm94KSgpIHx8IGlzTWF0cml4OyAvLyDkuLvnur/jgIHnn6npmLXvvIjljIXmi6znmb7luqbnnIvnnIvvvIkKCnZhciByZWNlaXZlRGF0YSA9IHt9OwovKioKICog5pW05Liq5YWz5rOo57uE5Lu2CiAqIEBjbGFzcyBTdWJNb2R1bGUKICovCgp2YXIgU3ViTW9kdWxlID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBTdWJNb2R1bGUob3B0aW9ucykgewogICAgKDAsIF9jbGFzc0NhbGxDaGVjazIuZGVmYXVsdCkodGhpcywgU3ViTW9kdWxlKTsKICAgIHRoaXMuaWQgPSBvcHRpb25zLmlkOwogICAgdGhpcy50b2FzdEJvb2wgPSBudWxsOwogICAgdGhpcy50b2FzdFRyYW5zaXRpb24gPSBudWxsOwogICAgdGhpcy5vcHMgPSBvcHRpb25zLm9wcyB8fCB7fTsKICAgIHRoaXMubmVlZFVJID0gdGhpcy5vcHMgJiYgdGhpcy5vcHMubmVlZFVJIHx8IHRydWU7CgogICAgaWYgKHRoaXMubmVlZFVJKSB7CiAgICAgIHRoaXMuY3JlYXRlRG9tKCk7CiAgICB9CgogICAgdGhpcy51YSA9ICgwLCBfZGV0ZWN0LmdldFVhKSgpOwogICAgdGhpcy5pc05ldyA9IGJveEFwcCAmJiAoMCwgX3ZlcnNpb25fY29tcGFyZS5kZWZhdWx0KSh2ZXJzaW9uLCAnNy43LjAnKSA+PSAwOwogICAgdGhpcy5pc05ldzkwID0gYm94QXBwICYmICgwLCBfdmVyc2lvbl9jb21wYXJlLmRlZmF1bHQpKHZlcnNpb24sICc5LjAuMCcpID49IDA7CiAgICB0aGlzLm9wcy5zZnJvbSA9IHRoaXMudWE7CiAgICBvcHRpb25zLmNhdGVpZCAmJiAoMCwgX3BibG9nLmRlZmF1bHQpKCdpbml0JywgW29wdGlvbnMuY2F0ZWlkXSk7CiAgICAhdGhpcy5vcHMubm9QdiAmJiAoMCwgX3BibG9nLmRlZmF1bHQpKCdwdicsIFsnX19zdWJzY3JpYmVDb21wb25lbnRzUHZfXycsIHRoaXMub3BzLCBmdW5jdGlvbiAoKSB7fV0pOwoKICAgIGlmIChsb2NhdGlvbi5wb3J0ICYmICF0aGlzLm9wcy5vbkxpbmUpIHsKICAgICAgaG9zdCA9ICcnOwogICAgICBleHRIb3N0ID0gJyc7CiAgICB9IGVsc2UgewogICAgICBob3N0ID0gJ2h0dHBzOi8vbWJkLmJhaWR1LmNvbSc7CiAgICAgIGV4dEhvc3QgPSAnaHR0cHM6Ly9leHQuYmFpZHUuY29tJzsKICAgIH0KICB9CiAgLyoqCiAgICogZG9t55qE5Yib5bu6CiAgICogQGZ1bmN0aW9uIGNyZWF0ZURvbQogICAqLwoKCiAgKDAsIF9jcmVhdGVDbGFzczIuZGVmYXVsdCkoU3ViTW9kdWxlLCBbewogICAga2V5OiAiY3JlYXRlRG9tIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjcmVhdGVEb20oKSB7CiAgICAgIHZhciB0aGF0ID0gdGhpczsKICAgICAgdmFyIHRvYXN0RG9tID0gewogICAgICAgIG9uZURvbTogZnVuY3Rpb24gb25lRG9tKCkgewogICAgICAgICAgdmFyIHRUaXBzID0gdGhpcy5jcmVhdGVFbGUoKTsgLy8g5o+Q56S6dG9hc3QgZG9tCgogICAgICAgICAgdFRpcHMuY2xhc3NOYW1lID0gJ3N1YnNjcmliZS10b2FzdCBzdWJzY3JpYmUtdG9hc3QtdGlwcyc7CiAgICAgICAgICB0VGlwcy5pZCA9ICJ0b2FzdC10ZXh0LSIuY29uY2F0KHRoYXQuaWQpOwogICAgICAgICAgdmFyIGNvbnREaXYgPSB0aGlzLmNyZWF0ZUVsZSgpOwogICAgICAgICAgY29udERpdi5jbGFzc05hbWUgPSAnc3Vic2NyaWJlLXRpcHMtY29udGV4dCc7CiAgICAgICAgICBjb250RGl2LmlubmVyVGV4dCA9ICflhbPms6jlpLHotKUnOwogICAgICAgICAgdFRpcHMuYXBwZW5kQ2hpbGQoY29udERpdik7CiAgICAgICAgICByZXR1cm4gdFRpcHM7CiAgICAgICAgfSwKICAgICAgICB0d29Eb206IGZ1bmN0aW9uIHR3b0RvbSgpIHsKICAgICAgICAgIHZhciB0Q2xpY2sgPSB0aGlzLmNyZWF0ZUVsZSgpOwogICAgICAgICAgdENsaWNrLmNsYXNzTmFtZSA9ICdzdWJzY3JpYmUtdG9hc3Qgc3Vic2NyaWJlLXRvYXN0LWNsaWNrJzsKICAgICAgICAgIHRDbGljay5pZCA9ICJ0b2FzdC1jbGljay0iLmNvbmNhdCh0aGF0LmlkKTsKICAgICAgICAgIHZhciBzdWNEaXYgPSB0aGlzLmNyZWF0ZUVsZSgpOwogICAgICAgICAgc3VjRGl2LmNsYXNzTmFtZSA9ICdzdWJzY3JpYmUtY2xpY2stY29udGFpbmVyJzsKICAgICAgICAgIC8qIGVzbGludC1kaXNhYmxlIG1heC1sZW4gKi8KCiAgICAgICAgICBzdWNEaXYuaW5uZXJIVE1MID0gJzxkaXYgY2xhc3M9InN1YnNjcmliZS1jbGljay1jb250ZXh0Ij7lhbPms6jmiJDlip/vvIzor7fliLDigJw8c3BhbiBjbGFzcz0ic3Vic2NyaWJlLWNsaWNrLXRleHQyIj7miJHnmoQt5YWz5rOoPC9zcGFuPuKAneafpeecizwvZGl2PjxkaXYgY2xhc3M9InN1YnNjcmliZS1jbGljay1idXR0b24iIG9udG91Y2hzdGFydD0iIj7ljrvmn6XnnIs8L2Rpdj4nOwogICAgICAgICAgLyogZXNsaW50LWVuYWJsZSBtYXgtbGVuICovCgogICAgICAgICAgdENsaWNrLmFwcGVuZENoaWxkKHN1Y0Rpdik7CiAgICAgICAgICByZXR1cm4gdENsaWNrOwogICAgICAgIH0sCiAgICAgICAgY3JlYXRlRWxlOiBmdW5jdGlvbiBjcmVhdGVFbGUoKSB7CiAgICAgICAgICByZXR1cm4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgfQogICAgICB9OwogICAgICB0aGlzLnRvYXN0T25lID0gdG9hc3REb20ub25lRG9tKCk7CiAgICAgIHRoaXMudG9hc3RUd28gPSB0b2FzdERvbS50d29Eb20oKTsKICAgIH0KICAgIC8qKgogICAgICog5YWz5rOo5p+l6K+i5piv5ZCm5piv6K6i6ZiF5o6l5Y+j6L+U5Zue5Zue6LCDCiAgICAgKiDlhbPms6jmjqXlj6PmlofmoaMgaHR0cDovL3dpa2kuYmFpZHUuY29tL3BhZ2VzL3ZpZXdwYWdlLmFjdGlvbj9wYWdlSWQ9MjM3ODA2MTk5CiAgICAgKiBAZnVuY3Rpb24gcmVsYXRlQVBJCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAicmVsYXRlQVBJIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZWxhdGVBUEkoZGF0YSwgY2FsbGJhY2ssIGZhaWxDYWxsYmFjaykgewogICAgICB2YXIgcmVsYXRlSGFuZGxlID0gewogICAgICAgIHBhcmFtc1RpcDogZnVuY3Rpb24gcGFyYW1zVGlwKGRhdGEsIGNhbGxiYWNrKSB7CiAgICAgICAgICAvLyDlj4LmlbDkuI3lr7nmipvlh7rlvILluLjlpITnkIYKICAgICAgICAgIGlmICghZGF0YSB8fCAoMCwgX3R5cGVvZjIuZGVmYXVsdCkoZGF0YSkgIT09ICdvYmplY3QnKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigncGFyYW1zIGVycm9yJyk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAvKiBlc2xpbnQtZGlzYWJsZSBmZWNzLWNhbWVsY2FzZSAqLwogICAgICAgICAgICBpZiAoIWRhdGEudHlwZSB8fCAhZGF0YS5zZnJvbSB8fCAhZGF0YS50aGlyZF9pZCkgewogICAgICAgICAgICAgIC8qIGVzbGludC1lbmFibGUgZmVjcy1jYW1lbGNhc2UgKi8KICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ21pc3NpbmcgcGFyYW1zJyk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoY2FsbGJhY2sgJiYgdHlwZW9mIGNhbGxiYWNrICE9PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdjYWxsYmFjayBtdXN0IGJlIGEgZnVuY3Rpb24nKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgcmVsYXRlUmVxOiBmdW5jdGlvbiByZWxhdGVSZXEoZGF0YSwgY2FsbGJhY2ssIGZhaWxDYWxsYmFjaykgewogICAgICAgICAgLy8g6K+35rGC5YWz5rOo5p+l6K+i5o6l5Y+j5aSE55CGCgogICAgICAgICAgLyogZXNsaW50LWRpc2FibGUgZmVjcy1jYW1lbGNhc2UgKi8KICAgICAgICAgIHZhciB0aGlyZF9pZCA9IGRhdGEudGhpcmRfaWQsCiAgICAgICAgICAgICAgdHlwZSA9IGRhdGEudHlwZSwKICAgICAgICAgICAgICBzZnJvbSA9IGRhdGEuc2Zyb20sCiAgICAgICAgICAgICAgZGlzYWJsZUxvZ2luID0gZGF0YS5kaXNhYmxlTG9naW47CiAgICAgICAgICAvKiBlc2xpbnQtZW5hYmxlIGZlY3MtY2FtZWxjYXNlICovCgogICAgICAgICAgdmFyIHJlbGF0ZWRhdGEgPSAoMCwgX2pzb24ycXVlcnkuZGVmYXVsdCkoewogICAgICAgICAgICB0eXBlOiB0eXBlLAogICAgICAgICAgICBzZnJvbTogc2Zyb20sCgogICAgICAgICAgICAvKiBlc2xpbnQtZGlzYWJsZSBmZWNzLWNhbWVsY2FzZSAqLwogICAgICAgICAgICB0aGlyZF9pZDogKDAsIF9pcy5pc0FycmF5KSh0aGlyZF9pZCkgPyB0aGlyZF9pZC5qb2luKCcsJykgOiB0aGlyZF9pZCwKCiAgICAgICAgICAgIC8qIGVzbGludC1lbmFibGUgZmVjcy1jYW1lbGNhc2UgKi8KICAgICAgICAgICAgLy8gZGlzYWJsZUxvZ2luIOeahOaDheWGteS4i+ivt+axguaOpeWPo+mcgOimgeW4puS4iiB1aWRfY3VpZCDlj4LmlbAKICAgICAgICAgICAgc3RvcmU6IHRoaXMuaXNOZXcgfHwgZGlzYWJsZUxvZ2luID8gJ3VpZF9jdWlkJyA6ICd1aWQnCiAgICAgICAgICB9KTsKICAgICAgICAgIHZhciBzb3J0QVBJID0gIiIuY29uY2F0KGV4dEhvc3QsICIvYXBpL3N1YnNjcmliZS92MS9yZWxhdGlvbi9nZXQ/Y2FsbGJhY2s9PyYiKS5jb25jYXQocmVsYXRlZGF0YSk7CiAgICAgICAgICAoMCwgX3JlcXVlc3QucmVxdWVzdCkoc29ydEFQSSkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgICAgIGNhbGxiYWNrICYmIGNhbGxiYWNrKHJlcyk7CiAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7CiAgICAgICAgICAgIGZhaWxDYWxsYmFjayAmJiBmYWlsQ2FsbGJhY2soZXJyKTsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgcmVsYXRlSGFuZGxlLnBhcmFtc1RpcChkYXRhLCBjYWxsYmFjayk7CiAgICAgIHJlbGF0ZUhhbmRsZS5yZWxhdGVSZXEoZGF0YSwgY2FsbGJhY2ssIGZhaWxDYWxsYmFjayk7CiAgICB9CiAgICAvKioKICAgICAqIHRvYXN0IOWkhOeQhuaYvuekugogICAgICogQGZ1bmN0aW9uIHRvYXN0CiAgICAgKiBAcGFyYW0gY29uZmlnICAgICAgICAgICAge29iamVjdH0gICAg6YWN572u5Y+C5pWwCiAgICAgKiBAcGFyYW0gY29uZmlnLnR5cGUgICAgICAge3N0cmluZ30gICAgdG9hc3TnsbvlnosgY2xpY2vlj6/ngrnlh7vvvIx0aXBz5LuF5o+Q56S6CiAgICAgKiBAcGFyYW0gY29uZmlnLnRleHQgICAgICAge3N0cmluZ30gICAg6YWN572u5paH5qGICiAgICAgKiBAcGFyYW0gY29uZmlnLnVybCAgICAgICAge3N0cmluZ30gICAgdG9hc3Tot7PovazlnLDlnYAg5b2TdHlwZT1jbGlja+aXtueahOi3s+i9rHVybO+8jOm7mOiupOi3syDmiYvnmb7miJHnmoTlhbPms6gKICAgICAqIEBwYXJhbSBjb25maWcuY2FsbGJhY2sgICB7ZnVuY3Rpb259ICDlm57osIPlh73mlbBjYWxsYmFjawogICAgICoKICAgICAqIEB1cGRhdGUgMTEuMeaUueWKqDrmu6HotrN0b2FzdC10aXBzLOaWh+ahiOWumuWItgogICAgICovCgogIH0sIHsKICAgIGtleTogInRvYXN0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiB0b2FzdChjb25maWcpIHsKICAgICAgdmFyIHRoYXQgPSB0aGlzOwogICAgICB2YXIgdG9hc3RIYW5kbGUgPSB7CiAgICAgICAgaW5pdDogZnVuY3Rpb24gaW5pdChjb25maWcpIHsKICAgICAgICAgIHRoaXMucGFyYW1UaXAoY29uZmlnKTsKCiAgICAgICAgICB0cnkgewogICAgICAgICAgICB0aGlzLmNsZWFyKCk7CiAgICAgICAgICAgIHRoaXMuYWN0aXZlKCk7CiAgICAgICAgICAgIHRoaXMudG9hc3RUeXBlKGNvbmZpZyk7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICBjb25zb2xlLndhcm4oZSk7CiAgICAgICAgICAgIHJldHVybiBlIHx8IGZhbHNlOwogICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgcGFyYW1UaXA6IGZ1bmN0aW9uIHBhcmFtVGlwKGNvbmZpZykgewogICAgICAgICAgLy8g5byC5bi45o+Q56S6CiAgICAgICAgICBpZiAoISgwLCBfaXMuaXNQbGFpbk9iamVjdCkoY29uZmlnKSB8fCAoMCwgX2lzLmlzRW1wdHlPYmplY3QpKGNvbmZpZykpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdwYXJhbXMgZXJyb3IsY29uZmlnIGlzIG5vdCBhIGpzb24nKTsKICAgICAgICAgIH0KCiAgICAgICAgICB2YXIgdHlwZSA9IGNvbmZpZy50eXBlIHx8IG51bGw7CgogICAgICAgICAgaWYgKCF0eXBlIHx8IHR5cGVvZiB0eXBlICE9PSAnc3RyaW5nJykgewogICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ3BhcmFtcyBlcnJvcicpOwogICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgY2xlYXI6IGZ1bmN0aW9uIGNsZWFyKCkgewogICAgICAgICAgdGhhdC50b2FzdEJvb2wgJiYgY2xlYXJUaW1lb3V0KHRoYXQudG9hc3RCb29sKTsKICAgICAgICAgIHRoYXQudG9hc3RUcmFuc2l0aW9uICYmIGNsZWFyVGltZW91dCh0aGF0LnRvYXN0VHJhbnNpdGlvbik7CiAgICAgICAgfSwKICAgICAgICBhY3RpdmU6IGZ1bmN0aW9uIGFjdGl2ZSgpIHsKICAgICAgICAgIHZhciB0b2FzdFF1ZXJ5ID0gYm9keS5xdWVyeVNlbGVjdG9yQWxsKCcuc3Vic2NyaWJlLXRvYXN0Jyk7CiAgICAgICAgICB2YXIgbGVuZ3RoID0gdG9hc3RRdWVyeS5sZW5ndGg7CgogICAgICAgICAgaWYgKGxlbmd0aCkgewogICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgdG9hc3RRdWVyeVtpXS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRvYXN0UXVlcnlbaV0pOwogICAgICAgICAgICAgICgwLCBfY2xhc3MucmVtb3ZlQ2xhc3MpKHRvYXN0UXVlcnlbaV0sICdzdWJzY3JpYmUtYWN0aXZlJyk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIHRvYXN0VHlwZTogZnVuY3Rpb24gdG9hc3RUeXBlKGNvbmZpZykgewogICAgICAgICAgLy8gdG9hc3TnsbvlnosKICAgICAgICAgIHZhciB0eXBlID0gY29uZmlnLnR5cGU7CgogICAgICAgICAgc3dpdGNoICh0eXBlKSB7CiAgICAgICAgICAgIGNhc2UgJ3RpcHMnOgogICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHRoYXQucGJsb2dGdWMoJ3RpcHMnLCB7fSk7CiAgICAgICAgICAgICAgICB0aGlzLnRpcHNGdWMoY29uZmlnKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGNhc2UgJ2NsaWNrJzoKICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB0aGF0LnBibG9nRnVjKCdjbGljaycsIHt9KTsKICAgICAgICAgICAgICAgIHRoYXQuY2xpY2tGdWMoY29uZmlnKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIHRpcHNGdWM6IGZ1bmN0aW9uIHRpcHNGdWMoY29uZmlnKSB7CiAgICAgICAgICAvLyB0aXBz5pa55byPCiAgICAgICAgICB2YXIgY3RleHQgPSBjb25maWcudGV4dCB8fCBudWxsOwoKICAgICAgICAgIGlmIChib3hBcHApIHsKICAgICAgICAgICAgcmV0dXJuICgwLCBfaW52b2tlLmNsaWVudFRvYXN0KShjdGV4dCk7CiAgICAgICAgICB9CgogICAgICAgICAgYm9keS5hcHBlbmRDaGlsZCh0aGF0LnRvYXN0T25lKTsKICAgICAgICAgIHZhciB0b2FzdE9uZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIiN0b2FzdC10ZXh0LSIuY29uY2F0KHRoYXQuaWQpKTsKICAgICAgICAgIHRoYXQudG9hc3RUcmFuc2l0aW9uID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIGlmIChjdGV4dCkgewogICAgICAgICAgICAgIHRvYXN0T25lLnF1ZXJ5U2VsZWN0b3IoJy5zdWJzY3JpYmUtdGlwcy1jb250ZXh0JykuaW5uZXJUZXh0ID0gY3RleHQ7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHRvYXN0T25lLmNsYXNzTmFtZSA9ICdzdWJzY3JpYmUtdG9hc3Qgc3Vic2NyaWJlLXRvYXN0LXRpcHMgc3Vic2NyaWJlLWFjdGl2ZSc7CiAgICAgICAgICB9LCAxMCk7CiAgICAgICAgICB0aGF0LnRvYXN0Qm9vbCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIHRoYXQudG9hc3RPbmUucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGF0LnRvYXN0T25lKTsKICAgICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfQogICAgICAgICAgfSwgMzAwMCk7CiAgICAgICAgfQogICAgICB9OwogICAgICByZXR1cm4gdG9hc3RIYW5kbGUuaW5pdChjb25maWcpOwogICAgfQogICAgLyoqCiAgICAgKiDml6Xlv5fmiZPngrnlhaznlKjmlrnms5XlpITnkIYKICAgICAqIEBmdW5jdGlvbiBwYmxvZ0Z1YwogICAgICogQHBhcmFtIHBvcyAge3N0cmluZ30gLSDnsbvlnosKICAgICAqIEBwYXJhbSBvcHQgIHtvYmplY3R9IC0ge30gfHwg5paw5aKeCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAicGJsb2dGdWMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHBibG9nRnVjKHBvcywgb3B0KSB7CiAgICAgIHZhciBfdGhpcyRvcHMgPSB0aGlzLm9wcywKICAgICAgICAgIHR5cGUgPSBfdGhpcyRvcHMudHlwZSwKICAgICAgICAgIGlzYWxhZGluID0gX3RoaXMkb3BzLmlzYWxhZGluOwogICAgICAoMCwgX3BibG9nLmRlZmF1bHQpKCdldmVudCcsIFsnc3ViQ29tcG9uZW50cycsICdpbnRlcmZhY2UnLCBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIG9wdCksIHt9LCB7CiAgICAgICAgaXNhbGFkaW46IGlzYWxhZGluID8gJzEnIDogJzAnLAogICAgICAgIHVhOiB0aGlzLnVhLAogICAgICAgIHBvczogcG9zLAogICAgICAgIHNvdXJjZTogdHlwZSA/IHR5cGUgOiAnb3RoZXJzJwogICAgICB9KSwgMTgsIGZ1bmN0aW9uICgpIHt9XSk7CiAgICB9CiAgICAvKioKICAgICAqIGNsaWNrIHRvYXN05pa55byPCiAgICAgKiBAcGFyYW0ge09iamVjdH0gY29uZmlnIOmFjee9ruWPguaVsAogICAgICogQHBhcmFtIHtzdHJpbmd9IGNvbmZpZy50eXBlIHRvYXN057G75Z6LIGNsaWNr5Y+v54K55Ye777yMdGlwc+S7heaPkOekugogICAgICogQHBhcmFtIHtzdHJpbmd9IGNvbmZpZy50ZXh0IOmFjee9ruaWh+ahiAogICAgICogQHBhcmFtIHtzdHJpbmd9IGNvbmZpZy51cmwgdG9hc3Tot7PovazlnLDlnYAg5b2TdHlwZT1jbGlja+aXtueahOi3s+i9rHVybO+8jOm7mOiupOi3syDmiYvnmb7miJHnmoTlhbPms6gKICAgICAqIEBmdW5jdGlvbiBjbGlja0Z1YwogICAgICovCgogIH0sIHsKICAgIGtleTogImNsaWNrRnVjIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjbGlja0Z1Yyhjb25maWcpIHsKICAgICAgdmFyIHRoYXQgPSB0aGlzOwogICAgICB2YXIgY2xpY2tIYW5kbGUgPSB7CiAgICAgICAgaW5pdDogZnVuY3Rpb24gaW5pdChjb25maWcpIHsKICAgICAgICAgIGlmICgobGl0ZSB8fCBpbmZvIHx8IG1pc3Npb24pICYmICFjb25maWcuZHVhbnd1KSB7CiAgICAgICAgICAgIC8vIGNsaWNr5pa55byPIGxpdGXjgIHnnIvlpJrlpJrlpITnkIYKICAgICAgICAgICAgcmV0dXJuIHRoaXMudGlwKCflhbPms6jmiJDlip/vvIzor7fliLDigJzmiJHnmoQt5YWz5rOo4oCd5p+l55yLJyk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKHRoYXQuaXNOZXc5MCAmJiAhY29uZmlnLmR1YW53dSkgewogICAgICAgICAgICAvLyBjbGlja+aWueW8jyA5LjDku6XkuIrniYjmnKzmj5DnpLrlpITnkIYKICAgICAgICAgICAgdmFyIHRleHQgPSBjb25maWcudGV4dDsKICAgICAgICAgICAgcmV0dXJuIHRoaXMudGlwKCIiLmNvbmNhdCh0ZXh0ID8gdGV4dCA6ICflhbPms6jmiJDlip8nKSk7CiAgICAgICAgICB9CgogICAgICAgICAgdGhpcy5sb3dUaXAoY29uZmlnKS5pbml0KCk7CiAgICAgICAgICB0aGlzLmxvb2tDbGljayhjb25maWcpOwogICAgICAgIH0sCiAgICAgICAgdGlwOiBmdW5jdGlvbiB0aXAodGV4dCkgewogICAgICAgICAgdGhhdC50b2FzdCh7CiAgICAgICAgICAgIHR5cGU6ICd0aXBzJywKICAgICAgICAgICAgdGV4dDogdGV4dAogICAgICAgICAgfSk7CiAgICAgICAgfSwKICAgICAgICBsb3dUaXA6IGZ1bmN0aW9uIGxvd1RpcChjb25maWcpIHsKICAgICAgICAgIC8vIOS9jueJiOacrHRvYXN05aSE55CGCiAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICBpbml0OiBmdW5jdGlvbiBpbml0KCkgewogICAgICAgICAgICAgIHRoaXMubG93VGlwRG9tKCk7CiAgICAgICAgICAgICAgdGhpcy5sb3dUaXBTZXQoKTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgbG93VGlwRG9tOiBmdW5jdGlvbiBsb3dUaXBEb20oKSB7CiAgICAgICAgICAgICAgdmFyIGlzTmV3ID0gdGhhdC5pc05ldzsKICAgICAgICAgICAgICB2YXIgdmVyc2lvblRleHQgPSBpc05ldyA/ICflhbPms6gnIDogJ+aIkeeahOWFs+azqCc7CgogICAgICAgICAgICAgIGlmIChjb25maWcuZHVhbnd1KSB7CiAgICAgICAgICAgICAgICB0aGF0LnRvYXN0VHdvLnF1ZXJ5U2VsZWN0b3IoJy5zdWJzY3JpYmUtY2xpY2stY29udGV4dCcpLmlubmVySFRNTCA9IGNvbmZpZy50ZXh0OwogICAgICAgICAgICAgICAgdGhhdC50b2FzdFR3by5xdWVyeVNlbGVjdG9yKCcuc3Vic2NyaWJlLWNsaWNrLWJ1dHRvbicpLmlubmVyVGV4dCA9IGNvbmZpZy5idXR0b247CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIC8qIGVzbGludC1kaXNhYmxlIG1heC1sZW4gKi8KICAgICAgICAgICAgICAgIHRoYXQudG9hc3RUd28ucXVlcnlTZWxlY3RvcignLnN1YnNjcmliZS1jbGljay10ZXh0MicpLmlubmVyVGV4dCA9IGJveEFwcCA/IHZlcnNpb25UZXh0IDogJ+aIkeeahC3lhbPms6gnOwogICAgICAgICAgICAgICAgLyogZXNsaW50LWVuYWJsZSBtYXgtbGVuICovCiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBib2R5LmFwcGVuZENoaWxkKHRoYXQudG9hc3RUd28pOwogICAgICAgICAgICAgIHZhciBidXR0b24gPSB0aGF0LnRvYXN0VHdvLnF1ZXJ5U2VsZWN0b3IoJy5zdWJzY3JpYmUtY2xpY2stYnV0dG9uJyk7CgogICAgICAgICAgICAgIGlmICghaXNOZXcgJiYgYm94QXBwKSB7CiAgICAgICAgICAgICAgICB0aGF0LnRvYXN0VHdvLnN0eWxlLmJvdHRvbSA9ICcxMDBweCc7CiAgICAgICAgICAgICAgICBidXR0b24uc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICAgICAgICB9IGVsc2UgaWYgKGxpdGUpIHsKICAgICAgICAgICAgICAgIGJ1dHRvbi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgbG93VGlwU2V0OiBmdW5jdGlvbiBsb3dUaXBTZXQoKSB7CiAgICAgICAgICAgICAgdGhhdC50b2FzdFRyYW5zaXRpb24gPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICgwLCBfY2xhc3MuYWRkQ2xhc3MpKHRoYXQudG9hc3RUd28sICdzdWJzY3JpYmUtYWN0aXZlJyk7CiAgICAgICAgICAgICAgfSwgMTApOwogICAgICAgICAgICAgIHRoYXQudG9hc3RCb29sID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICB0aGF0LnRvYXN0VHdvLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhhdC50b2FzdFR3byk7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9LCAzMDAwKTsKICAgICAgICAgICAgfQogICAgICAgICAgfTsKICAgICAgICB9LAogICAgICAgIGxvb2tDbGljazogZnVuY3Rpb24gbG9va0NsaWNrKGNvbmZpZykgewogICAgICAgICAgLy8gdG9hc3QgY2xpY2vmlrnlvI8g54K55Ye75p+l55yL5aSE55CGCiAgICAgICAgICB2YXIgY2FsbGJhY2sgPSBjb25maWcuY2FsbGJhY2sgfHwgbnVsbDsKICAgICAgICAgIHZhciB1cmwgPSBjb25maWcudXJsIHx8IG51bGw7CiAgICAgICAgICB2YXIgbG9va0RvbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIiN0b2FzdC1jbGljay0iLmNvbmNhdCh0aGF0LmlkLCAiIC5zdWJzY3JpYmUtY2xpY2stYnV0dG9uIikpOwogICAgICAgICAgbG9va0RvbS5vbmNsaWNrID0gbnVsbDsKICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICBsb29rRG9tLm9uY2xpY2sgPSBmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgIHRoYXQudG9hc3RUd28ucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGF0LnRvYXN0VHdvKTsKCiAgICAgICAgICAgICAgaWYgKHR5cGVvZiBjYWxsYmFjayA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgICAgICAgICAgY2FsbGJhY2sgJiYgY2FsbGJhY2soKTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgdGhhdC50b0xhbmRpbmdQYWdlKHVybCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9OwogICAgICAgICAgfSwgMTApOwogICAgICAgIH0KICAgICAgfTsKICAgICAgY2xpY2tIYW5kbGUuaW5pdChjb25maWcpOwogICAgfQogICAgLyoqCiAgICAgKiDmoYblhoVjbWTmiZPlvIDvvIzmoYblpJZsb2NhdGlvbui3s+i9rAogICAgICog5pegdXJs5YiZ6Lez6L2s5oiR55qE5YWz5rOo77yMNy425Lul5LiL5Lul5Y+K5qGG5aSW5omn6KGMbG9jYXRpb27ot7PovawKICAgICAqIEBwYXJhbSB7c3RyaW5nfSB1cmwgIC0g6Lez6L2sdXJsCiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IGlzVG9hc3QgLSDmiZPngrlmcm9t5Y+C5pWwCiAgICAgKiBAZnVuY3Rpb24gdG9MYW5kaW5nUGFnZQogICAgICovCgogIH0sIHsKICAgIGtleTogInRvTGFuZGluZ1BhZ2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHRvTGFuZGluZ1BhZ2UodXJsLCBpc1RvYXN0KSB7CiAgICAgIHRoaXMucGJsb2dGdWMoJ3RvTGFuZGluZycsIHsKICAgICAgICBmcm9tOiBpc1RvYXN0ID8gJ2J1dHRvbicgOiAndG9hc3QnCiAgICAgIH0pOwogICAgICAoMCwgX2ludm9rZS5vcGVuUGFnZSkodXJsKTsKICAgIH0KICAgIC8qCiAgICAgKiDosIPlhbPms6jmjqXlj6PlpITnkIbmj5DkvpvlpJbpg6jlhaXlj6Plj4rov5Tlm57lm57osIMKICAgICAqIEBmdW5jdGlvbiBzdWJzY3JpYmUKICAgICAqIEBwYXJhbSB7T2JqZWN0fSBkYXRhICAtIOWIneWni+WMluaVsOaNrgogICAgICogQHBhcmFtIHtjYWxsYmFja30gY2FsbGJhY2sgLSDmiJDlip/lm57osIMKICAgICAqIEBwYXJhbSB7Y2FsbGJhY2t9IGZhaWxDYWxsYmFjayAtIOWksei0peWbnuiwgwogICAgICogQHBhcmFtIHtib29sZWFufSB1bmxvZ2luIC0g5o6l5Y+j5oiQ5Yqf5aSE55CG5Zue6LCDCiAgICAgKiDnlKjms5Xlrp7kvosKICAgICAqICBpbml0U3VibW9kdWxlLnN1YnNjcmliZSh7CiAgICAgKiAgICAgIHR5cGU6J21lZGlhJywKICAgICAqICAgICAgb3BfdHlwZTonYWRkJywKICAgICAqICAgICAgdGhpcmRfaWQ6JzE1MzY3NzM5MzQ1MjYxNzMnLAogICAgICogICAgICBzZnJvbTonc2JveCcsCiAgICAgKiAgICAgIHNvdXJjZTonbXlzdWJfaDUnCiAgICAgKiAgfSxmdW5jdGlvbigpewogICAgICogICAgICAgLy8g5YWz5rOo5oiQ5Yqf6Lez6L2s55u45YWz6aG16Z2iCiAgICAgKiAgICAgICBpbml0U3VibW9kdWxlLnRvYXN0KHsKICAgICAqICAgICAgICAgICB0eXBlOidjbGljaycsCiAgICAgKiAgICAgICAgICAgY2FsbGJhY2s6ICgpID0+IHsKICAgICAqICAgICAgICAgICAgICAgaW5pdFN1Ym1vZHVsZS50b0xhbmRpbmdQYWdlKCdodHRwczovL2JhaWR1LmNvbScpOwogICAgICogICAgICAgICAgIH0KICAgICAqICAgICAgIH0pOwogICAgICogICB9LCBmdW5jdGlvbigpIHt9LCBmYWxzZSk7CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAic3Vic2NyaWJlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzdWJzY3JpYmUoZGF0YSwgY2FsbGJhY2ssIGZhaWxDYWxsYmFjaywgdW5sb2dpbikgewogICAgICB2YXIgdGhhdCA9IHRoaXM7CiAgICAgIHZhciBzdWJzY3JpYmVIYW5kbGUgPSB7CiAgICAgICAgaW5pdDogZnVuY3Rpb24gaW5pdChkYXRhLCBjYWxsYmFjaywgZmFpbENhbGxiYWNrLCB1bmxvZ2luKSB7CiAgICAgICAgICB0aGlzLnBhcmFtVGlwKGRhdGEsIGNhbGxiYWNrKTsKICAgICAgICAgIHRoYXQucGJsb2dGdWMoJ3N1YnNjcmliZScsIHsKICAgICAgICAgICAgdHlwZTogZGF0YS5vcF90eXBlCiAgICAgICAgICB9KTsKICAgICAgICAgIHRoaXMuc3RhdHVzUmVxKGRhdGEsIGNhbGxiYWNrLCBmYWlsQ2FsbGJhY2ssIHVubG9naW4pOwogICAgICAgIH0sCiAgICAgICAgcGFyYW1UaXA6IGZ1bmN0aW9uIHBhcmFtVGlwKGRhdGEsIGNhbGxiYWNrKSB7CiAgICAgICAgICBpZiAoIWRhdGEgfHwgKDAsIF90eXBlb2YyLmRlZmF1bHQpKGRhdGEpICE9PSAnb2JqZWN0JykgewogICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ3BhcmFtcyBlcnJvcicpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgaWYgKCFkYXRhLnR5cGUgfHwgIWRhdGEub3BfdHlwZSB8fCAhZGF0YS50aGlyZF9pZCkgewogICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignbWlzc2luZyBwYXJhbXMnKTsKICAgICAgICAgICAgfSBlbHNlIGlmIChjYWxsYmFjayAmJiB0eXBlb2YgY2FsbGJhY2sgIT09ICdmdW5jdGlvbicpIHsKICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2NhbGxiYWNrIG11c3QgYmUgYSBmdW5jdGlvbicpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBzdGF0dXNSZXE6IGZ1bmN0aW9uIHN0YXR1c1JlcShkYXRhLCBjYWxsYmFjaywgZmFpbENhbGxiYWNrLCB1bmxvZ2luKSB7CiAgICAgICAgICB2YXIgc3RhdHVzQVBJID0gIiIuY29uY2F0KGV4dEhvc3QsICIvYXBpL3N1YnNjcmliZS92MS9yZWxhdGlvbi9zdGF0dXM/Y2FsbGJhY2s9PyIpOwogICAgICAgICAgKDAsIF9yZXF1ZXN0LnJlcXVlc3QpKHN0YXR1c0FQSSkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgICAgIHRoYXQuc3RhdHVzSGFuZGxlKCkuaW5pdChyZXMsIHVubG9naW4sIGRhdGEsIGNhbGxiYWNrLCBmYWlsQ2FsbGJhY2spOwogICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikgewogICAgICAgICAgICB0aGF0LmZhaWxjYihlcnIsIGZhaWxDYWxsYmFjayk7CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIHN1YnNjcmliZUhhbmRsZS5pbml0KGRhdGEsIGNhbGxiYWNrLCBmYWlsQ2FsbGJhY2ssIHVubG9naW4pOwogICAgfQogICAgLyoqCiAgICAgKiBzdGF0dXMg6L+U5Zue5oiQ5Yqf5aSE55CGCiAgICAgKiBAZnVuY3Rpb24gc3RhdHVzSGFuZGxlCiAgICAgKiBAcmV0dXJuIHtPYmplY3R9IC0g5aSE55CG6LCD5YWz5rOo5o6l5Y+j5a+56LGhCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAic3RhdHVzSGFuZGxlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzdGF0dXNIYW5kbGUoKSB7CiAgICAgIHZhciB0aGF0ID0gdGhpczsKICAgICAgcmV0dXJuIHsKICAgICAgICBpbml0OiBmdW5jdGlvbiBpbml0KHJlcywgdW5sb2dpbiwgZGF0YSwgY2FsbGJhY2ssIGZhaWxDYWxsYmFjaykgewogICAgICAgICAgdmFyIHJlY2VpdmVBUEkgPSB0aGlzLmdldFJlY2VpdmVVcmwocmVzLCB1bmxvZ2luLCBkYXRhLCBjYWxsYmFjaywgZmFpbENhbGxiYWNrKTsKICAgICAgICAgIHZhciBkaXNhYmxlTG9naW4gPSBkYXRhLmRpc2FibGVMb2dpbjsKICAgICAgICAgIHRoaXMuZ2V0U3RhdHVzKHJlcywgdW5sb2dpbiwgcmVjZWl2ZUFQSSwgY2FsbGJhY2ssIGZhaWxDYWxsYmFjaywgZGlzYWJsZUxvZ2luKTsKICAgICAgICB9LAogICAgICAgIGdldFJlY2VpdmVVcmw6IGZ1bmN0aW9uIGdldFJlY2VpdmVVcmwocmVzLCB1bmxvZ2luLCBkYXRhLCBjYWxsYmFjaywgZmFpbENhbGxiYWNrKSB7CiAgICAgICAgICAvLyDov5Tlm55yZWNlaXZlIHVybAoKICAgICAgICAgIC8qIGVzbGludC1kaXNhYmxlIGZlY3MtY2FtZWxjYXNlICovCiAgICAgICAgICB2YXIgdHlwZSA9IGRhdGEudHlwZSwKICAgICAgICAgICAgICBvcF90eXBlID0gZGF0YS5vcF90eXBlLAogICAgICAgICAgICAgIHRoaXJkX2lkID0gZGF0YS50aGlyZF9pZCwKICAgICAgICAgICAgICBzZnJvbSA9IGRhdGEuc2Zyb20sCiAgICAgICAgICAgICAgc291cmNlID0gZGF0YS5zb3VyY2UsCiAgICAgICAgICAgICAgc2lkID0gZGF0YS5zaWQsCiAgICAgICAgICAgICAgcG9zaXRpb24gPSBkYXRhLnBvc2l0aW9uLAogICAgICAgICAgICAgIGV4dCA9IGRhdGEuZXh0LAogICAgICAgICAgICAgIGRpc2FibGVMb2dpbiA9IGRhdGEuZGlzYWJsZUxvZ2luOwogICAgICAgICAgLyogZXNsaW50LWVuYWJsZSBmZWNzLWNhbWVsY2FzZSAqLwoKICAgICAgICAgIHJlY2VpdmVEYXRhID0gewogICAgICAgICAgICB0eXBlOiB0eXBlLAoKICAgICAgICAgICAgLyogZXNsaW50LWRpc2FibGUgZmVjcy1jYW1lbGNhc2UgKi8KICAgICAgICAgICAgdGhpcmRfaWQ6IHRoaXJkX2lkLAogICAgICAgICAgICBvcF90eXBlOiBvcF90eXBlID8gb3BfdHlwZSA6ICdhZGQnLAoKICAgICAgICAgICAgLyogZXNsaW50LWVuYWJsZSBmZWNzLWNhbWVsY2FzZSAqLwogICAgICAgICAgICBzZnJvbTogc2Zyb20gPyBzZnJvbSA6ICdzYm94JywKICAgICAgICAgICAgc291cmNlOiBzb3VyY2UgPyBzb3VyY2UgOiAnbXlzdWJfaDUnLAogICAgICAgICAgICAvLyBkaXNhYmxlTG9naW4g55qE5oOF5Ya15LiL6K+35rGC5o6l5Y+j6ZyA6KaB5bim5LiKIHVpZF9jdWlkIOWPguaVsAogICAgICAgICAgICBzdG9yZTogdGhhdC5pc05ldyB8fCBsaXRlIHx8IGRpc2FibGVMb2dpbiA/ICd1aWRfY3VpZCcgOiAndWlkJywKICAgICAgICAgICAgc2lkOiBzaWQgPyBzaWQgOiAnJywKICAgICAgICAgICAgcG9zaXRpb246IHBvc2l0aW9uIHx8ICcnCiAgICAgICAgICB9OwogICAgICAgICAgZXh0ICYmICgwLCBfaXMuaXNQbGFpbk9iamVjdCkoZXh0KSAmJiAocmVjZWl2ZURhdGEuZXh0ID0gZW5jb2RlVVJJQ29tcG9uZW50KEpTT04uc3RyaW5naWZ5KGV4dCkpKTsKICAgICAgICAgIHJldHVybiAiIi5jb25jYXQoZXh0SG9zdCwgIi9hcGkvc3Vic2NyaWJlL3YxL3JlbGF0aW9uL3JlY2VpdmU/Y2FsbGJhY2s9PyYiKS5jb25jYXQoKDAsIF9qc29uMnF1ZXJ5LmRlZmF1bHQpKHJlY2VpdmVEYXRhKSk7CiAgICAgICAgfSwKICAgICAgICBnZXRTdGF0dXM6IGZ1bmN0aW9uIGdldFN0YXR1cyhyZXMsIHVubG9naW4sIHJlY2VpdmVBUEksIGNhbGxiYWNrLCBmYWlsQ2FsbGJhY2ssIGRpc2FibGVMb2dpbikgewogICAgICAgICAgaWYgKHJlcy5lcnJubyA9PT0gMCkgewogICAgICAgICAgICAvLyDotbDlpITnkIbnmbvlvZXmgIHnmoTpgLvovpEKICAgICAgICAgICAgdmFyIGlzTG9naW4gPSByZXMuZGF0YS5pc0xvZ2luOwoKICAgICAgICAgICAgaWYgKCFpc0xvZ2luICYmICFib3hBcHApIHsKICAgICAgICAgICAgICAvLyB3aXNlIOeZu+W9leWkhOeQhgogICAgICAgICAgICAgIHRoaXMud2lzZUxvZ2luKHJlcywgdW5sb2dpbiwgZmFpbENhbGxiYWNrKTsKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0gLy8g5aaC5p6c5Lyg5YWlIGRpc2FibGVMb2dpbiDkuLogdHJ1ZSDnmoTor53vvIzliJnkuI3otbDnq6/lhoXnmbvlvZXnmoTpgLvovpEKCgogICAgICAgICAgICBpZiAoIWRpc2FibGVMb2dpbiAmJiAhaXNMb2dpbiAmJiBib3hBcHAgJiYgIXRoYXQuaXNOZXcpIHsKICAgICAgICAgICAgICAvLyDnq6/lhoUg55m75b2V5aSE55CGCiAgICAgICAgICAgICAgdGhpcy5ib3hMb2dpbihyZXMsIGZhaWxDYWxsYmFjayk7CiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICB0aGlzLnJlY2VpdmVSZXEocmVjZWl2ZUFQSSwgY2FsbGJhY2ssIGZhaWxDYWxsYmFjayk7IC8vIHJlY2VpdmUg5YWz5rOo5o6l5Y+j6K+35rGCCgogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CgogICAgICAgICAgZXJyTWVzc2FnZSA9IHRoaXMubWVzc2FnZSgxMDAyMCwgcmVzLmVycm1zZyk7IC8vIOeZu+W9leaOpeWPo+mUmeivrwoKICAgICAgICAgIHRoYXQuZmFpbGNiKGVyck1lc3NhZ2UsIGZhaWxDYWxsYmFjayk7CiAgICAgICAgfSwKICAgICAgICB3aXNlTG9naW46IGZ1bmN0aW9uIHdpc2VMb2dpbihyZXMsIHVubG9naW4sIGZhaWxDYWxsYmFjaykgewogICAgICAgICAgLy8g56uv5aSW55m75b2VCiAgICAgICAgICBpZiAodW5sb2dpbikgewogICAgICAgICAgICB1bmxvZ2luKCk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KCiAgICAgICAgICBlcnJNZXNzYWdlID0gdGhpcy5tZXNzYWdlKDEwMDAwLCByZXMuZXJybXNnKTsKICAgICAgICAgIHRoYXQuZmFpbGNiKGVyck1lc3NhZ2UsIGZhaWxDYWxsYmFjayk7CiAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9ICJodHRwOi8vd2FwcGFzcy5iYWlkdS5jb20vcGFzc3BvcnQvbG9naW4/dT0iLmNvbmNhdChlbmNvZGVVUklDb21wb25lbnQod2luZG93LmxvY2F0aW9uLmhyZWYpKTsKICAgICAgICB9LAogICAgICAgIGJveExvZ2luOiBmdW5jdGlvbiBib3hMb2dpbihyZXMsIGZhaWxDYWxsYmFjaykgewogICAgICAgICAgLy8g56uv5YaF55m75b2VCiAgICAgICAgICBlcnJNZXNzYWdlID0gdGhpcy5tZXNzYWdlKDEwMDEwLCByZXMuZXJybXNnKTsKICAgICAgICAgIHRoYXQuZmFpbGNiKGVyck1lc3NhZ2UsIGZhaWxDYWxsYmFjayk7CiAgICAgICAgICAoMCwgX3BibG9nLmRlZmF1bHQpKCdldmVudCcsIFsnc3ViQ29tcG9uZW50cycsICdpbnRlcmZhY2UnLCB7CiAgICAgICAgICAgIGlzYWxhZGluOiB0aGF0Lm9wcy5pc2FsYWRpbiA/ICcxJyA6ICcwJywKICAgICAgICAgICAgdWE6IHRoYXQudWEsCiAgICAgICAgICAgIHBvczogJ3RvTG9naW4nLAogICAgICAgICAgICBzb3VyY2U6IHRoYXQub3BzLnR5cGUgPyB0aGF0Lm9wcy50eXBlIDogJ290aGVycycKICAgICAgICAgIH0sIDE4LCBmdW5jdGlvbiAoKSB7fV0pOwogICAgICAgICAgKDAsIF9pbnZva2UubG9naW4pKCk7CiAgICAgICAgfSwKICAgICAgICByZWNlaXZlUmVxOiBmdW5jdGlvbiByZWNlaXZlUmVxKHJlY2VpdmVBUEksIGNhbGxiYWNrLCBmYWlsQ2FsbGJhY2spIHsKICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAgICAgLy8g5YWz5rOo5o6l5Y+j6LCD55SoCiAgICAgICAgICAoMCwgX3JlcXVlc3QucmVxdWVzdCkocmVjZWl2ZUFQSSkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgICAgIF90aGlzLnJlY2VpdmVOKHJlcywgY2FsbGJhY2ssIGZhaWxDYWxsYmFjayk7CiAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7CiAgICAgICAgICAgIHRoYXQuZmFpbGNiKGVyciwgZmFpbENhbGxiYWNrKTsKICAgICAgICAgIH0pOwogICAgICAgIH0sCiAgICAgICAgbWVzc2FnZTogZnVuY3Rpb24gbWVzc2FnZShlcnJubywgZXJybXNnKSB7CiAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICBlcnJubzogZXJybm8sCiAgICAgICAgICAgIGVycm1zZzogZXJybXNnIHx8ICcnCiAgICAgICAgICB9OwogICAgICAgIH0sCiAgICAgICAgcmVjZWl2ZU46IGZ1bmN0aW9uIHJlY2VpdmVOKGRhdGEsIGNhbGxiYWNrLCBmYWlsQ2FsbGJhY2spIHsKICAgICAgICAgIC8vIOiwg+WFs+azqOaOpeWPo+WkhOeQhuaPkOS+m+WklumDqOWFpeWPo+WPiui/lOWbnuWbnuiwgwogICAgICAgICAgdmFyIHN0b3JlID0gZnVuY3Rpb24gc3RvcmUoKSB7CiAgICAgICAgICAgICgwLCBfaW52b2tlLnNldFN0b3JhZ2UpKCdmb2xsb3dfc3RhdHVzXycgKyByZWNlaXZlRGF0YS50aGlyZF9pZCwgewogICAgICAgICAgICAgIGRhdGE6IFt7CiAgICAgICAgICAgICAgICAvKiBlc2xpbnQtZGlzYWJsZSBmZWNzLWNhbWVsY2FzZSAqLwogICAgICAgICAgICAgICAgaXNfZm9sbG93OiByZWNlaXZlRGF0YS5vcF90eXBlID09PSAnYWRkJyA/ICcxJyA6ICcwJwogICAgICAgICAgICAgICAgLyogZXNsaW50LWVuYWJsZSBmZWNzLWNhbWVsY2FzZSAqLwoKICAgICAgICAgICAgICB9XQogICAgICAgICAgICB9KTsKICAgICAgICAgIH07CgogICAgICAgICAgdmFyIHNlbmRCcm9hZCA9IGZ1bmN0aW9uIHNlbmRCcm9hZCgpIHsKICAgICAgICAgICAgKDAsIF9pbnZva2Uuc2VuZEJyb2FkY2FzdCkoewogICAgICAgICAgICAgIHR5cGU6IHJlY2VpdmVEYXRhLnR5cGUsCgogICAgICAgICAgICAgIC8qIGVzbGludC1kaXNhYmxlIGZlY3MtY2FtZWxjYXNlICovCiAgICAgICAgICAgICAgdGhpcmRfaWQ6IGVuY29kZVVSSUNvbXBvbmVudChyZWNlaXZlRGF0YS50aGlyZF9pZCksCiAgICAgICAgICAgICAgaXNfZm9sbG93OiByZWNlaXZlRGF0YS5vcF90eXBlID09PSAnYWRkJyA/ICcxJyA6ICcwJywKCiAgICAgICAgICAgICAgLyogZXNsaW50LWVuYWJsZSBmZWNzLWNhbWVsY2FzZSAqLwogICAgICAgICAgICAgIHBvc2l0aW9uOiByZWNlaXZlRGF0YS5wb3NpdGlvbgogICAgICAgICAgICB9KTsKICAgICAgICAgIH07CgogICAgICAgICAgaWYgKGRhdGEuZXJybm8gPT09IDApIHsKICAgICAgICAgICAgdGhhdC5wYmxvZ0Z1Yygnc3Vic2NyaWJlJywgewogICAgICAgICAgICAgIHN0YXR1czogJ3N1Y2Nlc3MnLAogICAgICAgICAgICAgIHR5cGU6IHJlY2VpdmVEYXRhLm9wX3R5cGUKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBpZiAoKDAsIF92ZXJzaW9uX2NvbXBhcmUuZGVmYXVsdCkodmVyc2lvbiwgJzEwLjAnKSA+PSAwKSB7CiAgICAgICAgICAgICAgc3RvcmUoKTsKICAgICAgICAgICAgICBzZW5kQnJvYWQoKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgY2FsbGJhY2sgJiYgY2FsbGJhY2soZGF0YSk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KCiAgICAgICAgICB0aGF0LmZhaWxjYihkYXRhLCBmYWlsQ2FsbGJhY2spOyAvLyDlhbPms6jmjqXlj6PplJnor6/lpITnkIYKICAgICAgICB9CiAgICAgIH07CiAgICB9CiAgICAvKgogICAgICog5aSx6LSldG9hc3Tmj5DnpLoKICAgICAqIEBmdW5jdGlvbiBmYWlsY2IKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJmYWlsY2IiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGZhaWxjYihlcnJEYXRhLCBmYWlsQ2FsbGJhY2spIHsKICAgICAgaWYgKCFlcnJEYXRhLmVycm5vKSB7CiAgICAgICAgLy8g5pyq5o2V6I6355qE6ZSZ6K+v57G75Z6L77yM5Y+v6IO95piv5pat572R77yM5o6l5Y+jNTAwCiAgICAgICAgZXJyRGF0YSA9IHsKICAgICAgICAgIGVycm5vOiA1MDAsCiAgICAgICAgICBlcnJtc2c6ICdyZXF1ZXN0IGZhaWxlZCx1bmNhdWdodCBlcnJvcicKICAgICAgICB9OwogICAgICB9CgogICAgICBpZiAoZmFpbENhbGxiYWNrKSB7CiAgICAgICAgLy8g5aaC5p6c5pyJIGZhaWxDYWxsYmFjayDlsLHnm7TmjqXotbDlroPnmoTpgLvovpEKICAgICAgICBmYWlsQ2FsbGJhY2soZXJyRGF0YSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaWYgKGVyckRhdGEuZXJybm8gPT09IDgwMDIwMCkgewogICAgICAgICAgLy8g5bGV56S65ZCO56uv6L+U5Zue5paH5qGICiAgICAgICAgICB0aGlzLnRvYXN0KHsKICAgICAgICAgICAgdHlwZTogJ3RpcHMnLAogICAgICAgICAgICB0ZXh0OiBlcnJEYXRhLmVycm1zZyB8fCAn5YWz5rOo5aSx6LSlJwogICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIGlmIChlcnJEYXRhLmVycm5vID09PSAxMDAxMCB8fCBlcnJEYXRhLmVycm5vID09PSAxMDAyMCkgey8vIGxpdGUg55m75b2VIHRvYXN0IOS4jeS9nOS7u+S9leWkhOeQhgogICAgICAgIH0gZWxzZSBpZiAoZXJyRGF0YS5lcnJubyAhPT0gMTAwMDApIHsKICAgICAgICAgIC8vIOahhuWkluacqueZu+W9leS4jeW8ueeqlyzlhbbku5bmg4XlhrXmmL7npLrpu5jorqTlvLnnqpcKICAgICAgICAgIHRoaXMudG9hc3QoewogICAgICAgICAgICB0eXBlOiAndGlwcycsCiAgICAgICAgICAgIHRleHQ6ICflhbPms6jlpLHotKUnCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGVyck1lc3NhZ2UgPSB7fTsgLy8g5omn6KGM5ZCO5riF56m6CiAgICB9CiAgICAvKgogICAgICog6LCD5YWz5rOo5o6l5Y+j5aSE55CG5o+Q5L6b5aSW6YOo5YWl5Y+j5Y+K6L+U5Zue5Zue6LCDCiAgICAgKiBAZnVuY3Rpb24gcmVjZWl2ZU4KICAgICAqIEBwYXJhbSBzZGF0YSAge09iamVjdH0gIC0g5oiQ5Yqf6L+U5Zue55qE5pWw5o2uCiAgICAgKiBAcGFyYW0gcmVjZWl2ZURhdGEge09iamVjdH0gLSDlkIzkuIoKICAgICAqIEBwYXJhbSBjYWxsYmFjayAge2NhbGxiYWNrfQogICAgICovCgogIH0sIHsKICAgIGtleTogInJlY2VpdmVOIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZWNlaXZlTihzZGF0YSwgcmVjZWl2ZURhdGEsIGNhbGxiYWNrKSB7CiAgICAgIC8vIE1BUks6IOebruWJjei/meS4quWHveaVsOacquiiq+S9v+eUqAogICAgICB2YXIgc3VjID0gc2RhdGEuZXJybm87CgogICAgICBpZiAoc3VjID09PSAwKSB7CiAgICAgICAgdGhpcy5wYmxvZ0Z1Yygnc3Vic2NyaWJlJywgewogICAgICAgICAgc3RhdHVzOiAnc3VjY2VzcycsCiAgICAgICAgICB0eXBlOiByZWNlaXZlRGF0YS5vcF90eXBlCiAgICAgICAgfSk7CgogICAgICAgIGlmICgoMCwgX3ZlcnNpb25fY29tcGFyZS5kZWZhdWx0KSh2ZXJzaW9uLCAnMTAuMCcpID49IDApIHsKICAgICAgICAgICgwLCBfaW52b2tlLnNldFN0b3JhZ2UpKCdmb2xsb3dfc3RhdHVzXycgKyByZWNlaXZlRGF0YS50aGlyZF9pZCwgewogICAgICAgICAgICBkYXRhOiBbewogICAgICAgICAgICAgIC8qIGVzbGludC1kaXNhYmxlIGZlY3MtY2FtZWxjYXNlICovCiAgICAgICAgICAgICAgaXNfZm9sbG93OiByZWNlaXZlRGF0YS5vcF90eXBlID09PSAnYWRkJyA/ICcxJyA6ICcwJwogICAgICAgICAgICAgIC8qIGVzbGludC1lbmFibGUgZmVjcy1jYW1lbGNhc2UgKi8KCiAgICAgICAgICAgIH1dCiAgICAgICAgICB9KTsKICAgICAgICAgICgwLCBfaW52b2tlLnNlbmRCcm9hZGNhc3QpKHsKICAgICAgICAgICAgdHlwZTogcmVjZWl2ZURhdGEudHlwZSwKCiAgICAgICAgICAgIC8qIGVzbGludC1kaXNhYmxlIGZlY3MtY2FtZWxjYXNlICovCiAgICAgICAgICAgIHRoaXJkX2lkOiBlbmNvZGVVUklDb21wb25lbnQocmVjZWl2ZURhdGEudGhpcmRfaWQpLAogICAgICAgICAgICBpc19mb2xsb3c6IHJlY2VpdmVEYXRhLm9wX3R5cGUgPT09ICdhZGQnID8gJzEnIDogJzAnLAoKICAgICAgICAgICAgLyogZXNsaW50LWVuYWJsZSBmZWNzLWNhbWVsY2FzZSAqLwogICAgICAgICAgICBwb3NpdGlvbjogcmVjZWl2ZURhdGEucG9zaXRpb24KICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgY2FsbGJhY2sgJiYgY2FsbGJhY2soc2RhdGEpOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIOWFs+azqOaOpeWPo+mUmeivrwogICAgICAgIHRoaXMuZmFpbGNiKHNkYXRhKTsKICAgICAgfQogICAgfQogICAgLyoKICAgICAqIOeZu+W9leWkhOeQhgogICAgICogQGZ1bmN0aW9uIHRvTG9naW4KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJ0b0xvZ2luIiwKICAgIHZhbHVlOiBmdW5jdGlvbiB0b0xvZ2luKCkgewogICAgICAoMCwgX3BibG9nLmRlZmF1bHQpKCdldmVudCcsIFsnc3ViQ29tcG9uZW50cycsICdpbnRlcmZhY2UnLCB7CiAgICAgICAgaXNhbGFkaW46IHRoaXMub3BzLmlzYWxhZGluID8gJzEnIDogJzAnLAogICAgICAgIHVhOiB0aGlzLnVhLAogICAgICAgIHBvczogJ3RvTG9naW4nLAogICAgICAgIHNvdXJjZTogdGhpcy5vcHMudHlwZSA/IHRoaXMub3BzLnR5cGUgOiAnb3RoZXJzJwogICAgICB9LCAxOCwgZnVuY3Rpb24gKCkge31dKTsKICAgICAgKDAsIF9pbnZva2UubG9naW4pKCk7CiAgICB9CiAgICAvKgogICAgICog5YWz5rOo5bCB6KOFIOWPguaVsOWQjHN1YnNjcmliZQogICAgICogQGZ1bmN0aW9uIHNob3dEaWFsb2cKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJzaG93RGlhbG9nIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzaG93RGlhbG9nKHRleHQsIGRhdGEsIGNhbGxiYWNrLCBmYWlsQ2FsbGJhY2spIHsKICAgICAgcmV0dXJuIHRoaXMuc3Vic2NyaWJlKGRhdGEsIGNhbGxiYWNrLCBmYWlsQ2FsbGJhY2spOwogICAgfQogIH1dKTsKICByZXR1cm4gU3ViTW9kdWxlOwp9KCk7CgpleHBvcnRzLlN1Yk1vZHVsZSA9IFN1Yk1vZHVsZTsKCnZhciBfZGVmYXVsdCA9IGZ1bmN0aW9uIF9kZWZhdWx0KG9wdGlvbnMpIHsKICByZXR1cm4gbmV3IFN1Yk1vZHVsZShvcHRpb25zKTsKfTsKCmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0Ow=="},{"version":3,"sources":["/Users/liaohuanyu/projects/baidu-work/baidu/feed3/multi-pages/node_modules/@baidu/xbox-concern/index.js"],"names":["lite","mission","info","version","body","document","errMessage","host","extHost","isMatrix","boxApp","receiveData","SubModule","options","id","toastBool","toastTransition","ops","needUI","createDom","ua","isNew","isNew90","sfrom","cateid","noPv","location","port","onLine","that","toastDom","oneDom","tTips","createEle","className","contDiv","innerText","appendChild","twoDom","tClick","sucDiv","innerHTML","createElement","toastOne","toastTwo","data","callback","failCallback","relateHandle","paramsTip","Error","type","third_id","relateReq","disableLogin","relatedata","join","store","sortAPI","then","res","catch","err","config","toastHandle","init","paramTip","clear","active","toastType","e","console","warn","clearTimeout","toastQuery","querySelectorAll","length","i","parentNode","removeChild","pblogFuc","tipsFuc","clickFuc","ctext","text","querySelector","setTimeout","pos","opt","isaladin","source","clickHandle","duanwu","tip","lowTip","lookClick","toast","lowTipDom","lowTipSet","versionText","button","style","bottom","display","url","lookDom","onclick","toLandingPage","isToast","from","unlogin","subscribeHandle","op_type","statusReq","statusAPI","statusHandle","failcb","receiveAPI","getReceiveUrl","getStatus","sid","position","ext","encodeURIComponent","JSON","stringify","errno","isLogin","wiseLogin","boxLogin","receiveReq","message","errmsg","window","href","receiveN","is_follow","sendBroad","status","errData","sdata","suc","subscribe"],"mappings":"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","sourcesContent":["/**\n * \n * @link http://icode.baidu.com/repos/baidu/searchbox-fe/common/blob/master:static/bdbox/subscribe/isub.js\n * @file \n * @author jiangxiaoli01\n */\nimport json2query from '@baidu/xbox/json2query';\nimport {isPlainObject, isEmptyObject, isArray} from '@baidu/xbox/is';\nimport getBoxVersion from '@baidu/xbox/get-box-version';\nimport versionCompare from '@baidu/xbox/version_compare';\nimport {isBox, isMatrix as matrix, getUa} from '@baidu/xbox/browser/detect';\nimport pblog from '@baidu/xbox/monitor/pblog';\nimport {addClass, removeClass} from '@baidu/xbox/browser/class';\nimport {sendBroadcast, login, openPage, clientToast, setStorage} from './concern/invoke';\nimport {request} from './concern/request';\n\nimport './style/concern.less';\n\nconst lite = isBox('lite');\nconst mission = isBox('mission');\nconst info = isBox('info');\n\nconst version = getBoxVersion();\nconst body = document.body;\nlet errMessage = {};\nlet host;\nlet extHost;\nconst isMatrix = matrix(); // \nconst boxApp = isBox() || isMatrix; // \nlet receiveData = {};\n\n/**\n * \n * @class SubModule\n */\nexport class SubModule {\n    constructor(options) {\n        this.id = options.id;\n        this.toastBool = null;\n        this.toastTransition = null;\n        this.ops = options.ops || {};\n        this.needUI = (this.ops && this.ops.needUI) || true;\n        if (this.needUI) {\n            this.createDom();\n        }\n        this.ua = getUa();\n        this.isNew = boxApp && versionCompare(version, '7.7.0') >= 0;\n        this.isNew90 = boxApp && versionCompare(version, '9.0.0') >= 0;\n        this.ops.sfrom = this.ua;\n        options.cateid && pblog('init', [options.cateid]);\n        !this.ops.noPv && pblog('pv', ['__subscribeComponentsPv__', this.ops, () => {}]);\n        if (location.port && !this.ops.onLine) {\n            host = '';\n            extHost = '';\n        } else {\n            host = 'https://mbd.baidu.com';\n            extHost = 'https://ext.baidu.com';\n        }\n    }\n\n    /**\n     * dom\n     * @function createDom\n     */\n    createDom() {\n        let that = this;\n        let toastDom = {\n            oneDom() {\n                let tTips = this.createEle(); // toast dom\n                tTips.className = 'subscribe-toast subscribe-toast-tips';\n                tTips.id = `toast-text-${that.id}`;\n                let contDiv = this.createEle();\n                contDiv.className = 'subscribe-tips-context';\n                contDiv.innerText = '';\n                tTips.appendChild(contDiv);\n                return tTips;\n            },\n            twoDom() {\n                let tClick = this.createEle();\n                tClick.className = 'subscribe-toast subscribe-toast-click';\n                tClick.id = `toast-click-${that.id}`;\n                let sucDiv = this.createEle();\n                sucDiv.className = 'subscribe-click-container';\n                /* eslint-disable max-len */\n                sucDiv.innerHTML = '<div class=\"subscribe-click-context\"><span class=\"subscribe-click-text2\">-</span></div><div class=\"subscribe-click-button\" ontouchstart=\"\"></div>';\n                /* eslint-enable max-len */\n                tClick.appendChild(sucDiv);\n                return tClick;\n            },\n            createEle() {\n                return document.createElement('div');\n            }\n        };\n        this.toastOne = toastDom.oneDom();\n        this.toastTwo = toastDom.twoDom();\n    }\n\n    /**\n     * \n     *  http://wiki.baidu.com/pages/viewpage.action?pageId=237806199\n     * @function relateAPI\n     */\n    relateAPI(data, callback, failCallback) {\n        let relateHandle = {\n            paramsTip(data, callback) { // \n                if (!data || typeof data !== 'object') {\n                    throw new Error('params error');\n                } else {\n                    /* eslint-disable fecs-camelcase */\n                    if (!data.type || !data.sfrom || !data.third_id) {\n                        /* eslint-enable fecs-camelcase */\n                        throw new Error('missing params');\n                    } else if (callback && typeof callback !== 'function') {\n                        throw new Error('callback must be a function');\n                    }\n                }\n            },\n            relateReq(data, callback, failCallback) { // \n                /* eslint-disable fecs-camelcase */\n                let {third_id, type, sfrom, disableLogin} = data;\n                /* eslint-enable fecs-camelcase */\n                let relatedata = json2query({\n                    type,\n                    sfrom,\n                    /* eslint-disable fecs-camelcase */\n                    third_id: isArray(third_id) ? third_id.join(',') : third_id,\n                    /* eslint-enable fecs-camelcase */\n                    // disableLogin  uid_cuid \n                    store: (this.isNew || disableLogin) ? 'uid_cuid' : 'uid'\n                });\n                let sortAPI = `${extHost}/api/subscribe/v1/relation/get?callback=?&${relatedata}`;\n                request(sortAPI).then(res => {\n                    callback && callback(res);\n                }).catch(err => {\n                    failCallback && failCallback(err);\n                });\n            }\n        };\n        relateHandle.paramsTip(data, callback);\n        relateHandle.relateReq(data, callback, failCallback);\n    }\n\n    /**\n     * toast \n     * @function toast\n     * @param config            {object}    \n     * @param config.type       {string}    toast clicktips\n     * @param config.text       {string}    \n     * @param config.url        {string}    toast type=clickurl \n     * @param config.callback   {function}  callback\n     *\n     * @update 11.1:toast-tips,\n     */\n    toast(config) {\n        let that = this;\n        let toastHandle = {\n            init(config) {\n                this.paramTip(config);\n                try {\n                    this.clear();\n                    this.active();\n                    this.toastType(config);\n                    return true;\n                } catch (e) {\n                    console.warn(e);\n                    return e || false;\n                }\n            },\n            paramTip(config) { // \n                if (!isPlainObject(config) || isEmptyObject(config)) {\n                    throw new Error('params error,config is not a json');\n                }\n                let type = config.type || null;\n                if (!type || typeof type !== 'string') {\n                    throw new Error('params error');\n                }\n            },\n            clear() {\n                that.toastBool && clearTimeout(that.toastBool);\n                that.toastTransition && clearTimeout(that.toastTransition);\n            },\n            active() {\n                let toastQuery = body.querySelectorAll('.subscribe-toast');\n                let length = toastQuery.length;\n                if (length) {\n                    for (let i = 0; i < length; i++) {\n                        toastQuery[i].parentNode.removeChild(toastQuery[i]);\n                        removeClass(toastQuery[i], 'subscribe-active');\n                    }\n                }\n            },\n            toastType(config) { // toast\n                let {type} = config;\n                switch (type) {\n                    case 'tips': {\n                        that.pblogFuc('tips', {});\n                        this.tipsFuc(config);\n                        break;\n                    }\n                    case 'click': {\n                        that.pblogFuc('click', {});\n                        that.clickFuc(config);\n                        break;\n                    }\n                }\n            },\n            tipsFuc(config) { // tips\n                const ctext = config.text || null;\n                if (boxApp) {\n                    return clientToast(ctext);\n                }\n                body.appendChild(that.toastOne);\n                const toastOne = document.querySelector(`#toast-text-${that.id}`);\n                that.toastTransition = setTimeout(() => {\n                    if (ctext) {\n                        toastOne.querySelector('.subscribe-tips-context').innerText = ctext;\n                    }\n                    toastOne.className = 'subscribe-toast subscribe-toast-tips subscribe-active';\n                }, 10);\n                that.toastBool = setTimeout(() => {\n                    try {\n                        that.toastOne.parentNode.removeChild(that.toastOne);\n                    } catch (e) {\n                        return false;\n                    }\n                }, 3000);\n            }\n        };\n        return toastHandle.init(config);\n    }\n\n    /**\n     * \n     * @function pblogFuc\n     * @param pos  {string} - \n     * @param opt  {object} - {} || \n     */\n    pblogFuc(pos, opt) {\n        let {type, isaladin} = this.ops;\n        pblog('event', ['subComponents', 'interface', {\n            ...opt,\n            isaladin: isaladin ? '1' : '0',\n            ua: this.ua,\n            pos,\n            source: type ? type : 'others'\n        }, 18, () => {}]);\n    }\n\n    /**\n     * click toast\n     * @param {Object} config \n     * @param {string} config.type toast clicktips\n     * @param {string} config.text \n     * @param {string} config.url toast type=clickurl \n     * @function clickFuc\n     */\n    clickFuc(config) {\n        let that = this;\n        let clickHandle = {\n            init(config) {\n                if ((lite || info || mission) && !config.duanwu) { // click lite\n                    return this.tip('-');\n                }\n                if (that.isNew90 && !config.duanwu) { // click 9.0\n                    let text = config.text;\n                    return this.tip(`${text ? text : ''}`);\n                }\n                this.lowTip(config).init();\n                this.lookClick(config);\n            },\n            tip(text) {\n                that.toast({\n                    type: 'tips',\n                    text\n                });\n            },\n            lowTip(config) { // toast\n                return {\n                    init() {\n                        this.lowTipDom();\n                        this.lowTipSet();\n                    },\n                    lowTipDom() {\n                        let isNew = that.isNew;\n                        let versionText = isNew ? '' : '';\n                        if (config.duanwu) {\n                            that.toastTwo.querySelector('.subscribe-click-context').innerHTML = config.text;\n                            that.toastTwo.querySelector('.subscribe-click-button').innerText = config.button;\n                        } else {\n                            /* eslint-disable max-len */\n                            that.toastTwo.querySelector('.subscribe-click-text2').innerText = boxApp ? versionText : '-';\n                            /* eslint-enable max-len */\n                        }\n                        body.appendChild(that.toastTwo);\n                        let button = that.toastTwo.querySelector('.subscribe-click-button');\n                        if (!isNew && boxApp) {\n                            that.toastTwo.style.bottom = '100px';\n                            button.style.display = 'none';\n                        } else if (lite) {\n                            button.style.display = 'none';\n                        }\n                    },\n                    lowTipSet() {\n                        that.toastTransition = setTimeout(() => {\n                            addClass(that.toastTwo, 'subscribe-active');\n                        }, 10);\n                        that.toastBool = setTimeout(() => {\n                            try {\n                                that.toastTwo.parentNode.removeChild(that.toastTwo);\n                            } catch (e) {\n                                return false;\n                            }\n                        }, 3000);\n                    }\n                };\n            },\n            lookClick(config) { // toast click \n                const callback = config.callback || null;\n                const url = config.url || null;\n                let lookDom = document.querySelector(`#toast-click-${that.id} .subscribe-click-button`);\n                lookDom.onclick = null;\n                setTimeout(() => {\n                    lookDom.onclick = e => {\n                        that.toastTwo.parentNode.removeChild(that.toastTwo);\n                        if (typeof callback === 'function') {\n                            callback && callback();\n                        } else {\n                            that.toLandingPage(url);\n                        }\n                    };\n                }, 10);\n            }\n        };\n        clickHandle.init(config);\n    }\n\n    /**\n     * cmdlocation\n     * url7.6location\n     * @param {string} url  - url\n     * @param {boolean} isToast - from\n     * @function toLandingPage\n     */\n    toLandingPage(url, isToast) {\n        this.pblogFuc('toLanding', {\n            from: isToast ? 'button' : 'toast'\n        });\n        openPage(url);\n    }\n\n    /*\n     * \n     * @function subscribe\n     * @param {Object} data  - \n     * @param {callback} callback - \n     * @param {callback} failCallback - \n     * @param {boolean} unlogin - \n     * \n     *  initSubmodule.subscribe({\n     *      type:'media',\n     *      op_type:'add',\n     *      third_id:'1536773934526173',\n     *      sfrom:'sbox',\n     *      source:'mysub_h5'\n     *  },function(){\n     *       // \n     *       initSubmodule.toast({\n     *           type:'click',\n     *           callback: () => {\n     *               initSubmodule.toLandingPage('https://baidu.com');\n     *           }\n     *       });\n     *   }, function() {}, false);\n     */\n    subscribe(data, callback, failCallback, unlogin) {\n        let that = this;\n        let subscribeHandle = {\n            init(data, callback, failCallback, unlogin) {\n                this.paramTip(data, callback);\n                that.pblogFuc('subscribe', {\n                    type: data.op_type\n                });\n                this.statusReq(data, callback, failCallback, unlogin);\n            },\n            paramTip(data, callback) {\n                if (!data || typeof data !== 'object') {\n                    throw new Error('params error');\n                } else {\n                    if (!data.type || !data.op_type || !data.third_id) {\n                        throw new Error('missing params');\n                    } else if (callback && typeof callback !== 'function') {\n                        throw new Error('callback must be a function');\n                    }\n                }\n            },\n            statusReq(data, callback, failCallback, unlogin) {\n                let statusAPI = `${extHost}/api/subscribe/v1/relation/status?callback=?`;\n                request(statusAPI).then(res => {\n                    that.statusHandle().init(res, unlogin, data, callback, failCallback);\n                }).catch(err => {\n                    that.failcb(err, failCallback);\n                });\n            }\n        };\n        subscribeHandle.init(data, callback, failCallback, unlogin);\n    }\n\n    /**\n     * status \n     * @function statusHandle\n     * @return {Object} - \n     */\n    statusHandle() {\n        let that = this;\n        return {\n            init(res, unlogin, data, callback, failCallback) {\n                const receiveAPI = this.getReceiveUrl(res, unlogin, data, callback, failCallback);\n                const {disableLogin} = data;\n                this.getStatus(res, unlogin, receiveAPI, callback, failCallback, disableLogin);\n            },\n            getReceiveUrl(res, unlogin, data, callback, failCallback) { // receive url\n                /* eslint-disable fecs-camelcase */\n                let {type, op_type, third_id, sfrom, source, sid, position, ext, disableLogin} = data;\n                /* eslint-enable fecs-camelcase */\n                receiveData = {\n                    type,\n                    /* eslint-disable fecs-camelcase */\n                    third_id,\n                    op_type: op_type ? op_type : 'add',\n                    /* eslint-enable fecs-camelcase */\n                    sfrom: sfrom ? sfrom : 'sbox',\n                    source: source ? source : 'mysub_h5',\n                    // disableLogin  uid_cuid \n                    store: (that.isNew || lite || disableLogin) ? 'uid_cuid' : 'uid',\n                    sid: sid ? sid : '',\n                    position: position || ''\n                };\n                ext && isPlainObject(ext) && (receiveData.ext = encodeURIComponent(JSON.stringify(ext)));\n                return `${extHost}/api/subscribe/v1/relation/receive?callback=?&${json2query(receiveData)}`;\n            },\n            getStatus(res, unlogin, receiveAPI, callback, failCallback, disableLogin) {\n                if (res.errno === 0) {\n                    // \n                    let isLogin = res.data.isLogin;\n                    if (!isLogin && !boxApp) { // wise \n                        this.wiseLogin(res, unlogin, failCallback);\n                        return;\n                    }\n                    //  disableLogin  true \n                    if (!disableLogin && !isLogin && boxApp && !that.isNew) { //  \n                        this.boxLogin(res, failCallback);\n                        return;\n                    }\n                    this.receiveReq(receiveAPI, callback, failCallback); // receive \n                    return;\n                }\n                errMessage = this.message(10020, res.errmsg); // \n                that.failcb(errMessage, failCallback);\n            },\n            wiseLogin(res, unlogin, failCallback) { // \n                if (unlogin) {\n                    unlogin();\n                    return;\n                }\n                errMessage = this.message(10000, res.errmsg);\n                that.failcb(errMessage, failCallback);\n                window.location.href = `http://wappass.baidu.com/passport/login?u=${encodeURIComponent(window.location.href)}`;\n            },\n            boxLogin(res, failCallback) { // \n                errMessage = this.message(10010, res.errmsg);\n                that.failcb(errMessage, failCallback);\n                pblog('event', ['subComponents', 'interface', {\n                    isaladin: that.ops.isaladin ? '1' : '0',\n                    ua: that.ua,\n                    pos: 'toLogin',\n                    source: that.ops.type ? that.ops.type : 'others'\n                }, 18, () => {}]);\n                login();\n            },\n            receiveReq(receiveAPI, callback, failCallback) { // \n                request(receiveAPI).then(res => {\n                    this.receiveN(res, callback, failCallback);\n                }).catch(err => {\n                    that.failcb(err, failCallback);\n                });\n            },\n            message(errno, errmsg) {\n                return {\n                    errno,\n                    errmsg: errmsg || ''\n                };\n            },\n            receiveN(data, callback, failCallback) { // \n                let store = () => {\n                    setStorage('follow_status_' + receiveData.third_id, {\n                        data: [{\n                            /* eslint-disable fecs-camelcase */\n                            is_follow: receiveData.op_type === 'add' ? '1' : '0'\n                            /* eslint-enable fecs-camelcase */\n                        }]\n                    });\n                };\n                let sendBroad = () => {\n                    sendBroadcast({\n                        type: receiveData.type,\n                        /* eslint-disable fecs-camelcase */\n                        third_id: encodeURIComponent(receiveData.third_id),\n                        is_follow: receiveData.op_type === 'add' ? '1' : '0',\n                        /* eslint-enable fecs-camelcase */\n                        position: receiveData.position\n                    });\n                };\n                if (data.errno === 0) {\n                    that.pblogFuc('subscribe', {\n                        status: 'success',\n                        type: receiveData.op_type\n                    });\n                    if (versionCompare(version, '10.0') >= 0) {\n                        store();\n                        sendBroad();\n                    }\n                    callback && callback(data);\n                    return;\n                }\n                that.failcb(data, failCallback); // \n            }\n        };\n    }\n\n    /*\n     * toast\n     * @function failcb\n     */\n    failcb(errData, failCallback) {\n        if (!errData.errno) {\n            // 500\n            errData = {\n                errno: 500,\n                errmsg: 'request failed,uncaught error'\n            };\n        }\n        if (failCallback) {\n            //  failCallback \n            failCallback(errData);\n        } else {\n            if (errData.errno === 800200) {\n                // \n                this.toast({\n                    type: 'tips',\n                    text: errData.errmsg || ''\n                });\n            } else if (errData.errno === 10010 || errData.errno === 10020) {\n                // lite  toast \n            } else if (errData.errno !== 10000) {\n                // ,\n                this.toast({\n                    type: 'tips',\n                    text: ''\n                });\n            }\n        }\n        errMessage = {}; // \n    }\n    /*\n     * \n     * @function receiveN\n     * @param sdata  {Object}  - \n     * @param receiveData {Object} - \n     * @param callback  {callback}\n     */\n    receiveN(sdata, receiveData, callback) {\n        // MARK: \n        let suc = sdata.errno;\n        if (suc === 0) {\n            this.pblogFuc('subscribe', {\n                status: 'success',\n                type: receiveData.op_type\n            });\n            if (versionCompare(version, '10.0') >= 0) {\n                setStorage('follow_status_' + receiveData.third_id, {\n                    data: [{\n                        /* eslint-disable fecs-camelcase */\n                        is_follow: receiveData.op_type === 'add' ? '1' : '0'\n                        /* eslint-enable fecs-camelcase */\n                    }]\n                });\n                sendBroadcast({\n                    type: receiveData.type,\n                    /* eslint-disable fecs-camelcase */\n                    third_id: encodeURIComponent(receiveData.third_id),\n                    is_follow: receiveData.op_type === 'add' ? '1' : '0',\n                    /* eslint-enable fecs-camelcase */\n                    position: receiveData.position\n                });\n            }\n            callback && callback(sdata);\n        } else {\n            // \n            this.failcb(sdata);\n        }\n    }\n    /*\n     * \n     * @function toLogin\n     */\n    toLogin() {\n        pblog('event', ['subComponents', 'interface', {\n            isaladin: this.ops.isaladin ? '1' : '0',\n            ua: this.ua,\n            pos: 'toLogin',\n            source: this.ops.type ? this.ops.type : 'others'\n        }, 18, () => {}]);\n        login();\n    }\n    /*\n     *  subscribe\n     * @function showDialog\n     */\n    showDialog(text, data, callback, failCallback) {\n        return this.subscribe(data, callback, failCallback);\n    }\n}\n\nexport default options => new SubModule(options);\n"]}]}
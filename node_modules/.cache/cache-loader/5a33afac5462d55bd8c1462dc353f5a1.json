{"remainingRequest":"/Users/a2012/Desktop/list/node_modules/babel-loader/lib/index.js??ref--1-2!/Users/a2012/Desktop/list/node_modules/@baidu/feed-baselog/node_modules/@baidu/ubc-report-sdk/dist/ubc-report-sdk.esm.js","dependencies":[{"path":"/Users/a2012/Desktop/list/node_modules/@baidu/feed-baselog/node_modules/@baidu/ubc-report-sdk/dist/ubc-report-sdk.esm.js","mtime":1696919504000},{"path":"/Users/a2012/Desktop/list/node_modules/san-hot-loader/index.js","mtime":1696919525000},{"path":"/Users/a2012/Desktop/list/node_modules/cache-loader/dist/cjs.js","mtime":1696919513000},{"path":"/Users/a2012/Desktop/list/node_modules/babel-loader/lib/index.js","mtime":1696919524000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKdmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKCIvVXNlcnMvYTIwMTIvRGVza3RvcC9saXN0L25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2ludGVyb3BSZXF1aXJlRGVmYXVsdCIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnN5bWJvbCIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnN5bWJvbC5kZXNjcmlwdGlvbiIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnN5bWJvbC5pdGVyYXRvciIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnN5bWJvbC50by1wcmltaXRpdmUiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5jb25jYXQiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maWx0ZXIiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maW5kIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZm9yLWVhY2giKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5mcm9tIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5jbHVkZXMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5pbmRleC1vZiIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5Lml0ZXJhdG9yIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucmVkdWNlIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc2xpY2UiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5kYXRlLnRvLXByaW1pdGl2ZSIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLm1hcCIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLm51bWJlci5jb25zdHJ1Y3RvciIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5hc3NpZ24iKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QuZ2V0LW93bi1wcm9wZXJ0eS1kZXNjcmlwdG9yIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmdldC1vd24tcHJvcGVydHktZGVzY3JpcHRvcnMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3Qua2V5cyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmciKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5wcm9taXNlIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLmNvbnN0cnVjdG9yIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLmV4ZWMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAudG8tc3RyaW5nIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLml0ZXJhdG9yIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnJlcGxhY2UiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuc2VhcmNoIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaCIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuaXRlcmF0b3IiKTsKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKZXhwb3J0cy51YmNMb2dnZXIgPSBleHBvcnRzLlViY0xvZ2dlciA9IHZvaWQgMDsKCnZhciBfdHlwZW9mMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgiL1VzZXJzL2EyMDEyL0Rlc2t0b3AvbGlzdC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy90eXBlb2YiKSk7Cgp2YXIgX2VvcFV0aWxzID0gcmVxdWlyZSgiQGJhaWR1L2VvcC11dGlscyIpOwoKZnVuY3Rpb24gb3duS2V5cyhvYmplY3QsIGVudW1lcmFibGVPbmx5KSB7CiAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhvYmplY3QpOwoKICBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scykgewogICAgdmFyIHN5bWJvbHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKG9iamVjdCk7CiAgICBlbnVtZXJhYmxlT25seSAmJiAoc3ltYm9scyA9IHN5bWJvbHMuZmlsdGVyKGZ1bmN0aW9uIChzeW0pIHsKICAgICAgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBzeW0pLmVudW1lcmFibGU7CiAgICB9KSksIGtleXMucHVzaC5hcHBseShrZXlzLCBzeW1ib2xzKTsKICB9CgogIHJldHVybiBrZXlzOwp9CgpmdW5jdGlvbiBfb2JqZWN0U3ByZWFkMih0YXJnZXQpIHsKICBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgewogICAgdmFyIHNvdXJjZSA9IG51bGwgIT0gYXJndW1lbnRzW2ldID8gYXJndW1lbnRzW2ldIDoge307CiAgICBpICUgMiA/IG93bktleXMoT2JqZWN0KHNvdXJjZSksICEwKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgX2RlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBzb3VyY2Vba2V5XSk7CiAgICB9KSA6IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzID8gT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKSA6IG93bktleXMoT2JqZWN0KHNvdXJjZSkpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc291cmNlLCBrZXkpKTsKICAgIH0pOwogIH0KCiAgcmV0dXJuIHRhcmdldDsKfQoKZnVuY3Rpb24gX3R5cGVvZihvYmopIHsKICAiQGJhYmVsL2hlbHBlcnMgLSB0eXBlb2YiOwoKICByZXR1cm4gX3R5cGVvZiA9ICJmdW5jdGlvbiIgPT0gdHlwZW9mIFN5bWJvbCAmJiAic3ltYm9sIiA9PSB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID8gZnVuY3Rpb24gKG9iaikgewogICAgcmV0dXJuIHR5cGVvZiBvYmo7CiAgfSA6IGZ1bmN0aW9uIChvYmopIHsKICAgIHJldHVybiBvYmogJiYgImZ1bmN0aW9uIiA9PSB0eXBlb2YgU3ltYm9sICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogdHlwZW9mIG9iajsKICB9LCBfdHlwZW9mKG9iaik7Cn0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsKICBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7CiAgfQp9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7CiAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgewogICAgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsKICAgIGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsKICAgIGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsKICAgIGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOwogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgX3RvUHJvcGVydHlLZXkoZGVzY3JpcHRvci5rZXkpLCBkZXNjcmlwdG9yKTsKICB9Cn0KCmZ1bmN0aW9uIF9jcmVhdGVDbGFzcyhDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsKICBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsKICBpZiAoc3RhdGljUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7CiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KENvbnN0cnVjdG9yLCAicHJvdG90eXBlIiwgewogICAgd3JpdGFibGU6IGZhbHNlCiAgfSk7CiAgcmV0dXJuIENvbnN0cnVjdG9yOwp9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7CiAga2V5ID0gX3RvUHJvcGVydHlLZXkoa2V5KTsKCiAgaWYgKGtleSBpbiBvYmopIHsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgewogICAgICB2YWx1ZTogdmFsdWUsCiAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgd3JpdGFibGU6IHRydWUKICAgIH0pOwogIH0gZWxzZSB7CiAgICBvYmpba2V5XSA9IHZhbHVlOwogIH0KCiAgcmV0dXJuIG9iajsKfQoKZnVuY3Rpb24gX3RvUHJpbWl0aXZlKGlucHV0LCBoaW50KSB7CiAgaWYgKCgwLCBfdHlwZW9mMy5kZWZhdWx0KShpbnB1dCkgIT09ICJvYmplY3QiIHx8IGlucHV0ID09PSBudWxsKSByZXR1cm4gaW5wdXQ7CiAgdmFyIHByaW0gPSBpbnB1dFtTeW1ib2wudG9QcmltaXRpdmVdOwoKICBpZiAocHJpbSAhPT0gdW5kZWZpbmVkKSB7CiAgICB2YXIgcmVzID0gcHJpbS5jYWxsKGlucHV0LCBoaW50IHx8ICJkZWZhdWx0Iik7CiAgICBpZiAoKDAsIF90eXBlb2YzLmRlZmF1bHQpKHJlcykgIT09ICJvYmplY3QiKSByZXR1cm4gcmVzOwogICAgdGhyb3cgbmV3IFR5cGVFcnJvcigiQEB0b1ByaW1pdGl2ZSBtdXN0IHJldHVybiBhIHByaW1pdGl2ZSB2YWx1ZS4iKTsKICB9CgogIHJldHVybiAoaGludCA9PT0gInN0cmluZyIgPyBTdHJpbmcgOiBOdW1iZXIpKGlucHV0KTsKfQoKZnVuY3Rpb24gX3RvUHJvcGVydHlLZXkoYXJnKSB7CiAgdmFyIGtleSA9IF90b1ByaW1pdGl2ZShhcmcsICJzdHJpbmciKTsKCiAgcmV0dXJuICgwLCBfdHlwZW9mMy5kZWZhdWx0KShrZXkpID09PSAic3ltYm9sIiA/IGtleSA6IFN0cmluZyhrZXkpOwp9Ci8qKgogKiBAZmlsZSDlt6Xlhbfmlrnms5UKICogQGF1dGhvciB3YW5nYmluZzExKHdhbmdiaW5nMTFAYmFpZHUuY29tKQogKi8KCgp2YXIgZ2V0VWEgPSBmdW5jdGlvbiBnZXRVYSgpIHsKICB0cnkgewogICAgcmV0dXJuIHdpbmRvdy5uYXZpZ2F0b3IudXNlckFnZW50OwogIH0gY2F0Y2ggKGUpIHsKICAgIHJldHVybiAnJzsKICB9Cn07Cgp2YXIgaXNCb3ggPSBmdW5jdGlvbiBpc0JveCgpIHsKICB2YXIgdWEgPSBnZXRVYSgpOwogIHZhciBJU19MSVRFX0JPWCA9IC8gKGxpdGV8aW5mbykgYmFpZHVib3hhcHBcLy9pLnRlc3QodWEpOwogIHZhciBJU19LQU5EVU9EVU9fQk9YID0gLyBtaXNzaW9uIGJhaWR1Ym94YXBwXC8vaS50ZXN0KHVhKTsgLy8gSVNfQk9YIOagh+ivhuaYr+WQpuaJi+eZvuWfuuehgOeJiOWGhe+8jOS4jeiDveaYr0xpdGXjgIHkuI3mmK/nnIvlpJrlpJoKCiAgcmV0dXJuIC8gYmFpZHVib3hhcHBcLy9pLnRlc3QodWEpICYmICFJU19MSVRFX0JPWCAmJiAhSVNfS0FORFVPRFVPX0JPWDsKfTsKCnZhciBpc1N3YW4gPSBmdW5jdGlvbiBpc1N3YW4oKSB7CiAgdmFyIHVhID0gZ2V0VWEoKTsKICByZXR1cm4gL3N3YW4vaS50ZXN0KHVhKTsKfTsKCnZhciBnZXRMb2NhdGlvbiA9IGZ1bmN0aW9uIGdldExvY2F0aW9uKCkgewogIHRyeSB7CiAgICByZXR1cm4gZG9jdW1lbnQubG9jYXRpb247CiAgfSBjYXRjaCAoZSkgewogICAgcmV0dXJuIHsKICAgICAgaHJlZjogJycsCiAgICAgIHByb3RvY29sOiAnaHR0cHM6JywKICAgICAgb3JpZ2luOiAnJywKICAgICAgcGF0aG5hbWU6ICcnCiAgICB9OwogIH0KfTsKLyoqCiAqIOWtl+espuS4suWMlnF1ZXJ5CiAqCiAqIFvms6hd77yaCiAqIOm7mOiupO+8muWmguaenGB2YWx1ZWDmmK/mlbDnu4TvvIzlhbZgdG9TdHJpbmdg5Lya6Ieq5Yqo6L2s5Li66YCX5Y+35YiG6ZqU55qE5a2X56ym5LiyCiAqIOi/memHjO+8muWmguaenCDmmK8gQXJyYXkg5ZKMIE9iamVjdCDlj4LmlbAg6YO96L+b6KGMIEpTT04uc3RyaW5naWZ5ICsgZW5jb2RlVVJJQ29tcG9uZW50IOS6hgogKgogKiBAcGFyYW0ge09iamVjdH0gcXVlcnkg5p+l6K+i5p2h5Lu2CiAqIEByZXR1cm4ge3N0cmluZ30KICovCgoKZnVuY3Rpb24gc3RyaW5naWZ5KCkgewogIHZhciBxdWVyeSA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDoge307CgogIGlmICghcXVlcnkpIHsKICAgIHJldHVybiAnJzsKICB9CgogIHZhciBzZWFyY2ggPSAnJzsKCiAgZm9yICh2YXIga2V5IGluIHF1ZXJ5KSB7CiAgICBpZiAocXVlcnkuaGFzT3duUHJvcGVydHkoa2V5KSkgewogICAgICB2YXIgdmFsdWUgPSBxdWVyeVtrZXldOwoKICAgICAgaWYgKHZhbHVlID09IG51bGwpIHsKICAgICAgICB2YWx1ZSA9ICcnOwogICAgICB9IGVsc2UgaWYgKF90eXBlb2YodmFsdWUpID09PSAnb2JqZWN0JykgewogICAgICAgIHZhbHVlID0gSlNPTi5zdHJpbmdpZnkodmFsdWUpOwogICAgICB9CgogICAgICBzZWFyY2ggKz0gJyYnICsgZW5jb2RlVVJJQ29tcG9uZW50KGtleSkgKyAnPScgKyBlbmNvZGVVUklDb21wb25lbnQodmFsdWUpOwogICAgfQogIH0KCiAgcmV0dXJuIHNlYXJjaC5zbGljZSgxKTsKfQovKioKICog5ZyodXJs5LiK5Yqg5oyH5a6a5Y+C5pWwCiAqCiAqIEBwYXJhbSAge3N0cmluZ30gdXJsICB1cmwKICogQHBhcmFtIHtPYmplY3R9IHF1ZXJ5IOWPguaVsOWvueixoQogKiBAZXhhbXBsZQogKiB7CiAqICAgIGE6IDEKICogfQogKiBAcmV0dXJuIHtzdHJpbmd9ICAgIOa3u+WKoOWPguaVsOWQjueahHVybAogKi8KCgpmdW5jdGlvbiByZW5kZXJVcmwoKSB7CiAgdmFyIHVybCA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogJyc7CiAgdmFyIHF1ZXJ5ID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiB7fTsKICByZXR1cm4gdXJsICsgKH51cmwuaW5kZXhPZignPycpID8gJyYnIDogJz8nKSArIHN0cmluZ2lmeShxdWVyeSk7Cn0KLyoqCiAqIGlzT2JqZWN0CiAqCiAqIEBwYXJhbSB7Kn0gdmFsdWUgdmFsdWUKICogQHJldHVybiB7Ym9vbGVhbn0g5aaC5p6c5piv5a+56LGh5YiZ6L+U5ZueIHRydWUsIOWQpuWImSBmYWxzZQogKi8KCgpmdW5jdGlvbiBpc09iamVjdCh2YWx1ZSkgewogIC8vIEF2b2lkIGEgVjggSklUIGJ1ZyBpbiBDaHJvbWUgMTktMjAuCiAgLy8gU2VlIGh0dHBzOi8vY29kZS5nb29nbGUuY29tL3AvdjgvaXNzdWVzL2RldGFpbD9pZD0yMjkxIGZvciBtb3JlIGRldGFpbHMuCiAgdmFyIHR5cGUgPSBfdHlwZW9mKHZhbHVlKTsKCiAgcmV0dXJuIHR5cGUgPT09ICdmdW5jdGlvbicgfHwgISF2YWx1ZSAmJiB0eXBlID09PSAnb2JqZWN0JzsKfQovKioKICogZ2V0VXJsUXVlcnkgIOS7jnVybOS4reiOt+WPlnF1ZXJ55a+56LGhCiAqCiAqIEBwYXJhbSAgIHtPYmplY3R9IGtleSB1cmxRdWVyeeS4reiOt+W+l2tleeWvueW6lOeahOWPguaVsO+8jOWmguaenOS4jeS8oOWImei/lOWbnuaVtOS4qnF1ZXJ55a+56LGhCiAqIEByZXR1cm4gIHtzdHJpbmcgfCBPYmplY3R9IHF1ZXJ5U3RyIOaIliDmlbTkuKpxdWVyeeWvueixoQogKi8KCgp2YXIgZ2V0VXJsUXVlcnkgPSBmdW5jdGlvbiBnZXRVcmxRdWVyeShrZXkpIHsKICB2YXIgdXJsID0gZ2V0TG9jYXRpb24oKS5ocmVmOwogIHZhciByZWcgPSBuZXcgUmVnRXhwKCdbXFw/Jl0oW15cXD8mXFw9XFwvXSspPShbXlxcP1xcJlxcPVxcL10qKScsICdnJyk7CiAgdmFyIHF1ZXJ5ID0ge307CiAgdmFyIHJlZ1Jlc3VsdDsKCiAgd2hpbGUgKChyZWdSZXN1bHQgPSByZWcuZXhlYyh1cmwpKSAhPT0gbnVsbCkgewogICAgcXVlcnlbcmVnUmVzdWx0WzFdXSA9IHJlZ1Jlc3VsdFsyXTsKICB9CgogIGlmIChrZXkpIHsKICAgIHJldHVybiBxdWVyeVtrZXldOwogIH0gZWxzZSB7CiAgICByZXR1cm4gcXVlcnk7CiAgfQp9OwovKioKICogZ2V0VXJsCiAqCiAqIEBwYXJhbSAgIHtzdHJpbmd9ICB1cmwgICAgICAg6K+35rGCdXJsCiAqIEBwYXJhbSAgIHtPYmplY3R9ICBwYXJhbXMgICAg5Y+C5pWwCiAqIEByZXR1cm4gIHtzdHJpbmd9ICDmm7TmlrB1cmwo6L+H5ruk5Li656m655qE5Y+C5pWwKQogKi8KCgp2YXIgZ2V0VXJsID0gZnVuY3Rpb24gZ2V0VXJsKHVybCwgcGFyYW1zKSB7CiAgdmFyIHJlYWxQYXJhbXMgPSB7fTsKICBPYmplY3Qua2V5cyhwYXJhbXMpLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHsKICAgIC8vIFRPRE8gcGFyYW1zW2l0ZW1d5piv5LiN5piv5pyJ5Y+v6IO95Li6MAogICAgcGFyYW1zW2l0ZW1dICYmIChyZWFsUGFyYW1zW2l0ZW1dID0gcGFyYW1zW2l0ZW1dKTsKICB9KTsKCiAgaWYgKE9iamVjdC5rZXlzKHJlYWxQYXJhbXMpLmxlbmd0aCA9PT0gMCkgewogICAgcmV0dXJuIHVybDsKICB9CgogIHJldHVybiByZW5kZXJVcmwodXJsLCByZWFsUGFyYW1zKTsKfTsKLyoqCiAqIOiOt+W+l2tleeWvueW6lOeahGNvb2tpZeWAvAogKiBAcGFyYW0ge3N0cmluZ30gc0tleSBjb29raWXnmoRrZXkKICogQHJldHVybiB7c3RyaW5nfSBjb29raWXnmoR2YWx1ZQogKi8KCgp2YXIgZ2V0Q29va2llQnlOYW1lID0gZnVuY3Rpb24gZ2V0Q29va2llQnlOYW1lKHNLZXkpIHsKICB2YXIgY29va2llID0gZG9jdW1lbnQuY29va2llIHx8ICcnOwogIHJldHVybiBkZWNvZGVVUklDb21wb25lbnQoY29va2llLnJlcGxhY2UobmV3IFJlZ0V4cCgnKD86KD86XnwuKjspXFxzKicgKyBlbmNvZGVVUklDb21wb25lbnQoc0tleSkucmVwbGFjZSgvWy0uKypdL2csICdcXCQmJykgKyAnXFxzKlxcPVxccyooW147XSopLiokKXxeLiokJyksICckMScpKSB8fCAnJzsKfTsKLyoqCiAqIOiOt+W+l2tleeWvueW6lOeahGNvb2tpZeWAvAogKiBAcGFyYW0ge2FueX0gc291cmNlIG1lcmdl55qE56ys5LiA5Liq5a+56LGhCiAqIEBwYXJhbSB7YW55fSBvdGhlciBtZXJnZeeahOesrOS6jOS4quWvueixoQogKiBAcmV0dXJuIHthbnl9IG1lcmdl5ZCO55qE5a+56LGhCiAqLwoKCnZhciBtZXJnZSA9IGZ1bmN0aW9uIG1lcmdlKHNvdXJjZSwgb3RoZXIpIHsKICBpZiAoIWlzT2JqZWN0KHNvdXJjZSkgfHwgIWlzT2JqZWN0KG90aGVyKSkgewogICAgcmV0dXJuIG90aGVyID09PSB1bmRlZmluZWQgPyBzb3VyY2UgOiBvdGhlcjsKICB9IC8vIOWQiOW5tuS4pOS4quWvueixoeeahCBrZXnvvIzlj6blpJbopoHljLrliIbmlbDnu4TnmoTliJ3lp4vlgLzkuLogW10KCgogIHJldHVybiBPYmplY3Qua2V5cyhfb2JqZWN0U3ByZWFkMihfb2JqZWN0U3ByZWFkMih7fSwgc291cmNlKSwgb3RoZXIpKS5yZWR1Y2UoZnVuY3Rpb24gKGFjYywga2V5KSB7CiAgICAvLyDpgJLlvZLlkIjlubYgdmFsdWUKICAgIGFjY1trZXldID0gbWVyZ2Uoc291cmNlW2tleV0sIG90aGVyW2tleV0pOwogICAgcmV0dXJuIGFjYzsKICB9LCBBcnJheS5pc0FycmF5KHNvdXJjZSkgPyBbXSA6IHt9KTsKfTsKLyoqCiAqIEBmaWxlIHViY0xvZ+eahGNvbmbphY3nva4KICogQGF1dGhvciBzb25nemltZWk8c29uZ3ppbWVpQGJhaWR1LmNvbT4KICovCgoKdmFyIGdldFByb3RvY29sID0gZnVuY3Rpb24gZ2V0UHJvdG9jb2woKSB7CiAgaWYgKFsnaHR0cDonLCAnaHR0cHM6J10uaW5jbHVkZXMoZ2V0TG9jYXRpb24oKS5wcm90b2NvbCkpIHsKICAgIHJldHVybiBnZXRMb2NhdGlvbigpLnByb3RvY29sOwogIH0KCiAgcmV0dXJuICdodHRwczonOwp9OwoKdmFyIENPTkZJRyA9IHsKICBVQkNfVVJMOiBnZXRQcm90b2NvbCgpICsgJy8vaDJ0Y2JveC5iYWlkdS5jb20venRib3gnLAogIFRFU1RfVUJDX1VSTDogJ2h0dHA6Ly9ianl6LW1jby1zZWFyY2hib3gyMDE2MDktbTEyeGkzLTA0NC5ianl6LmJhaWR1LmNvbTo4MDgwL3p0Ym94JywKICBERUZBVUxUX0xPR19EQVRBOiB7CiAgICBjYXRlaWQ6ICc5OScsCiAgICBhY3Rpb25kYXRhOiB7CiAgICAgIC8vIOWklumDqOWhq+WGme+8iHViY0lE77yJCiAgICAgIGlkOiAnMCcsCiAgICAgIC8vIOaXpeW/l+exu+Wei++8mjDigJTkuovku7bnsbvvvIh3ZWLnsbvvvIkx4oCU5rWB57G75Z6L77yI5a6i5oi356uvKQogICAgICB0eXBlOiAnMCcsCiAgICAgIHRpbWVzdGFtcDogMCwKICAgICAgY29udGVudDogewogICAgICAgIC8vIOmhtemdouWQjeensAogICAgICAgIHBhZ2U6ICctJywKICAgICAgICAvLyDljLrlnZfkvY3nva4KICAgICAgICB0eXBlOiAnLScsCiAgICAgICAgLy8g6aG16Z2i5p2l5rqQCiAgICAgICAgdmFsdWU6ICctJywKICAgICAgICAvLyDotYTmupDmnaXmupAKICAgICAgICBzb3VyY2U6ICdkZWZhdWx0JywKICAgICAgICAvLyDml6Xlv5fnsbvlnosKICAgICAgICBmcm9tOiAnYWN0JywKICAgICAgICAvLyDmianlsZXlrZfmrrUKICAgICAgICBleHQ6IHsKICAgICAgICAgIGFwcHR5cGU6ICctJwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0sCiAgREVGQVVMVF9RVUVSWTogewogICAgYWN0aW9uOiAnenBibG9nJywKICAgIHY6ICcyLjAnLAogICAgYXBwbmFtZTogJ2JhaWR1Ym94YXBwJywKICAgIGZyb206ICcnLAogICAgY2Zyb206ICcnLAogICAgc21mdzogJycKICB9Cn07CnZhciBDT05GSUdfTUVSR0UgPSB7CiAgVUJDX1VSTDogZ2V0TG9jYXRpb24oKS5wcm90b2NvbCArICcvL2gydGNib3guYmFpZHUuY29tL3p0Ym94JywKICBURVNUX1VCQ19VUkw6ICdodHRwOi8vYmp5ei1tY28tc2VhcmNoYm94MjAxNjA5LW0xMnhpMy0wNDQuYmp5ei5iYWlkdS5jb206ODA4MC96dGJveCcsCiAgREVGQVVMVF9MT0dfREFUQTogewogICAgY2F0ZWlkOiAnMTAxJywKICAgIGRhdGE6IFtdCiAgfSwKICBERUZBVUxUX1FVRVJZOiB7CiAgICBhY3Rpb246ICdtcGJsb2cnLAogICAgdjogJzIuMCcsCiAgICBhcHBuYW1lOiAnYmFpZHVib3hhcHAnLAogICAgZnJvbTogJycsCiAgICBjZnJvbTogJycsCiAgICBzbWZ3OiAnJywKICAgIHNpZDogJycsCiAgICBzbjogJycKICB9Cn07Ci8qKgogKiBAZmlsZSBzZW5kIOaWueazlQogKiBAYXV0aG9yIHdhbmdiaW5nMTEod2FuZ2JpbmcxMUBiYWlkdS5jb20pCiAqLwoKdmFyIGNyZWF0ZUltZyA9IGZ1bmN0aW9uIGNyZWF0ZUltZyhzcmMpIHsKICB2YXIgaW1nID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJyk7CiAgaW1nLndpZHRoID0gMTsKICBpbWcuaGVpZ2h0ID0gMTsKICBpbWcuc3JjID0gc3JjOwogIHJldHVybiBpbWc7Cn07IC8vIOWbnuiwg+WHveaVsOetieW+heaXtumXtAoKCnZhciBjYWxsYmFja1dhaXRpbmdUaW1lID0gMTAwOwovKioKICog5L2/55So5Zu+54mH5p2l5Y+R6K+35rGCCiAqCiAqIEBwYXJhbSB7c3RyaW5nfSB1cmwg5LiK5oql5pyN5Yqh5Zyw5Z2ACiAqIEBwYXJhbSB7T2JqZWN0fSBwYXJhbSDkuIrmiqXnmoTmlbDmja4KICogQHJldHVybiB7UHJvbWlzZX0g57uT5p2f5Zue6LCDCiAqLwoKZnVuY3Rpb24gaW1nUGluZyh1cmwsIHBhcmFtKSB7CiAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgIC8vIOeUn+aIkFVSTAogICAgdXJsID0gcmVuZGVyVXJsKHVybCwgewogICAgICBkYXRhOiBwYXJhbQogICAgfSk7CiAgICB2YXIgaW1nID0gY3JlYXRlSW1nKHVybCk7CiAgICB2YXIgaXNDYWxsYmFja2VkID0gZmFsc2U7IC8vIOetieW+hSAxMDAgbXPvvIwgMTAwbXPlkI7lpoLmnpzlm57osIPlh73mlbDov5jmsqHmnInmiafooYzvvIzlsLHnq4vljbPmiafooYzlm57osIMKCiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKCFpc0NhbGxiYWNrZWQpIHsKICAgICAgICByZXNvbHZlKCk7CiAgICAgICAgaXNDYWxsYmFja2VkID0gdHJ1ZTsKICAgICAgfQogICAgfSwgY2FsbGJhY2tXYWl0aW5nVGltZSk7CgogICAgaW1nLm9ubG9hZCA9IGltZy5vbmVycm9yID0gZnVuY3Rpb24gKCkgewogICAgICBpbWcgPSBudWxsOyAvLyDkuIrmiqXmiJDlip/lkI7vvIzlpoLmnpzlm57osIPlh73mlbDov5jmsqHmnInmiafooYzvvIzlsLHmiafooYzlm57osIPlh73mlbAKCiAgICAgIGlmICghaXNDYWxsYmFja2VkKSB7CiAgICAgICAgcmVzb2x2ZSgpOwogICAgICAgIGlzQ2FsbGJhY2tlZCA9IHRydWU7CiAgICAgIH0KICAgIH07CiAgfSk7Cn0KLyoqCiAqIOS9v+eUqE5hdmlnYXRvci5zZW5kQmVhY29u5p2l5Y+R6K+35rGCCiAqCiAqIEBwYXJhbSB7c3RyaW5nfSB1cmwg5LiK5oql5pyN5Yqh5Zyw5Z2ACiAqIEBwYXJhbSB7T2JqZWN0fSBwYXJhbSDkuIrmiqXnmoTmlbDmja4KICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnMg5LiK5oql5qC85byPCiAqIEByZXR1cm4ge1Byb21pc2V9IOe7k+adn+WbnuiwgwogKi8KCgpmdW5jdGlvbiBiZWFjb25TZW5kKHVybCwgcGFyYW0sIG9wdGlvbnMpIHsKICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgdmFyIGlzRGF0YUluQm9keSA9IG9wdGlvbnMuc2VuZE1ldGhvZCA9PT0gJ3Bvc3QnOwogICAgdmFyIGlzU2VuZFN1Y2Nlc3M7CgogICAgaWYgKGlzRGF0YUluQm9keSkgewogICAgICBpc1NlbmRTdWNjZXNzID0gd2luZG93Lm5hdmlnYXRvci5zZW5kQmVhY29uKHJlbmRlclVybCh1cmwsIHsKICAgICAgICBkYXRhOiBwYXJhbQogICAgICB9KSk7CiAgICB9IGVsc2UgewogICAgICBpc1NlbmRTdWNjZXNzID0gd2luZG93Lm5hdmlnYXRvci5zZW5kQmVhY29uKHVybCwgJ2RhdGE9JyArIGVuY29kZVVSSUNvbXBvbmVudChKU09OLnN0cmluZ2lmeShwYXJhbSkpKTsKICAgIH0gLy8g55Sf5oiQVVJMCgoKICAgIGlmIChpc1NlbmRTdWNjZXNzKSB7CiAgICAgIHJlc29sdmUoKTsKICAgIH0gZWxzZSB7CiAgICAgIHJlamVjdCgpOwogICAgfQogIH0pOwp9CgpmdW5jdGlvbiB4aHJTZW5kKHVybCwgcGFyYW0pIHsKICB2YXIgb3B0aW9ucyA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDoge307CiAgdmFyIG1ldGhvZCA9IG9wdGlvbnMuc2VuZE1ldGhvZCA9PT0gJ3Bvc3QnID8gJ1BPU1QnIDogJ0dFVCc7CiAgdXJsID0gbWV0aG9kID09PSAnUE9TVCcgPyB1cmwgOiByZW5kZXJVcmwodXJsLCB7CiAgICBkYXRhOiBwYXJhbQogIH0pOwogIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICB2YXIgb1JlcSA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpOwogICAgb1JlcS5hZGRFdmVudExpc3RlbmVyKCdsb2FkZW5kJywgZnVuY3Rpb24gKCkgewogICAgICBpZiAob1JlcS5zdGF0dXMgPT09IDIwMCkgewogICAgICAgIHJlc29sdmUoKTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZWplY3QoKTsKICAgICAgfQogICAgfSk7CiAgICBvUmVxLm9wZW4obWV0aG9kLCB1cmwpOwogICAgb1JlcS53aXRoQ3JlZGVudGlhbHMgPSB0cnVlOwoKICAgIGlmIChtZXRob2QgPT09ICdQT1NUJykgewogICAgICBvUmVxLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtdHlwZSIsICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKTsKICAgICAgb1JlcS5zZW5kKCdkYXRhPScgKyBlbmNvZGVVUklDb21wb25lbnQoSlNPTi5zdHJpbmdpZnkocGFyYW0pKSk7CiAgICB9IGVsc2UgewogICAgICBvUmVxLnNlbmQoKTsKICAgIH0KICB9KTsKfQovKioKICog5L2/55So5Zu+54mH5p2l5Y+R6K+35rGCCiAqCiAqIEBwYXJhbSB7c3RyaW5nfSB1cmwg5LiK5oql5pyN5Yqh5Zyw5Z2ACiAqIEBwYXJhbSB7T2JqZWN0fSBwYXJhbSDkuIrmiqXnmoTmlbDmja4KICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zXSDpop3lpJblj4LmlbAKICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zLnVzZVNlbmRCZWFjb25dIOaYr+WQpuS9v+eUqHNlbmRCZWFuY29uCiAqIEBwYXJhbSB7Ym9vbGVhbn0gW29wdGlvbnMudXNlWGhyXSDmmK/lkKbkvb/nlKh1c2VYaHIKICogQHBhcmFtIHtzdHJpbmd9IFtvcHRpb25zLnNlbmRNZXRob2RdIHBvc3QvZ2V0CiAqIEByZXR1cm4ge1Byb21pc2V9IOe7k+adn+WbnuiwgwogKi8KCgpmdW5jdGlvbiBzbWFydFNlbmQodXJsLCBwYXJhbSkgewogIHZhciBvcHRpb25zID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgJiYgYXJndW1lbnRzWzJdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMl0gOiB7fTsKCiAgaWYgKG9wdGlvbnMudXNlWGhyKSB7CiAgICByZXR1cm4geGhyU2VuZCh1cmwsIHBhcmFtLCBvcHRpb25zKTsKICB9IC8vIOS4juaVsOaNrlJE5rKf6YCa77yM5b6F5pWw5o2u57uE5Y2H57qn5ZCO5Y+v5ZCv55SoLeWcqOWlveeci+WSjOWFqOawkeerr3NlbmRCZWFjb27ml6DmlYgKCgogIGlmICh0eXBlb2Ygd2luZG93Lm5hdmlnYXRvci5zZW5kQmVhY29uID09PSAnZnVuY3Rpb24nICYmIG9wdGlvbnMudXNlU2VuZEJlYWNvbikgewogICAgcmV0dXJuIGJlYWNvblNlbmQodXJsLCBwYXJhbSwgb3B0aW9ucyk7CiAgfQoKICByZXR1cm4gaW1nUGluZyh1cmwsIHBhcmFtKTsKfQovKioKICogQGZpbGUgc2VuZCDmlrnms5UKICogQGF1dGhvciB3YW5nYmluZzExKHdhbmdiaW5nMTFAYmFpZHUuY29tKQogKi8KLy8gU2V0IHRoZSBuYW1lIG9mIHRoZSBoaWRkZW4gcHJvcGVydHkgYW5kIHRoZSBjaGFuZ2UgZXZlbnQgZm9yIHZpc2liaWxpdHkKCgpmdW5jdGlvbiByZWdlc3RQYWdlVmlzaWJpbGl0eUV2ZW50KGhhbmRsZXIpIHsKICB0cnkgewogICAgdmFyIGhpZGRlbjsKICAgIHZhciB2aXNpYmlsaXR5Q2hhbmdlOwoKICAgIGlmICh0eXBlb2YgZG9jdW1lbnQuaGlkZGVuICE9PSAndW5kZWZpbmVkJykgewogICAgICAvLyBPcGVyYSAxMi4xMCBhbmQgRmlyZWZveCAxOCBhbmQgbGF0ZXIgc3VwcG9ydAogICAgICBoaWRkZW4gPSAnaGlkZGVuJzsKICAgICAgdmlzaWJpbGl0eUNoYW5nZSA9ICd2aXNpYmlsaXR5Y2hhbmdlJzsKICAgIH0gZWxzZSBpZiAodHlwZW9mIGRvY3VtZW50Lm1zSGlkZGVuICE9PSAndW5kZWZpbmVkJykgewogICAgICBoaWRkZW4gPSAnbXNIaWRkZW4nOwogICAgICB2aXNpYmlsaXR5Q2hhbmdlID0gJ21zdmlzaWJpbGl0eWNoYW5nZSc7CiAgICB9IGVsc2UgaWYgKHR5cGVvZiBkb2N1bWVudC53ZWJraXRIaWRkZW4gIT09ICd1bmRlZmluZWQnKSB7CiAgICAgIGhpZGRlbiA9ICd3ZWJraXRIaWRkZW4nOwogICAgICB2aXNpYmlsaXR5Q2hhbmdlID0gJ3dlYmtpdHZpc2liaWxpdHljaGFuZ2UnOwogICAgfSBlbHNlIGlmICh0eXBlb2YgZG9jdW1lbnQuYmFpZHVib3hhcHB2aXNpYmlsaXR5Y2hhbmdlICE9PSAndW5kZWZpbmVkJykgewogICAgICBoaWRkZW4gPSAnd2Via2l0SGlkZGVuJzsKICAgICAgdmlzaWJpbGl0eUNoYW5nZSA9ICd3ZWJraXR2aXNpYmlsaXR5Y2hhbmdlJzsKICAgIH0KCiAgICB2YXIgaGFuZGxlVmlzaWJpbGl0eUNoYW5nZSA9IGZ1bmN0aW9uIGhhbmRsZVZpc2liaWxpdHlDaGFuZ2UoKSB7CiAgICAgIGhhbmRsZXIoISFkb2N1bWVudFtoaWRkZW5dKTsKICAgIH07CgogICAgaWYgKHR5cGVvZiBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyID09PSAndW5kZWZpbmVkJyB8fCBoaWRkZW4gPT09IHVuZGVmaW5lZCkgewogICAgICByZXR1cm47CiAgICB9IC8vIEhhbmRsZSBwYWdlIHZpc2liaWxpdHkgY2hhbmdlCgoKICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIodmlzaWJpbGl0eUNoYW5nZSwgaGFuZGxlVmlzaWJpbGl0eUNoYW5nZSwgZmFsc2UpOwogIH0gY2F0Y2ggKGUpIHt9Cn0KCnZhciB2ZXJzaW9uID0gIjMuMy4zIjsKLyoqCiAqIEBmaWxlIOmAmui/h1VB6I635b6X5b2T5YmN5a6/5Li75L+h5oGvCiAqIEBhdXRob3IgY2hhbmd5dXFpbmcKICovCgp2YXIgdWFSZWdNYXAgPSBbewogIC8vIG5hbWU6ICfnnIvlpJrlpJonLAogIGFwcG5hbWU6ICdiYWlkdWJveG1pc3Npb24nLAogIHJlZzogL1xibWlzc2lvblxzYmFpZHVib3hhcHBcYi9pLAogIGFwcGlkOiAiMTAwMDYiCn0sIHsKICAvLyBuYW1lOiAn55m+5bqmQVBQ5p6B6YCf54mIJywKICBhcHBuYW1lOiAnYmFpZHVib3hsaXRlJywKICByZWc6IC9cYig/OmxpdGV8aW5mbykgYmFpZHVib3hhcHBcYi9pLAogIGFwcGlkOiAiMTAwMDEiCn0sIHsKICAvLyBuYW1lOiAn55m+5bqmQVBQJywKICBhcHBuYW1lOiAnYmFpZHVib3hhcHAnLAogIHJlZzogL1xiYmFpZHVib3hhcHBcYi9pLAogIGFwcGlkOiAiMSIKfSwgewogIC8vIG5hbWU6ICfnmb7luqbotLTlkKcnLAogIGFwcG5hbWU6ICd0aWViYScsCiAgcmVnOiAvXGJ0aWViYVxiL2ksCiAgYXBwaWQ6ICIxMTAwMSIKfSwgewogIC8vIG5hbWU6ICflpb3nnIvop4bpopEnLAogIGFwcG5hbWU6ICdoYW9rYW4nLAogIHJlZzogL1xiaGFva2FuXGIvaSwKICBhcHBpZDogIjExMDAwIgp9LCB7CiAgLy8gbmFtZTogJ+WFqOawkeWwj+inhumikScsCiAgYXBwbmFtZTogJ3F1YW5taW4nLAogIHJlZzogL1xiYmRtaW5pdmlkZW9cYi9pLAogIGFwcGlkOiAiMTIwMjIiCn0sIHsKICAvLyBuYW1lOiAn55m+5bqm5Zyw5Zu+JywKICBhcHBuYW1lOiAnYmRtYXAnLAogIHJlZzogL1xiYmFpZHVtYXBfL2ksCiAgYXBwaWQ6ICIxMTAwNiIKfSwgewogIC8vIG5hbWU6ICfnmb7luqbnvZHnm5gnLAogIGFwcG5hbWU6ICd3YW5ncGFuJywKICByZWc6IC9cYm5ldGRpc2s7L2ksCiAgYXBwaWQ6ICIxMjAxOCIKfSwgewogIC8vIG5hbWU6ICflrp3lrp3nn6XpgZMnLAogIGFwcG5hbWU6ICdhc2tteWJhYnknLAogIHJlZzogL1xibXliYWJ5XC8vaSwKICBhcHBpZDogIjEyMDE5Igp9LCB7CiAgLy8gbmFtZTogJ+ilv+eVqicsCiAgYXBwbmFtZTogJ3hpZmFuJywKICByZWc6IC9cYmJkeGlmYW5cLy9pLAogIGFwcGlkOiAiMTIwMDYiCn0sIHsKICBhcHBpZDogIjEyMDMxIiwKICAvLyBuYW1lOiAn55m+5bqm5omL5py65Yqp5omLJywKICBhcHBuYW1lOiAnc293aGF0Jwp9LCB7CiAgYXBwaWQ6ICIxMjAxMCIsCiAgLy8gbmFtZTogJ+afoOaqrOeIsee+jicsCiAgYXBwbmFtZTogJ2xlbW9uJywKICByZWc6IC9sZW1vbmFwcC9pCn0sIHsKICBhcHBpZDogIjEyMDE1IiwKICAvLyBuYW1lOiAn55m+5a625Y+3QVBQJywKICBhcHBuYW1lOiAnYmFpamlhaGFvJwp9LCB7CiAgYXBwaWQ6ICIxMjAxMiIsCiAgLy8gbmFtZTogJ+eVquS5kCcsCiAgYXBwbmFtZTogJ2ZhbmxlJwp9LCB7CiAgYXBwaWQ6ICIxMjAxMyIsCiAgLy8gbmFtZTogJ+WPpOeJqea9rueOqScsCiAgYXBwbmFtZTogJ3poYW9jYWltYW8nCn0sIHsKICBhcHBpZDogIjEyMDE0IiwKICAvLyBuYW1lOiAn5YiG546pJywKICBhcHBuYW1lOiAnZ2FtZW5vdycKfSwgewogIGFwcGlkOiAiMTIwMTYiLAogIC8vIG5hbWU6ICfniLHlpYfoibonLAogIGFwcG5hbWU6ICdpcWl5aScKfSwgewogIGFwcGlkOiAiMTIwMTciLAogIC8vIG5hbWU6ICfnmb7luqbnmb7np5EnLAogIGFwcG5hbWU6ICdiYWlrZScKfSwgewogIGFwcGlkOiAiMTIwMjMiLAogIC8vIG5hbWU6ICfmlrDmtYEnLAogIGFwcG5hbWU6ICdmbG93Jwp9LCB7CiAgYXBwaWQ6ICIxMjAyNiIsCiAgLy8gbmFtZTogJ1JvYm90YXhp57qm6L2mJywKICBhcHBuYW1lOiAnZHV0YXhpJwp9LCB7CiAgYXBwaWQ6ICIxMjAxMSIsCiAgLy8gbmFtZTogJ+aciempvkFQUCcsCiAgYXBwbmFtZTogJ3lvdWppYScKfSwgewogIGFwcGlkOiAiMTIwMjAiLAogIC8vIG5hbWU6ICflhoXlrrnogZTnm58nLAogIGFwcG5hbWU6ICdmZWVkc3VuaW9uJwp9LCB7CiAgYXBwaWQ6ICIxMjAyMSIsCiAgLy8gbmFtZTogJ+S4gOWIu+ebuOWGjCcsCiAgYXBwbmFtZTogJ2FsYnVtJwp9LCB7CiAgYXBwaWQ6ICIxMjAyNCIsCiAgLy8gbmFtZTogJ+mhtea4uOW5s+WPsCcsCiAgYXBwbmFtZTogJ3dlYmdhbWUnCn0sIHsKICBhcHBpZDogIjEyMDI3IiwKICAvLyBuYW1lOiAnSE1J5LmY5a6i56uvJywKICBhcHBuYW1lOiAnaG1pX3Bhc3NlbmdlcicKfSwgewogIGFwcGlkOiAiMTIwMjgiLAogIC8vIG5hbWU6ICfnmb7luqbmloflupMnLAogIGFwcG5hbWU6ICdiZHdlbmt1Jwp9LCB7CiAgYXBwaWQ6ICIxMjAyOSIsCiAgLy8gbmFtZTogJ+eZvuW6pue/u+ivkScsCiAgYXBwbmFtZTogJ2ZhbnlpJwp9LCB7CiAgYXBwaWQ6ICIxMjAzMCIsCiAgLy8gbmFtZTogJ+eZvuW6puefpemBkycsCiAgYXBwbmFtZTogJ2lrbm93Jwp9LCB7CiAgYXBwaWQ6ICIxMjAyNSIsCiAgLy8gbmFtZTogJ+W6puaZk+aZkycsCiAgYXBwbmFtZTogJ2R1eGlhb3hpYW8nCn0sIHsKICBhcHBpZDogIjEyMDMyIiwKICAvLyBuYW1lOiAn55m+5bqm5rGJ6K+tJywKICBhcHBuYW1lOiAnYmFpZHVoYW55dScKfSwgewogIGFwcGlkOiAiMTIwMzQiLAogIC8vIG5hbWU6ICfnmb7luqbnu4/pqownLAogIGFwcG5hbWU6ICdleHAnCn0sIHsKICBhcHBpZDogIjEyMDM2IiwKICAvLyBuYW1lOiAnQVBQIERFTU8nLAogIGFwcG5hbWU6ICdkZW1vJwp9LCB7CiAgYXBwaWQ6ICIxMjAzNyIsCiAgLy8gbmFtZTogJ+eZvuW6pumYheivuycsCiAgYXBwbmFtZTogJ2JhaWR1eXVlZHUnCn0sIHsKICBhcHBpZDogIjEyMDM4IiwKICAvLyBuYW1lOiAn5YGl5bq3566h55CGJywKICBhcHBuYW1lOiAnY2RtJwp9LCB7CiAgYXBwaWQ6ICIxMjA0MCIsCiAgLy8gbmFtZTogJ+W+ruWPreS8tOiBiicsCiAgYXBwbmFtZTogJ3dlaWJhJwp9LCB7CiAgYXBwaWQ6ICIxMjA0MSIsCiAgLy8gbmFtZTogJ+eZvuW6puinhumikeeJiCcsCiAgYXBwbmFtZTogJ2JhaWR1Ym94dmlzaW9uJwp9LCB7CiAgYXBwaWQ6ICIxMjA0MiIsCiAgLy8gbmFtZTogJ+WYu+WTiCcsCiAgYXBwbmFtZTogJ2hpcGhvcCcKfSwgewogIGFwcGlkOiAiMTIwNDMiLAogIC8vIG5hbWU6ICdyb2JvYnVz5o6n5Yi257uI56uvJywKICBhcHBuYW1lOiAncm9ib2J1cy1wYW5lbCcKfSwgewogIGFwcGlkOiAiMTIwNDQiLAogIC8vIG5hbWU6ICfmloflupPlpKflrabnlJ/niYgnLAogIGFwcG5hbWU6ICd3ZW5rdXN0dWRlbnQnCn0sIHsKICBhcHBpZDogIjEyMDQ1IiwKICAvLyBuYW1lOiAn55m+5bqmUEPnm7Tmkq0nLAogIGFwcG5hbWU6ICdwY19saXZlJwp9LCB7CiAgYXBwaWQ6ICIxMjA0OSIsCiAgLy8gbmFtZTogJ+S6keS4iueZvuW6picsCiAgYXBwbmFtZTogJ3l1bnNoYW5nYmFpZHUnCn0sIHsKICBhcHBpZDogIjEyMDUwIiwKICAvLyBuYW1lOiAn55m+5bqm5paH5bqTUEPlrqLmiLfnq68nLAogIGFwcG5hbWU6ICdiYWlkdXdlbmt1X3BjJwp9LCB7CiAgYXBwaWQ6ICIxMjA1MSIsCiAgLy8gbmFtZTogJ+mfs+ejgScsCiAgYXBwbmFtZTogJ3lpbmNpJwp9LCB7CiAgYXBwaWQ6ICIxMjA1MiIsCiAgLy8gbmFtZTogJ+Wwj+ivtOS5puWfjicsCiAgYXBwbmFtZTogJ25vdmVsJwp9LCB7CiAgYXBwaWQ6ICIxMjA1NCIsCiAgLy8gbmFtZTogJ+acieWZlycsCiAgYXBwbmFtZTogJ3lvb3B1Jwp9LCB7CiAgYXBwaWQ6ICIxMjA1NyIsCiAgLy8gbmFtZTogJ+mfs+WVtScsCiAgYXBwbmFtZTogJ3lpbmJvJwp9LCB7CiAgYXBwaWQ6ICIxMjA2MiIsCiAgLy8gbmFtZTogJ+eIseS8geafpScsCiAgYXBwbmFtZTogJ2FpcWljaGEnCn0sIHsKICBhcHBpZDogIjEyMDY2IiwKICAvLyBuYW1lOiAn6L2756u55YGl5bq3JywKICBhcHBuYW1lOiAnQmFtYm9vX0hlYWx0aCcKfSwgewogIGFwcGlkOiAiMTIwNjciLAogIC8vIG5hbWU6ICfovbvnq7nlgaXlurfljLvnlJ/niYgnLAogIGFwcG5hbWU6ICdCYW1ib29fSGVhbHRoX0RyJwp9LCB7CiAgYXBwaWQ6ICIxMjA3MyIsCiAgLy8gbmFtZTogJ+Wwj+W6picsCiAgYXBwbmFtZTogJ3N1cGVyZHVlcicKfSwgewogIGFwcGlkOiAiMTIwNzQiLAogIC8vIG5hbWU6ICfnmb7luqblgaXlurcnLAogIGFwcG5hbWU6ICdiYWlkdWppYW5rYW5nYXBwJwp9LCB7CiAgYXBwaWQ6ICIxMjA3NSIsCiAgLy8gbmFtZTogJ+eZvuW6pueIseeVqueVqicsCiAgYXBwbmFtZTogJ2JkY3JtX2FpZmFuZmFuJwp9LCB7CiAgYXBwaWQ6ICIxMjA3NyIsCiAgLy8gbmFtZTogJ+aLh+aMh+WMu+eUnyjljLvnlJ/niYgpJywKICBhcHBuYW1lOiAnbXV6aGlkb2N0b3InCn0sIHsKICBhcHBpZDogIjEyMDc5IiwKICAvLyBuYW1lOiAnQXBvbGxvIEdPJywKICBhcHBuYW1lOiAnYXBvbGxvZ28nCn0sIHsKICBhcHBpZDogIjEyMDgwIiwKICAvLyBuYW1lOiAn5b6L5Li0JywKICBhcHBuYW1lOiAnbHZsaW4nCn0sIHsKICBhcHBpZDogIjEyMDgzIiwKICAvLyBuYW1lOiAn54ix6YeH6LSt5Y2W5a6254mIJywKICBhcHBuYW1lOiAnYWlwdXJjaGFzZScKfSwgewogIGFwcGlkOiAiMTIwODgiLAogIC8vIG5hbWU6ICfnmb7luqZDYXJMaWZlJywKICBhcHBuYW1lOiAnQmFpRHVDYXJMaWZlJwp9LCB7CiAgYXBwaWQ6ICIxMjA5MCIsCiAgLy8gbmFtZTogJ+eZvuW6puWBpeW6t3R0JywKICBhcHBuYW1lOiAnYmFpZHVqaWFua2FuZ3R0Jwp9LCB7CiAgYXBwaWQ6ICIxMjA5MiIsCiAgLy8gbmFtZTogJ+Wmgua1gScsCiAgYXBwbmFtZTogJ2luZm9mbG93JywKICByZWc6IC9cYmJhaWR1aGkvaQp9LCB7CiAgYXBwaWQ6ICIxMjA5NCIsCiAgLy8gbmFtZTogJ2htaSBkcml2ZXInLAogIGFwcG5hbWU6ICdobWlfZHJpdmVyJwp9LCB7CiAgYXBwaWQ6ICIxMjA5NSIsCiAgLy8gbmFtZTogJ+eZvuW6plZS5pm65oWn5LqR5bGVJywKICBhcHBuYW1lOiAndnJfZXhwbycKfSwgewogIGFwcGlkOiAiMTIwOTYiLAogIC8vIG5hbWU6ICflhoXlrrnnlLXllYblsI/nqIvluo8nLAogIGFwcG5hbWU6ICdjb250ZW50X2Vjb21tZXJjZScKfSwgewogIGFwcGlkOiAiMTIwOTciLAogIC8vIG5hbWU6ICfnmb7luqZWUuaSreaOp+acjeWKoScsCiAgYXBwbmFtZTogJ3BsYXlfY29udHJvbCcKfSwgewogIGFwcGlkOiAiMTIwOTgiLAogIC8vIG5hbWU6ICfniLHph4fotK3kubDlrrbniYgnLAogIGFwcG5hbWU6ICdhaXB1cmNoYXNlcicKfSwgewogIGFwcGlkOiAiMTIxMDEiLAogIC8vIG5hbWU6ICflnLDlm77mt5jph5EnLAogIGFwcG5hbWU6ICdkaXR1dGFvamluJwp9LCB7CiAgYXBwaWQ6ICIxMjEwMiIsCiAgLy8gbmFtZTogJ+mrmOeyvuWumuS9jVNESycsCiAgYXBwbmFtZTogJ2hwX2xvY2F0aW9uJwp9LCB7CiAgYXBwaWQ6ICIxMjEwNiIsCiAgLy8gbmFtZTogJ+S4gOi1t+WQpycsCiAgYXBwbmFtZTogJ2NoYXRyb29tJwp9LCB7CiAgYXBwaWQ6ICIxMjEwNyIsCiAgLy8gbmFtZTogJ0dhaWHmlbDmja5BcHAnLAogIGFwcG5hbWU6ICdnYWlhJwp9LCB7CiAgYXBwaWQ6ICIxMjEwOCIsCiAgLy8gbmFtZTogJ1VCSeWVhuS4muaVsOaNrkFwcCcsCiAgYXBwbmFtZTogJ3ViaScKfSwgewogIGFwcGlkOiAiMTIxMDkiLAogIC8vIG5hbWU6ICfkuIDlsYAnLAogIGFwcG5hbWU6ICd5aWp1Jwp9LCB7CiAgYXBwaWQ6ICIxMjExMSIsCiAgLy8gbmFtZTogJ+WFqOWKn+iDvUFJ5byA5Y+R5bmz5Y+wJywKICBhcHBuYW1lOiAnYm1sJwp9LCB7CiAgYXBwaWQ6ICIxMjExMiIsCiAgLy8gbmFtZTogJ+aZuuaFp+WutuW6reWKqeaJiycsCiAgYXBwbmFtZTogJ2FpaG9tZScKfSwgewogIGFwcGlkOiAiMTIxMTMiLAogIC8vIG5hbWU6ICfmmbrmhaflrrbluq3liqnmiYst5a2p5a2Q56uvJywKICBhcHBuYW1lOiAnYWlob21lX2NoaWxkcmVuJwp9LCB7CiAgYXBwaWQ6ICIxMjExNCIsCiAgLy8gbmFtZTogJ+eZvuW6puaJi+acuuWNq+WjqycsCiAgYXBwbmFtZTogJ21vYnNlY3VyaXR5Jwp9LCB7CiAgYXBwaWQ6ICIxMjExNyIsCiAgLy8gbmFtZTogJ+eZvuW6pkFQUOWkp+Wtl+eJiCcsCiAgYXBwbmFtZTogJ3RvbWFzJwp9LCB7CiAgYXBwaWQ6ICIxMjExOCIsCiAgLy8gbmFtZTogJ2ZsdXR0ZXLkuK3lj7AnLAogIGFwcG5hbWU6ICdiYWlkdV9mbHV0dGVyJwp9LCB7CiAgYXBwaWQ6ICIxMjEyMCIsCiAgLy8gbmFtZTogJ+aSreWuoicsCiAgYXBwbmFtZTogJ3dlcG9kJwp9LCB7CiAgYXBwaWQ6ICIxMjEyMSIsCiAgLy8gbmFtZTogJ1lZ55u05pKtX+mdnueZvuW6picsCiAgYXBwbmFtZTogJ3l5Jwp9LCB7CiAgYXBwaWQ6ICIxMjEyMiIsCiAgLy8gbmFtZTogJ+iQjOaHguaVmeiCsicsCiAgYXBwbmFtZTogJ2tpZGVkdScKfSwgewogIGFwcGlkOiAiMTIxMjMiLAogIC8vIG5hbWU6ICfnvZHnm5jmnoHpgJ/niYgnLAogIGFwcG5hbWU6ICd3YW5ncGFuX2Zhc3RlcicKfSwgewogIGFwcGlkOiAiMTIxMjQiLAogIC8vIG5hbWU6ICfpmo/lo7AnLAogIGFwcG5hbWU6ICd3ZXBvZF9tb2JpbGUnCn0sIHsKICBhcHBpZDogIjEyMTI1IiwKICAvLyBuYW1lOiAn55m+5bqmVlLmlZnogrLmoYzpnaLlupTnlKgnLAogIGFwcG5hbWU6ICdiYWlkdV92cl9jbGFzc3Jvb21fbGF1bmNoZXInCn0sIHsKICBhcHBpZDogJzEyNDA3JywKICAvLyDlpb3nnIvmgKXpgJ/niYgKICBhcHBuYW1lOiAnYmRoa3ZpZGVvJwp9XTsKLyoqCiAqIOmAmui/h2FwcG5hbWXmiJbogIV1YeiOt+W+l+WvueW6lOeahGFwcGlkCiAqIEBwYXJhbSB7c3RyaW5nfSBbYXBwbmFtZV0g5Lyg5YWl55qEYXBwbmFtZQogKiBAbGluayBodHRwOi8vYXBwLmJhaWR1LWludC5jb20vY29uc29sZS9hcHBsaWNhdGlvbi9jbGllbnRsaXN0CiAqLwoKdmFyIGdldEFwcEJ5TmFtZSA9IGZ1bmN0aW9uIGdldEFwcEJ5TmFtZSgpIHsKICB2YXIgYXBwbmFtZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogJyc7CiAgdmFyIGRlZmF1bHRBcHAgPSB7CiAgICBhcHBuYW1lOiAnb3RoZXInLAogICAgYXBwaWQ6ICIxMjEzMyIKICB9OwoKICBpZiAoYXBwbmFtZSkgewogICAgdmFyIGl0ZW0gPSB1YVJlZ01hcC5maW5kKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgIHJldHVybiBhcHBuYW1lID09PSBpdGVtLmFwcG5hbWU7CiAgICB9KTsKICAgIHJldHVybiBpdGVtID8gaXRlbSA6IGRlZmF1bHRBcHA7CiAgfSBlbHNlIHsKICAgIHZhciB1YSA9IGdldFVhKCk7CgogICAgdmFyIF9pdGVtID0gdWFSZWdNYXAuZmluZChmdW5jdGlvbiAoaXRlbSkgewogICAgICBpZiAoaXRlbS5yZWcpIHsKICAgICAgICByZXR1cm4gaXRlbS5yZWcudGVzdCh1YSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIHVhLnNlYXJjaChpdGVtLmFwcG5hbWUpICE9PSAtMTsKICAgICAgfQogICAgfSk7CgogICAgcmV0dXJuIF9pdGVtID8gX2l0ZW0gOiBkZWZhdWx0QXBwOwogIH0KfTsKLyoqCiAqIEBmaWxlIE1lcmdlTG9nZ2VyCiAqCiAqIEBhdXRob3IgY2hhbmd5dXFpbmdAYmFpZHUuY29tCiAqLwoKCnZhciBNZXJnZUxvZ2dlciA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gTWVyZ2VMb2dnZXIoX3JlZikgewogICAgdmFyIF9yZWYkbG9nRm4gPSBfcmVmLmxvZ0ZuLAogICAgICAgIGxvZ0ZuID0gX3JlZiRsb2dGbiA9PT0gdm9pZCAwID8gZnVuY3Rpb24gKCkge30gOiBfcmVmJGxvZ0ZuOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBNZXJnZUxvZ2dlcik7CgogICAgdGhpcy5sb2dGbiA9IGxvZ0ZuOwogICAgdGhpcy5sb2dBcnJheSA9IFtdOwogICAgdGhpcy5tZXJnZU51bU1heCA9IDU7CiAgICB0aGlzLm1lcmdlSW50ZXJ2YWwgPSA1OwogICAgdGhpcy50aW1lSWQgPSBudWxsOwogIH0KCiAgX2NyZWF0ZUNsYXNzKE1lcmdlTG9nZ2VyLCBbewogICAga2V5OiAic2V0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXQoX3JlZjIpIHsKICAgICAgdmFyIG1lcmdlTnVtTWF4ID0gX3JlZjIubWVyZ2VOdW1NYXgsCiAgICAgICAgICBtZXJnZUludGVydmFsID0gX3JlZjIubWVyZ2VJbnRlcnZhbDsKCiAgICAgIGlmIChtZXJnZU51bU1heCkgewogICAgICAgIHRoaXMubWVyZ2VOdW1NYXggPSBtZXJnZU51bU1heDsKICAgICAgfQoKICAgICAgaWYgKG1lcmdlSW50ZXJ2YWwpIHsKICAgICAgICB0aGlzLm1lcmdlSW50ZXJ2YWwgPSBtZXJnZUludGVydmFsOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAiYWRkIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBhZGQobG9nRGF0YSkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdGhpcy5sb2dBcnJheS5wdXNoKGxvZ0RhdGEpOwoKICAgICAgaWYgKHRoaXMubG9nQXJyYXkubGVuZ3RoID09PSAxKSB7CiAgICAgICAgLy8g5aaC5p6c5piv6L+b5YWl6Zif5YiX55qE56ys5LiA5Liq5pel5b+X77yM5q2k5pe25byA5ZCv5LiA5Liq5a6a5pe25ZmoCiAgICAgICAgdGhpcy50aW1lSWQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgIF90aGlzLmNsZWFyQWxsKCk7CiAgICAgICAgfSwgdGhpcy5tZXJnZUludGVydmFsICogMTAwMCk7CiAgICAgIH0gZWxzZSBpZiAodGhpcy5sb2dBcnJheS5sZW5ndGggPj0gdGhpcy5tZXJnZU51bU1heCkgewogICAgICAgIC8vIOWmguaenOi/m+WFpemYn+WIl+eahOaXpeW/l+S4quaVsOi+vuWIsOS4iumZkO+8jOWwseebtOaOpeWPkemAgQogICAgICAgIHRoaXMuY2xlYXJBbGwoKTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogImNsZWFyQWxsIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjbGVhckFsbCgpIHsKICAgICAgaWYgKHRoaXMubG9nQXJyYXkubGVuZ3RoID4gMCkgewogICAgICAgIC8vIOWmguaenOmYn+WIl+mHjOmdouWtmOWcqOW+heWPkemAgeeahOaXpeW/l++8jOiwg+eUqOWPkemAgeWHveaVsOi/m+ihjOWPkemAgQogICAgICAgIHRoaXMubG9nRm4odGhpcy5sb2dBcnJheSk7IC8vIOa4heepuuaXpeW/l+mYn+WIlwoKICAgICAgICB0aGlzLmxvZ0FycmF5ID0gW107CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLnRpbWVJZCkgewogICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnRpbWVJZCk7CiAgICAgICAgdGhpcy50aW1lSWQgPSBudWxsOwogICAgICB9CiAgICB9CiAgfV0pOwoKICByZXR1cm4gTWVyZ2VMb2dnZXI7Cn0oKTsKLyoqCiAqIEBmaWxlIFRpbWVMb2dnZXIKICoKICogQGF1dGhvciBjaGFuZ3l1cWluZ0BiYWlkdS5jb20KICovCgoKdmFyIFRpbWVMb2dnZXIgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIC8qKgogICAqIEBjb25zdHJ1Y3RvciBUaW1lTG9nZ2VyCiAgICogQHBhcmFtICB7T2JqZWN0fSBbb3B0aW9uc10gIOaJk+eCueiuvue9ru+8jOimhuebluWFqOWxgOiuvue9rgogICAqIEBwYXJhbSAge2Jvb2xlYW59IFtvcHRpb25zLmlmSGVhcnRiZWF0VGltZV0gIOaYr+WQpumAmui/h+W/g+i3s+aJk+eCuQogICAqIEBwYXJhbSAge251bWJlcn0gW29wdGlvbnMuZHVyYXRpb25dICDlv4Pot7PmiZPngrnnmoTpl7TpmpTvvIzljZXkvY1zCiAgICogQHBhcmFtICB7RnVuY3Rpb259IFtvcHRpb25zLmxvZ0ZuXSAg5ZCR5aSW5oqb5LqL5Lu255qE5Ye95pWwCiAgICovCiAgZnVuY3Rpb24gVGltZUxvZ2dlcihfcmVmKSB7CiAgICB2YXIgX3JlZiRpZkhlYXJ0YmVhdFRpbWUgPSBfcmVmLmlmSGVhcnRiZWF0VGltZSwKICAgICAgICBpZkhlYXJ0YmVhdFRpbWUgPSBfcmVmJGlmSGVhcnRiZWF0VGltZSA9PT0gdm9pZCAwID8gdHJ1ZSA6IF9yZWYkaWZIZWFydGJlYXRUaW1lLAogICAgICAgIF9yZWYkZHVyYXRpb24gPSBfcmVmLmR1cmF0aW9uLAogICAgICAgIGR1cmF0aW9uID0gX3JlZiRkdXJhdGlvbiA9PT0gdm9pZCAwID8gMyA6IF9yZWYkZHVyYXRpb24sCiAgICAgICAgX3JlZiRsb2dGbiA9IF9yZWYubG9nRm4sCiAgICAgICAgbG9nRm4gPSBfcmVmJGxvZ0ZuID09PSB2b2lkIDAgPyBmdW5jdGlvbiAoKSB7fSA6IF9yZWYkbG9nRm47CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFRpbWVMb2dnZXIpOwoKICAgIHRoaXMuc3RhcnR0aW1lID0gRGF0ZS5ub3coKTsgLy8g5byA5aeL5pe26Ze0CgogICAgdGhpcy5pZkhlYXJ0YmVhdFRpbWUgPSBpZkhlYXJ0YmVhdFRpbWU7IC8vIOaYr+WQpuW/g+i3s+aJk+eCuQoKICAgIHRoaXMubG9nRm4gPSBsb2dGbjsgLy8g5omT54K55pa55rOVCgogICAgdGhpcy5pbnRlcnZhbElkID0gbnVsbDsKICAgIHRoaXMuZHVyYXRpb24gPSBkdXJhdGlvbjsKICAgIHRoaXMuZmxhZyA9ICdTVE9QJzsgLy8g54q25oCB5pyJIFJVTk5JTkcgU1RPUCBBVVRPX1NUT1AKICB9CgogIF9jcmVhdGVDbGFzcyhUaW1lTG9nZ2VyLCBbewogICAga2V5OiAic2VuZExvZyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2VuZExvZygpIHsKICAgICAgaWYgKHRoaXMuaWZIZWFydGJlYXRUaW1lKSB7CiAgICAgICAgdGhpcy5sb2dGbih7CiAgICAgICAgICBzdGFydHRpbWU6IHRoaXMuc3RhcnR0aW1lLAogICAgICAgICAgZHVyYXRpb246IHRoaXMuZHVyYXRpb24KICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICB2YXIgZW5kdGltZSA9IERhdGUubm93KCk7CiAgICAgICAgdGhpcy5sb2dGbih7CiAgICAgICAgICBzdGFydHRpbWU6IHRoaXMuc3RhcnR0aW1lLAogICAgICAgICAgZHVyYXRpb246IChlbmR0aW1lIC0gdGhpcy5zdGFydHRpbWUpIC8gMTAwMCwKICAgICAgICAgIGVuZHRpbWU6IGVuZHRpbWUKICAgICAgICB9KTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogInN0YXJ0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzdGFydCgpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIGlmICh0aGlzLmZsYWcgIT09ICdSVU5OSU5HJykgewogICAgICAgIHRoaXMuZmxhZyA9ICdSVU5OSU5HJzsKICAgICAgICB0aGlzLnN0YXJ0dGltZSA9IERhdGUubm93KCk7CgogICAgICAgIGlmICh0aGlzLmlmSGVhcnRiZWF0VGltZSkgewogICAgICAgICAgdGhpcy5zZW5kTG9nKCk7CiAgICAgICAgICB0aGlzLmludGVydmFsSWQgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIF90aGlzLnNlbmRMb2coKTsKICAgICAgICAgIH0sIHRoaXMuZHVyYXRpb24gKiAxMDAwKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJzdG9wIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzdG9wKCkgewogICAgICBpZiAodGhpcy5mbGFnID09PSAnUlVOTklORycpIHsKICAgICAgICBpZiAodGhpcy5pZkhlYXJ0YmVhdFRpbWUpIHsKICAgICAgICAgIHRoaXMuc2VuZExvZygpOwogICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmludGVydmFsSWQpOwogICAgICAgICAgdGhpcy5pbnRlcnZhbElkID0gbnVsbDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5zZW5kTG9nKCk7CiAgICAgICAgfQoKICAgICAgICB0aGlzLmZsYWcgPSAnU1RPUCc7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJhdXRvU3RvcCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gYXV0b1N0b3AoKSB7CiAgICAgIGlmICh0aGlzLmZsYWcgPT09ICdSVU5OSU5HJykgewogICAgICAgIHRoaXMuc3RvcCgpOwogICAgICAgIHRoaXMuZmxhZyA9ICdBVVRPX1NUT1AnOwogICAgICB9CiAgICB9CiAgfV0pOwoKICByZXR1cm4gVGltZUxvZ2dlcjsKfSgpOwovKioKICogQGZpbGUg5omT54K56YeN6K+V5py65Yi2CiAqIEBhdXRob3IgY2hhbmd5dXFpbmdAYmFpZHUuY29tCiAqCiAqLwoKCnZhciBtYXhTdG9yYWdlTGVuZ3RoID0gNTsKdmFyIGlzU3RvcmFnZUluaXQgPSBmYWxzZTsKdmFyIG9yaWdpbiA9ICcnOwp2YXIgcmV0cnlMb2dMaXN0cyA9IG51bGw7CgpmdW5jdGlvbiBzZXRTdG9yYWdlKHZhbHVlKSB7CiAgaWYgKCFpc1N0b3JhZ2VJbml0KSB7CiAgICBnZXRTdG9yYWdlKCk7CiAgfQoKICB2YXIgbm93ID0gRGF0ZS5ub3coKTsKCiAgaWYgKCFyZXRyeUxvZ0xpc3RzW29yaWdpbl0pIHsKICAgIC8vIHJldHJ5TG9nTGlzdHMg5Lit5LiN5a2Y5Zyo5b2T5YmN6aG16Z2i5a+55bqU55qE5YiX6KGoCiAgICAvLyDlpoLmnpxyZXRyeUxvZ0xpc3Rz6YeM6Z2i5a2Y5pS+6L+H5aSa77yM5YiZ5Yig6Zmk5pyA5pen55qE6K6w5b2VCiAgICBpZiAocmV0cnlMb2dMaXN0cy5sZW5ndGggPj0gbWF4U3RvcmFnZUxlbmd0aCkgewogICAgICB2YXIgcGF0aCA9IE9iamVjdC5rZXlzKHJldHJ5TG9nTGlzdHMpLnJlZHVjZShmdW5jdGlvbiAocHJlLCBjdXIpIHsKICAgICAgICBpZiAocmV0cnlMb2dMaXN0c1tjdXJdICE9PSAnbGVuZ3RoJyAmJiByZXRyeUxvZ0xpc3RzW2N1cl0udGltZSA8PSBwcmUudGltZSkgewogICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgdGltZTogcmV0cnlMb2dMaXN0c1tjdXJdLnRpbWUsCiAgICAgICAgICAgIHBhdGg6IGN1cgogICAgICAgICAgfTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBwcmU7CiAgICAgIH0sIHsKICAgICAgICB0aW1lOiBub3csCiAgICAgICAgcGF0aDogJycKICAgICAgfSkucGF0aDsKICAgICAgZGVsZXRlIHJldHJ5TG9nTGlzdHNbcGF0aF07CiAgICB9IGVsc2UgewogICAgICByZXRyeUxvZ0xpc3RzLmxlbmd0aCsrOwogICAgfQogIH0KCiAgcmV0cnlMb2dMaXN0c1tvcmlnaW5dID0gewogICAgbGlzdDogdmFsdWUsCiAgICB0aW1lOiBub3cKICB9OwogIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdSRVRSWV9MT0dfTElTVCcsIEpTT04uc3RyaW5naWZ5KHJldHJ5TG9nTGlzdHMpKTsKfQoKZnVuY3Rpb24gY2xlYXJTdG9yYWdlKCkgewogIGlmICghaXNTdG9yYWdlSW5pdCkgewogICAgZ2V0U3RvcmFnZSgpOwogIH0KCiAgaWYgKHJldHJ5TG9nTGlzdHNbb3JpZ2luXSkgewogICAgZGVsZXRlIHJldHJ5TG9nTGlzdHNbb3JpZ2luXTsKICAgIHJldHJ5TG9nTGlzdHMubGVuZ3RoLS07CiAgfQoKICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnUkVUUllfTE9HX0xJU1QnLCBKU09OLnN0cmluZ2lmeShyZXRyeUxvZ0xpc3RzKSk7Cn0KCmZ1bmN0aW9uIGdldFN0b3JhZ2UoKSB7CiAgdmFyIF9yZXRyeUxvZ0xpc3RzJG9yaWdpbjsKCiAgaWYgKCFpc1N0b3JhZ2VJbml0KSB7CiAgICBpc1N0b3JhZ2VJbml0ID0gdHJ1ZTsKICAgIG9yaWdpbiA9IGdldExvY2F0aW9uKCkub3JpZ2luICsgZ2V0TG9jYXRpb24oKS5wYXRobmFtZTsKICB9CgogIHRyeSB7CiAgICByZXRyeUxvZ0xpc3RzID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnUkVUUllfTE9HX0xJU1QnKSkgfHwgewogICAgICBsZW5ndGg6IDAKICAgIH07CiAgfSBjYXRjaCAoZSkgewogICAgcmV0cnlMb2dMaXN0cyA9IHsKICAgICAgbGVuZ3RoOiAwCiAgICB9OwogIH0KCiAgcmV0dXJuICgoX3JldHJ5TG9nTGlzdHMkb3JpZ2luID0gcmV0cnlMb2dMaXN0c1tvcmlnaW5dKSA9PT0gbnVsbCB8fCBfcmV0cnlMb2dMaXN0cyRvcmlnaW4gPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9yZXRyeUxvZ0xpc3RzJG9yaWdpbi5saXN0KSB8fCBbXTsKfQoKdmFyIFJldHJ5TG9nZ2VyID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBSZXRyeUxvZ2dlcihfcmVmKSB7CiAgICB2YXIgX3JlZiRsb2dGbiA9IF9yZWYubG9nRm4sCiAgICAgICAgbG9nRm4gPSBfcmVmJGxvZ0ZuID09PSB2b2lkIDAgPyBmdW5jdGlvbiAoKSB7fSA6IF9yZWYkbG9nRm47CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFJldHJ5TG9nZ2VyKTsKCiAgICB0aGlzLmxvZ0ZuID0gbG9nRm47CiAgICB0aGlzLnJldHJ5TG9nTGlzdCA9IHRoaXMuX2dldEluaXRFcnJMb2dzKCk7CiAgICB0aGlzLnJldHJ5VGltZXNNYXggPSAzOyAvLyDmnIDlpKfph43lj5HmrKHmlbAKCiAgICB0aGlzLnJldHJ5TG9nTGlzdE1heCA9IDU7IC8vIOmHjeivlemYn+WIl+acgOWkp+mVv+W6pgoKICAgIHRoaXMuX3JldHJ5SW50ZXJ2YWxUaW1lciA9IG51bGw7CiAgfSAvLyDku45zdG9yYWdl5Lit6K+75Y+W6YGX55WZ55qE5pel5b+XCgoKICBfY3JlYXRlQ2xhc3MoUmV0cnlMb2dnZXIsIFt7CiAgICBrZXk6ICJfZ2V0SW5pdEVyckxvZ3MiLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9nZXRJbml0RXJyTG9ncygpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHZhciBsb2dzID0gZ2V0U3RvcmFnZSgpOwogICAgICByZXR1cm4gbmV3IE1hcChsb2dzLm1hcChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgIHJldHVybiBbaXRlbVswXSwgX29iamVjdFNwcmVhZDIoX29iamVjdFNwcmVhZDIoe30sIGl0ZW1bMV0pLCB7fSwgewogICAgICAgICAgZmFpbFRpbWVzOiAxLAogICAgICAgICAgc2VuZENvdW50RG93bjogX3RoaXMuX2dldERlbGF5VGltZShpdGVtLmZhaWxUaW1lcykKICAgICAgICB9KV07CiAgICAgIH0pKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJfZ2V0RGVsYXlUaW1lIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfZ2V0RGVsYXlUaW1lKGZhaWxUaW1lcykgewogICAgICAvLyDlu7bov5/ph43lj5Hml7bpl7TnmoTphY3nva7jgILov57nu63lpLHotKXmrKHmlbDotorlpJrvvIzlj5HpgIHlu7bov5/otorkuYUKICAgICAgdmFyIHRpbWVNYXAgPSB7CiAgICAgICAgMDogMSwKICAgICAgICAvLyBzCiAgICAgICAgMTogMSwKICAgICAgICAyOiA1CiAgICAgIH07CiAgICAgIHJldHVybiB0aW1lTWFwW2ZhaWxUaW1lc10gfHwgMTAgKyBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA1ICsgMSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiYWN0aXZlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBhY3RpdmUoKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgaWYgKCF0aGlzLl9yZXRyeUludGVydmFsVGltZXIgJiYgdGhpcy5yZXRyeUxvZ0xpc3Quc2l6ZSA+IDApIHsKICAgICAgICB0aGlzLl9yZXRyeUludGVydmFsVGltZXIgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7CiAgICAgICAgICBfdGhpczIuX3JldHJ5SW50ZXJ2YWxUaW1lckhhbmRsZXIoKTsKICAgICAgICB9LCAxMDAwKTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogImFkZExvZyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gYWRkTG9nKF9yZWYyKSB7CiAgICAgIHZhciB1cmwgPSBfcmVmMi51cmwsCiAgICAgICAgICBsb2dnZXJEYXRhID0gX3JlZjIubG9nZ2VyRGF0YSwKICAgICAgICAgIGxvZ2dlcklkID0gX3JlZjIubG9nZ2VySWQ7CiAgICAgIHRoaXMucmV0cnlMb2dMaXN0LnNldChsb2dnZXJJZCwgewogICAgICAgIHVybDogdXJsLAogICAgICAgIGxvZ2dlckRhdGE6IGxvZ2dlckRhdGEsCiAgICAgICAgbG9nZ2VySWQ6IGxvZ2dlcklkLAogICAgICAgIGZhaWxUaW1lczogMSwKICAgICAgICBzZW5kQ291bnREb3duOiB0aGlzLl9nZXREZWxheVRpbWUoMSkKICAgICAgfSk7IC8vIOi2heWHuuacgOWkp+mVv+W6puaXtiDlj5blh7rpmJ/liJfkuK3mnIDkuYXnmoTkuIDmnaEKCiAgICAgIGlmICh0aGlzLnJldHJ5TG9nTGlzdC5zaXplID4gdGhpcy5yZXRyeUxvZ0xpc3RNYXgpIHsKICAgICAgICB2YXIga2V5ID0gdGhpcy5yZXRyeUxvZ0xpc3Qua2V5cygpLm5leHQoKS52YWx1ZTsKICAgICAgICB0aGlzLnJldHJ5TG9nTGlzdFsiZGVsZXRlIl0oa2V5KTsKICAgICAgfQoKICAgICAgdGhpcy5hY3RpdmUoKTsgLy8g5oqK5pu05paw55qE5pWw5o2u5pu05paw5Yiw5pys5Zyw5a2Y5YKoCgogICAgICBzZXRTdG9yYWdlKEFycmF5LmZyb20odGhpcy5yZXRyeUxvZ0xpc3QpKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZW1vdmVMb2ciLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZUxvZyhsb2dnZXJJZCkgewogICAgICBpZiAoIWxvZ2dlcklkKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAodGhpcy5yZXRyeUxvZ0xpc3RbImRlbGV0ZSJdKGxvZ2dlcklkKSkgewogICAgICAgIGlmICh0aGlzLnJldHJ5TG9nTGlzdC5zaXplID09PSAwKSB7CiAgICAgICAgICBjbGVhclN0b3JhZ2UoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgLy8g5pu05paw5pys5Zyw57yT5a2YCiAgICAgICAgICBzZXRTdG9yYWdlKHRoaXMucmV0cnlMb2dMaXN0KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJ1cGRhdGVMb2ciLAogICAgdmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZUxvZyhsb2dnZXJJZCkgewogICAgICBpZiAoIWxvZ2dlcklkKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB2YXIgaXRlbSA9IHRoaXMucmV0cnlMb2dMaXN0LmdldChsb2dnZXJJZCk7CgogICAgICBpZiAoaXRlbSkgewogICAgICAgIHZhciBjdXJGYWlsVGltZXMgPSBpdGVtLmZhaWxUaW1lczsgLy8g5aaC5p6c6LaF6L+H5pyA5aSn6YeN6K+V5qyh5pWwIOWImeS4jeWGjemHjeWPkSDku47pmJ/liJfkuK3liKDpmaQKCiAgICAgICAgaWYgKGN1ckZhaWxUaW1lcyArIDEgPiB0aGlzLnJldHJ5VGltZXNNYXgpIHsKICAgICAgICAgIHRoaXMucmVtb3ZlTG9nKGxvZ2dlcklkKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgaXRlbS5mYWlsVGltZXMgPSBjdXJGYWlsVGltZXMgKyAxOwogICAgICAgICAgaXRlbS5zZW5kQ291bnREb3duID0gdGhpcy5fZ2V0RGVsYXlUaW1lKGl0ZW0uZmFpbFRpbWVzKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJfcmV0cnlJbnRlcnZhbFRpbWVySGFuZGxlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX3JldHJ5SW50ZXJ2YWxUaW1lckhhbmRsZXIoKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgdGhpcy5yZXRyeUxvZ0xpc3QuZm9yRWFjaChmdW5jdGlvbiAobG9nSXRlbSkgewogICAgICAgIC8vIOWAkuiuoeaXtuS4ui0x5pe2IOihqOekuuivpeadoeaXpeW/l+ato+WcqOiiq+mHjeaWsOWPkemAgQogICAgICAgIGlmIChsb2dJdGVtLnNlbmRDb3VudERvd24gPCAwKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfSBlbHNlIGlmICgrbG9nSXRlbS5zZW5kQ291bnREb3duID09PSAwKSB7CiAgICAgICAgICAvLyDlgJLorqHml7blt7LliLAg5omn6KGM5YaN5qyh5Y+R6YCBCiAgICAgICAgICBsb2dJdGVtLnNlbmRDb3VudERvd24gPSAtMTsgLy8g6K6+572u5YW25q2j5Zyo5pa55rOVCgogICAgICAgICAgX3RoaXMzLl9zZW5kTG9nKGxvZ0l0ZW0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAvLyDlgJLorqHml7borqHml7YgLTEKICAgICAgICAgIGxvZ0l0ZW0uc2VuZENvdW50RG93biA9IGxvZ0l0ZW0uc2VuZENvdW50RG93biAtIDE7CiAgICAgICAgfQogICAgICB9KTsKCiAgICAgIGlmICh0aGlzLnJldHJ5TG9nTGlzdC5zaXplID09PSAwKSB7CiAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLl9yZXRyeUludGVydmFsVGltZXIpOwogICAgICAgIHRoaXMuX3JldHJ5SW50ZXJ2YWxUaW1lciA9IG51bGw7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJfc2VuZExvZyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX3NlbmRMb2cobG9nSXRlbSkgewogICAgICB2YXIgX3RoaXM0ID0gdGhpczsKCiAgICAgIHRoaXMubG9nRm4obG9nSXRlbS51cmwsIGxvZ0l0ZW0ubG9nZ2VyRGF0YSkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgX3RoaXM0LnJlbW92ZUxvZyhsb2dJdGVtLmxvZ2dlcklkKTsKICAgICAgfSlbImNhdGNoIl0oZnVuY3Rpb24gKCkgewogICAgICAgIF90aGlzNC51cGRhdGVMb2cobG9nSXRlbS5sb2dnZXJJZCk7CiAgICAgIH0pOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIFJldHJ5TG9nZ2VyOwp9KCk7Ci8qKgogKiBAZmlsZSBzaGEyNTYg566A5YyW55qEc2hhMjU2566X5rOVCiAqIEBhdXRob3IgZ2VyYWludGx1ZmYKICogQGxpbmsgaHR0cHM6Ly9naXRodWIuY29tL2dlcmFpbnRsdWZmL3NoYTI1NgogKi8KCgp2YXIgc2hhMjU2ID0gZnVuY3Rpb24gc2hhMjU2KGFzY2lpKSB7CiAgZnVuY3Rpb24gcmlnaHRSb3RhdGUodmFsdWUsIGFtb3VudCkgewogICAgcmV0dXJuIHZhbHVlID4+PiBhbW91bnQgfCB2YWx1ZSA8PCAzMiAtIGFtb3VudDsKICB9CgogIHZhciBtYXhXb3JkID0gTWF0aC5wb3coMiwgMzIpOwogIHZhciBsZW5ndGhQcm9wZXJ0eSA9ICdsZW5ndGgnOwogIHZhciBpLCBqOyAvLyBVc2VkIGFzIGEgY291bnRlciBhY3Jvc3MgdGhlIHdob2xlIGZpbGUKCiAgdmFyIHJlc3VsdCA9ICcnOwogIHZhciB3b3JkcyA9IFtdOwogIHZhciBhc2NpaUJpdExlbmd0aCA9IGFzY2lpW2xlbmd0aFByb3BlcnR5XSAqIDg7IC8vKiBjYWNoaW5nIHJlc3VsdHMgaXMgb3B0aW9uYWwgLSByZW1vdmUvYWRkIHNsYXNoIGZyb20gZnJvbnQgb2YgdGhpcyBsaW5lIHRvIHRvZ2dsZQogIC8vIEluaXRpYWwgaGFzaCB2YWx1ZTogZmlyc3QgMzIgYml0cyBvZiB0aGUgZnJhY3Rpb25hbCBwYXJ0cyBvZiB0aGUgc3F1YXJlIHJvb3RzIG9mIHRoZSBmaXJzdCA4IHByaW1lcwogIC8vICh3ZSBhY3R1YWxseSBjYWxjdWxhdGUgdGhlIGZpcnN0IDY0LCBidXQgZXh0cmEgdmFsdWVzIGFyZSBqdXN0IGlnbm9yZWQpCgogIHZhciBoYXNoID0gc2hhMjU2LmggPSBzaGEyNTYuaCB8fCBbXTsgLy8gUm91bmQgY29uc3RhbnRzOiBmaXJzdCAzMiBiaXRzIG9mIHRoZSBmcmFjdGlvbmFsIHBhcnRzIG9mIHRoZSBjdWJlIHJvb3RzIG9mIHRoZSBmaXJzdCA2NCBwcmltZXMKCiAgdmFyIGsgPSBzaGEyNTYuayA9IHNoYTI1Ni5rIHx8IFtdOwogIHZhciBwcmltZUNvdW50ZXIgPSBrW2xlbmd0aFByb3BlcnR5XTsKICAvKi8KICAgdmFyIGhhc2ggPSBbXSwgayA9IFtdOwogICB2YXIgcHJpbWVDb3VudGVyID0gMDsKICAgLy8qLwoKICB2YXIgaXNDb21wb3NpdGUgPSB7fTsKCiAgZm9yICh2YXIgY2FuZGlkYXRlID0gMjsgcHJpbWVDb3VudGVyIDwgNjQ7IGNhbmRpZGF0ZSsrKSB7CiAgICBpZiAoIWlzQ29tcG9zaXRlW2NhbmRpZGF0ZV0pIHsKICAgICAgZm9yIChpID0gMDsgaSA8IDMxMzsgaSArPSBjYW5kaWRhdGUpIHsKICAgICAgICBpc0NvbXBvc2l0ZVtpXSA9IGNhbmRpZGF0ZTsKICAgICAgfQoKICAgICAgaGFzaFtwcmltZUNvdW50ZXJdID0gTWF0aC5wb3coY2FuZGlkYXRlLCAuNSkgKiBtYXhXb3JkIHwgMDsKICAgICAga1twcmltZUNvdW50ZXIrK10gPSBNYXRoLnBvdyhjYW5kaWRhdGUsIDEgLyAzKSAqIG1heFdvcmQgfCAwOwogICAgfQogIH0KCiAgYXNjaWkgKz0gJ1x4ODAnOyAvLyBBcHBlbmQgxocnIGJpdCAocGx1cyB6ZXJvIHBhZGRpbmcpCgogIHdoaWxlIChhc2NpaVtsZW5ndGhQcm9wZXJ0eV0gJSA2NCAtIDU2KSB7CiAgICBhc2NpaSArPSAnXHgwMCc7CiAgfSAvLyBNb3JlIHplcm8gcGFkZGluZwoKCiAgZm9yIChpID0gMDsgaSA8IGFzY2lpW2xlbmd0aFByb3BlcnR5XTsgaSsrKSB7CiAgICBqID0gYXNjaWkuY2hhckNvZGVBdChpKTsKICAgIGlmIChqID4+IDgpIHJldHVybjsgLy8gQVNDSUkgY2hlY2s6IG9ubHkgYWNjZXB0IGNoYXJhY3RlcnMgaW4gcmFuZ2UgMC0yNTUKCiAgICB3b3Jkc1tpID4+IDJdIHw9IGogPDwgKDMgLSBpKSAlIDQgKiA4OwogIH0KCiAgd29yZHNbd29yZHNbbGVuZ3RoUHJvcGVydHldXSA9IGFzY2lpQml0TGVuZ3RoIC8gbWF4V29yZCB8IDA7CiAgd29yZHNbd29yZHNbbGVuZ3RoUHJvcGVydHldXSA9IGFzY2lpQml0TGVuZ3RoOyAvLyBwcm9jZXNzIGVhY2ggY2h1bmsKCiAgZm9yIChqID0gMDsgaiA8IHdvcmRzW2xlbmd0aFByb3BlcnR5XTspIHsKICAgIHZhciB3ID0gd29yZHMuc2xpY2UoaiwgaiArPSAxNik7IC8vIFRoZSBtZXNzYWdlIGlzIGV4cGFuZGVkIGludG8gNjQgd29yZHMgYXMgcGFydCBvZiB0aGUgaXRlcmF0aW9uCgogICAgdmFyIG9sZEhhc2ggPSBoYXNoOyAvLyBUaGlzIGlzIG5vdyB0aGUgdW5kZWZpbmVkIHdvcmtpbmcgaGFzaCIsIG9mdGVuIGxhYmVsbGVkIGFzIHZhcmlhYmxlcyBhLi4uZwogICAgLy8gKHdlIGhhdmUgdG8gdHJ1bmNhdGUgYXMgd2VsbCwgb3RoZXJ3aXNlIGV4dHJhIGVudHJpZXMgYXQgdGhlIGVuZCBhY2N1bXVsYXRlCgogICAgaGFzaCA9IGhhc2guc2xpY2UoMCwgOCk7CgogICAgZm9yIChpID0gMDsgaSA8IDY0OyBpKyspIHsKICAgICAgLy8gbGV0IGkyID0gaSArIGo7CiAgICAgIC8vIEV4cGFuZCB0aGUgbWVzc2FnZSBpbnRvIDY0IHdvcmRzCiAgICAgIC8vIFVzZWQgYmVsb3cgaWYKICAgICAgdmFyIHcxNSA9IHdbaSAtIDE1XSwKICAgICAgICAgIHcyID0gd1tpIC0gMl07IC8vIEl0ZXJhdGUKCiAgICAgIHZhciBhID0gaGFzaFswXSwKICAgICAgICAgIGUgPSBoYXNoWzRdOwogICAgICB2YXIgdGVtcDEgPSBoYXNoWzddICsgKHJpZ2h0Um90YXRlKGUsIDYpIF4gcmlnaHRSb3RhdGUoZSwgMTEpIF4gcmlnaHRSb3RhdGUoZSwgMjUpKSAvLyBTMQogICAgICArIChlICYgaGFzaFs1XSBeIH5lICYgaGFzaFs2XSkgLy8gY2gKICAgICAgKyBrW2ldIC8vIEV4cGFuZCB0aGUgbWVzc2FnZSBzY2hlZHVsZSBpZiBuZWVkZWQKICAgICAgKyAod1tpXSA9IGkgPCAxNiA/IHdbaV0gOiB3W2kgLSAxNl0gKyAocmlnaHRSb3RhdGUodzE1LCA3KSBeIHJpZ2h0Um90YXRlKHcxNSwgMTgpIF4gdzE1ID4+PiAzKSAvLyBzMAogICAgICArIHdbaSAtIDddICsgKHJpZ2h0Um90YXRlKHcyLCAxNykgXiByaWdodFJvdGF0ZSh3MiwgMTkpIF4gdzIgPj4+IDEwKSAvLyBzMQogICAgICB8IDApOyAvLyBUaGlzIGlzIG9ubHkgdXNlZCBvbmNlLCBzbyAqY291bGQqIGJlIG1vdmVkIGJlbG93LCBidXQgaXQgb25seSBzYXZlcyA0IGJ5dGVzIGFuZCBtYWtlcyB0aGluZ3MgdW5yZWFkYmxlCgogICAgICB2YXIgdGVtcDIgPSAocmlnaHRSb3RhdGUoYSwgMikgXiByaWdodFJvdGF0ZShhLCAxMykgXiByaWdodFJvdGF0ZShhLCAyMikgLy8gUzAKICAgICAgKSArIChhICYgaGFzaFsxXSBeIGEgJiBoYXNoWzJdIF4gaGFzaFsxXSAmIGhhc2hbMl0pOyAvLyBtYWoKCiAgICAgIGhhc2ggPSBbdGVtcDEgKyB0ZW1wMiB8IDBdLmNvbmNhdChoYXNoKTsgLy8gV2UgZG9uJ3QgYm90aGVyIHRyaW1taW5nIG9mZiB0aGUgZXh0cmEgb25lcywgdGhleSdyZSBoYXJtbGVzcyBhcyBsb25nIGFzIHdlJ3JlIHRydW5jYXRpbmcgd2hlbiB3ZSBkbyB0aGUgc2xpY2UoKQoKICAgICAgaGFzaFs0XSA9IGhhc2hbNF0gKyB0ZW1wMSB8IDA7CiAgICB9CgogICAgZm9yIChpID0gMDsgaSA8IDg7IGkrKykgewogICAgICBoYXNoW2ldID0gaGFzaFtpXSArIG9sZEhhc2hbaV0gfCAwOwogICAgfQogIH0KCiAgZm9yIChpID0gMDsgaSA8IDg7IGkrKykgewogICAgZm9yIChqID0gMzsgaiArIDE7IGotLSkgewogICAgICB2YXIgYiA9IGhhc2hbaV0gPj4gaiAqIDggJiAyNTU7CiAgICAgIHJlc3VsdCArPSAoYiA8IDE2ID8gMCA6ICcnKSArIGIudG9TdHJpbmcoMTYpOwogICAgfQogIH0KCiAgcmV0dXJuIHJlc3VsdDsKfTsKCmZ1bmN0aW9uIGludm9rZUJ5SWZyYW1lKHNjaGVtYSkgewogIHZhciBub2RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaWZyYW1lJyk7IC8vIHRzbGludDpkaXNhYmxlLWxpbmUKCiAgbm9kZS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogIG5vZGUuc3JjID0gc2NoZW1hOwogIHZhciBib2R5ID0gZG9jdW1lbnQuYm9keTsKICBib2R5LmFwcGVuZENoaWxkKG5vZGUpOyAvLyDplIDmr4EgaWZyYW1lCgogIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgYm9keS5yZW1vdmVDaGlsZChub2RlKTsKICAgIG5vZGUgPSBudWxsOwogIH0sIDApOwp9Ci8qKgogKiBAZmlsZSBBcHDngbDluqbljIXliKTmlq0g77yI6ZmQ5omL55m+77yJCiAqIEBhdXRob3IgbGl1eWFxaWFuMDIgPGxpdXlhcWlhbjAyQGJhaWR1LmNvbT4KICovCgoKdmFyIExPV19FWElTVCA9IHsKICBzdGF0dXM6IDEwMSwKICBtZXNzYWdlOiAn6K+l54mI5pys5LiN5pSv5oyB5q2k56uv6IO95YqbJwp9OwovKioKICogQHNlZSBodHRwOi8vZXMuYmFpZHUtaW50LmNvbS8jL2FwaWRldGFpbC8xODA5CiAqIEByZXNvbHZlIHtPYmplY3R9IGRhdGEg56uv6L+U5Zue55qEZGF0YeWPguaVsAogKiBAcmVzb2x2ZSB7U3RyaW5nfSBkYXRhLmlzQmF0YSDmmK/lkKbkuLrngbDluqbljIUgdHJ1ZXxmYWxzZQogKgogKiBAcmVqZWN0IHtPYmplY3R9IHJlamVjdERhdGEg56uv6L+U5Zue55qE5aSx6LSl5Zue6LCD5L+h5oGvCiAqIEByZWplY3Qge1N0cmluZ30gcmVqZWN0RGF0YS5zdGF0dXMg5aSx6LSl54q25oCB56CBCiAqIEByZWplY3Qge1N0cmluZ30gcmVqZWN0RGF0YS5tZXNzYWdlIOWksei0peivtOaYjgogKi8KCmZ1bmN0aW9uIGlzQmV0YSgpIHsKICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgdmFyIHVhID0gZ2V0VWEoKTsKICAgIHZhciBtYXRjaCA9IC9iYWlkdWJveGFwcFwvKFtcZCsuXSspLy5leGVjKHVhKTsKICAgIHZhciBCT1hfVkVSU0lPTiA9IG1hdGNoICYmIG1hdGNoWzFdIHx8ICcwJzsgLy8g54mI5pys5bCP5LqOMTIuMjAuMC4w77yM5o+Q56S6MTAxIOivpeeJiOacrOS4jeaUr+aMgeatpOerr+iDveWKmwoKICAgIGlmICgoMCwgX2VvcFV0aWxzLnZlcnNpb25Db21wYXJlKShCT1hfVkVSU0lPTiwgJzEyLjIwLjAuMCcpIDwgMCkgewogICAgICByZWplY3QoTE9XX0VYSVNUKTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHZhciBzY2hlbWUgPSAiYmFpZHVib3hhcHA6Ly9hcHAvaXNCZXRhP2NhbGxiYWNrPSIuY29uY2F0KCgwLCBfZW9wVXRpbHMudG9HbG9iYWxGdW5jKShjYWxsYmFjaykpOwogICAgaW52b2tlQnlJZnJhbWUoc2NoZW1lKTsKCiAgICBmdW5jdGlvbiBjYWxsYmFjayhyZXMpIHsKICAgICAgcmVzID0gSlNPTi5wYXJzZShyZXMpOyAvLyDor7fmsYLmiJDlip/lm57osIPlgLwKCiAgICAgIGlmICgrcmVzLnN0YXR1cyA9PT0gMCkgewogICAgICAgIHJlc29sdmUocmVzLmRhdGEpOwogICAgICB9IC8vIOivt+axguWksei0pQogICAgICBlbHNlIHsKICAgICAgICAgIHZhciByZWplY3REYXRhID0gewogICAgICAgICAgICBzdGF0dXM6IHJlcy5zdGF0dXMsCiAgICAgICAgICAgIG1lc3NhZ2U6IHJlcy5tZXNzYWdlCiAgICAgICAgICB9OwogICAgICAgICAgcmVqZWN0KHJlamVjdERhdGEpOwogICAgICAgIH0KICAgIH0KICB9KTsKfQovKioKICoKICogQGNvbnN0cnVjdG9yIHViY+S4muWKoeaXpeW/l+exuwogKiBAZGVzY3JpcHRpb24gdWJj5Lia5Yqh5pel5b+X57G7CiAqCiAqIEBleGFtcGxlCiAqIG5ldyBVYmNsb2dnZXIoewogKiAgICAgc2VydmVySWQ6MTIzLAogKiAgICAgaWRmcm9tOidyZXNfZnVsaScsCiAqICAgICBwYWdlOidpbmRleCcKICogfSkKICovCgoKdmFyIFViY0xvZ2dlciQxID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICAvKioKICAgKiBDcmVhdGUgYSBVYmNMb2dnZXIKICAgKgogICAqIEBjbGFzcyBVYmNMb2dnZXIKICAgKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnNdICAgICAgICAgICAgICAgICAgICAgICAg5Yid5aeL5YyW5YWl5Y+CCiAgICogQHBhcmFtIHtudW1iZXJ9IFtvcHRpb25zLnNlcnZlcklkXSAgICAgICAgICAgICAgIOa0u+WKqHNlcnZlcklkCiAgICogQHBhcmFtIHtzdHJpbmd9IFtvcHRpb25zLnBhZ2VdICAgICAgICAgICAgICAgICAgIOmhtemdonBhZ2XlkI3np7AKICAgKiBAcGFyYW0ge3N0cmluZ30gW29wdGlvbnMudHlwZV0gICAgICAgICAgICAgICAgICAg5omT54K5dHlwZQogICAqIEBwYXJhbSB7c3RyaW5nfSBbb3B0aW9ucy5mcm9tXSAgICAgICAgICAgICAgICAgICDml6Xlv5fnsbvlnosKICAgKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnMucXVlcnlQYXJhbXNdICAgICAgICAgICAgdWJjVXJs5LiK55qEcXVlcnkoYXBwbmFtZSxmcm9tLGNmcm9tLHNtZncpCiAgICogQHBhcmFtIHtib29sZWFufSBbb3B0aW9ucy50ZXN0TW9kZT1mYWxzZV0gICAgICAgIHRydWXotbDnur/kuIvlnLDlnYA7IGZhbHNl5oiW6ICF5Li656m66LWw57q/5LiKdWJj5Zyw5Z2A77yM55uu5YmN5pel5b+X5bmz5Y+w6YeH55So5paw5qCh6aqM5pa55byP77yM5LiN6ZyA6KaB6LWw57q/5LiL5Zyw5Z2ACiAgICogQHBhcmFtIHtzdHJpbmd9IFtvcHRpb25zLnRlc3RVcmxdICAgICAgICAgICAgICAgIOaJk+eCueaVsOaNruS4iuS8oOWcsOWdgDvkvKDlhaXlkI7vvIzmiZPngrnmlbDmja7lsIblj5HpgIHoh7Por6XlnLDlnYAKICAgKiBAcGFyYW0ge3N0cmluZ30gW29wdGlvbnMuc291cmNlXSAgICAgICAgICAgICAgICAg6LWE5rqQ5L2Nc291cmNlCiAgICogQHBhcmFtIHtzdHJpbmd9IFtvcHRpb25zLmlkZnJvbV0gICAgICAgICAgICAgICAgIOi1hOa6kOS9jWlkZnJvbSjnrYnku7fkuo7otYTmupDkvY1zb3VyY2XvvIzkvJjlhYjnuqfmm7Tpq5gpCiAgICogQHBhcmFtIHtib29sZWFufSBbb3B0aW9ucy5pZkhlYXJ0YmVhdFRpbWU9dHJ1ZV0gIOaXtumVv+aJk+eCueaYr+WQpuS4uuW/g+i3s+eCue+8jOm7mOiupOS4unRydWUKICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtvcHRpb25zLnVzZVNlbmRCZWFjb249ZmFsc2VdICAg5L2/55SoU2VuZEJlYWNvbiBBUEnov5vooYzmiZPngrkKICAgKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnMubG9nTWVyZ2VPcHRdICAgICAgICAgICAg5pel5b+X5ZCI5bm25Y+C5pWw6YWN572uCiAgICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zLmxvZ01lcmdlT3B0LmlmQXV0b01lcmdlXSDmmK/lkKblvIDlkK/oh6rliqjlkIjlubbvvIzpu5jorqTkuI3lvIDlkK8KICAgKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnMubG9nTWVyZ2VPcHQubWVyZ2VOdW1NYXhdIOacgOWkp+aXpeW/l+WQiOW5tuaVsOmHjwogICAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9ucy5sb2dNZXJnZU9wdC5tZXJnZUludGVydmFsXSDlkIjlubbml7bpl7Tpl7TpmpQKICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtvcHRpb25zLmxvZ0VyclJldHJ5XSAgICAgICAgICAgIOaYr+WQpuW8gOWQr+aXpeW/l+mHjeivlQogICAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9ucy5leHRdICAgICAgICAgICAgICAg5YWs5YWx55qEZXh05Y+C5pWw77yM5Lya6KKrc2VuZOeahOS8oOWPguimhueblgogICAqCiAgICoKICAgKi8KICBmdW5jdGlvbiBVYmNMb2dnZXIoKSB7CiAgICB2YXIgb3B0aW9ucyA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDoge307CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFViY0xvZ2dlcik7IC8vIHViY0xvZwoKCiAgICB0aGlzLnViY1BhcmFtcyA9IHt9OyAvLyDmmK/lkKbliJ3lp4vljJYKCiAgICB0aGlzLmxvZ0luaXRlZCA9IGZhbHNlOyAvLyBzZXTlkI7nmoRvcHRpb25zCgogICAgdGhpcy5vcHRpb25zID0ge307IC8vIOaXtumVv+aJk+eCuQoKICAgIHRoaXMudGltZXJNYXAgPSBuZXcgTWFwKCk7IC8vIOWQiOW5tuaJk+eCuQoKICAgIHRoaXMubWVyZ2VMb2dnZXIgPSBudWxsOyAvLyDmiZPngrnph43or5XmnLrliLYKCiAgICB0aGlzLnJldHJ5TG9nZ2VyID0gbnVsbDsgLy8g5b2T5YmN5a6/5Li756uv5piv5ZCm5pivYmV0YeWMhQoKICAgIHRoaXMuaXNCZXRhID0gZmFsc2U7CgogICAgdGhpcy5faW5pdFViY1BhcmFtcygpOyAvLyDliJ3lp4vljJborr7nva7lj4LmlbAKCgogICAgdGhpcy5zZXQoT2JqZWN0LmFzc2lnbih7CiAgICAgIGR1cmF0aW9uOiAzLAogICAgICBpZkhlYXJ0YmVhdFRpbWU6IHRydWUsCiAgICAgIHRlc3RNb2RlOiBmYWxzZSwKICAgICAgdXNlU2VuZEJlYWNvbjogZmFsc2UsCiAgICAgIHVzZVhocjogZmFsc2UsCiAgICAgIHNlbmRNZXRob2Q6ICdnZXQnLAogICAgICBhcHB0eXBlOiBnZXRBcHBCeU5hbWUoKS5hcHBpZAogICAgfSwgb3B0aW9ucykpOyAvLyDms6jlhozpobXpnaLlj6/op4HmgKcKCiAgICB0aGlzLl9yZWdpc3RlclBhZ2VWaXNpYmlsaXR5KCk7CgogICAgdGhpcy5fcmVnaXN0ZXJCZXRhKCk7CiAgfQogIC8qKgogICAqIF9pbml0VWJjUGFyYW1zCiAgICoKICAgKiBAcHJpdmF0ZQogICAqLwoKCiAgX2NyZWF0ZUNsYXNzKFViY0xvZ2dlciwgW3sKICAgIGtleTogIl9pbml0VWJjUGFyYW1zIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfaW5pdFViY1BhcmFtcygpIHsKICAgICAgdGhpcy51YmNQYXJhbXMgPSB7fTsKICAgICAgdGhpcy51YmNEZWZhdWx0TG9nRGF0YSA9IENPTkZJRy5ERUZBVUxUX0xPR19EQVRBOyAvLyBtZXJnZem7mOiupOaVsOaNrgoKICAgICAgdGhpcy51YmNQYXJhbXMgPSBtZXJnZSh0aGlzLnViY1BhcmFtcywgdGhpcy51YmNEZWZhdWx0TG9nRGF0YSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiX2luaXRDb29raWUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9pbml0Q29va2llKCkgewogICAgICB2YXIgb3B0aW9ucyA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDoge307IC8vIOiuvue9rmNvb2tpZQoKICAgICAgaWYgKG9wdGlvbnMudGVzdE1vZGUpIHsKICAgICAgICBkb2N1bWVudC5jb29raWUgPSAnYmRfbG9nYXBfdmVyaWZ5PTE7ZG9tYWluPS5iYWlkdS5jb207cGF0aD0vJzsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBfaW5pdFViY1VybAogICAgICoKICAgICAqIEBwcml2YXRlCiAgICAgKiBAcGFyYW0ge09iamVjdH0gb3B0aW9ucyAgb3B0aW9uc+WFpeWPggogICAgICovCgogIH0sIHsKICAgIGtleTogIl9pbml0VWJjVXJsIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfaW5pdFViY1VybCgpIHsKICAgICAgdmFyIG9wdGlvbnMgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IHt9OyAvLyDojrflj5Z1YmNVcmwKCiAgICAgIHZhciBxdWVyeSA9IG9wdGlvbnMucXVlcnlQYXJhbXMgfHwge307CgogICAgICBpZiAodGhpcy5pc0JldGEpIHsKICAgICAgICBxdWVyeSA9IF9vYmplY3RTcHJlYWQyKHsKICAgICAgICAgIGJldGE6IDEKICAgICAgICB9LCBxdWVyeSk7CiAgICAgIH0gLy8g57q/5LiL546v5aKD5bim5LiKZGVidWfmoIfnpLoKCgogICAgICBpZiAob3B0aW9ucy50ZXN0TW9kZSkgewogICAgICAgIHF1ZXJ5ID0gX29iamVjdFNwcmVhZDIoewogICAgICAgICAgZGVidWc6IDEKICAgICAgICB9LCBxdWVyeSk7CiAgICAgIH0gLy8gYmV0YT0xCgoKICAgICAgdGhpcy51YmNVcmwgPSBnZXRVcmwob3B0aW9ucy50ZXN0TW9kZSA/IG9wdGlvbnMudGVzdFVybCA/IG9wdGlvbnMudGVzdFVybCA6IENPTkZJRy5VQkNfVVJMIDogQ09ORklHLlVCQ19VUkwsIG1lcmdlKENPTkZJRy5ERUZBVUxUX1FVRVJZLCBxdWVyeSkpOwogICAgICB0aGlzLnViY01lcmdlVXJsID0gZ2V0VXJsKG9wdGlvbnMudGVzdE1vZGUgPyBvcHRpb25zLnRlc3RVcmwgPyBvcHRpb25zLnRlc3RVcmwgOiBDT05GSUdfTUVSR0UuVUJDX1VSTCA6IENPTkZJR19NRVJHRS5VQkNfVVJMLCBtZXJnZShDT05GSUdfTUVSR0UuREVGQVVMVF9RVUVSWSwgcXVlcnkpKTsKICAgIH0KICAgIC8qKgogICAgICogc2V0CiAgICAgKiBvcHRpb25z5Y+v5LiN5aGr77yM57y655yB5a2X5q615Lya5Lul5LiK5qyh6K6+572u55qE5Li65YeGCiAgICAgKiBAZXhhbXBsZQogICAgICogdWJjbG9nZ2VyLnNldCh7CiAgICAgKiAgICAgc2VydmVySWQ6MTIzLAogICAgICogICAgIGlkZnJvbToncmVzX2Z1bGknLAogICAgICogICAgIHBhZ2U6J2luZGV4JwogICAgICogfSkKICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9uc10gICAgICAgICAgICAgICAgICDliJ3lp4vljJblhaXlj4IKICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbb3B0aW9ucy5zZXJ2ZXJJZF0gICAgICAgICAgICAgICDmtLvliqhzZXJ2ZXJJZAogICAgICogQHBhcmFtIHtzdHJpbmd9IFtvcHRpb25zLnBhZ2VdICAgICAgICAgICAgICAgICAgIOmhtemdonBhZ2XlkI3np7AKICAgICAqIEBwYXJhbSB7c3RyaW5nfSBbb3B0aW9ucy5mcm9tXSAgICAgICAgICAgICAgICAgICDml6Xlv5fnsbvlnosKICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9ucy5xdWVyeVBhcmFtc10gICAgICAgICAgICB1YmNVcmzkuIrnmoRxdWVyeShhcHBuYW1lLGZyb20sY2Zyb20sc21mdykKICAgICAqIEBwYXJhbSB7c3RyaW5nfSBbb3B0aW9ucy50ZXN0TW9kZV0gICAgICAgICB0cnVl6LWw5qCh6aqM5qih5byPOyBmYWxzZeaIluiAheS4uuepuui1sOe6v+S4inViY+WcsOWdgAogICAgICogQHBhcmFtIHtzdHJpbmd9IFtvcHRpb25zLnRlc3RVcmxdICAgICAgICAgICAgICAgIOaJk+eCueaVsOaNruS4iuS8oOWcsOWdgDvkvKDlhaXlkI7vvIzmiZPngrnmlbDmja7lsIblj5HpgIHoh7Por6XlnLDlnYDvvIjpnIDopoF0ZXN0TW9kZT10cnVl77yJCiAgICAgKiBAcGFyYW0ge3N0cmluZ30gW29wdGlvbnMuc291cmNlXSAgICAgICAgICAgICAgICAg6LWE5rqQ5L2Nc291cmNlCiAgICAgKiBAcGFyYW0ge3N0cmluZ30gW29wdGlvbnMuaWRmcm9tXSAgICAgICAgICAgICAgICAg6LWE5rqQ5L2NaWRmcm9tKOetieS7t+S6jui1hOa6kOS9jXNvdXJjZe+8jOS8mOWFiOe6p+abtOmrmCkKICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW29wdGlvbnMuaWZIZWFydGJlYXRUaW1lXSAg5pe26ZW/5omT54K55piv5ZCm5Li65b+D6Lez54K5CiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtvcHRpb25zLnVzZVNlbmRCZWFjb25dICAg5L2/55SoU2VuZEJlYWNvbiBBUEnov5vooYzmiZPngrnvvIzpu5jorqRmYWxzZQogICAgICogQHBhcmFtIHtib29sZWFufSBbb3B0aW9ucy51c2VYaHJdICAg5L2/55SoeGhy6L+b6KGM5omT54K5LOm7mOiupGZhbHNlCiAgICAgKiBAcGFyYW0ge3N0cmluZ30gW29wdGlvbnMuc2VuZE1ldGhvZF0gICDljZXmnaHor7fmsYLlj5HpgIHmlrnlvI8gZ2V0L3Bvc3TvvIzpu5jorqRnZXTvvIzphY3lkIh1c2VYaHLkvb/nlKgKICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9ucy5sb2dNZXJnZU9wdF0gICAgICAgICAgICDml6Xlv5flkIjlubblj4LmlbDphY3nva4KICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW29wdGlvbnMubG9nTWVyZ2VPcHQuaWZBdXRvTWVyZ2VdIOaYr+WQpuW8gOWQr+iHquWKqOWQiOW5tu+8jOm7mOiupOS4jeW8gOWQrwogICAgICogQHBhcmFtIHtudW1iZXJ9IFtvcHRpb25zLmxvZ01lcmdlT3B0Lm1lcmdlTnVtTWF4XSDmnIDlpKfml6Xlv5flkIjlubbmlbDph4/jgILpu5jorqQ15p2hCiAgICAgKiBAcGFyYW0ge251bWJlcn0gW29wdGlvbnMubG9nTWVyZ2VPcHQubWVyZ2VJbnRlcnZhbF0g5ZCI5bm25pe26Ze06Ze06ZqU77yM6buY6K6kNXMs5Y2V5L2NcwogICAgICogQHBhcmFtIHtib29sZWFufSBbb3B0aW9ucy5sb2dFcnJSZXRyeV0gICAgICAgICAgICDmmK/lkKblvIDlkK/ml6Xlv5fph43or5UKICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9ucy5leHRdICAgICAgICAgICAgICAg5YWs5YWx55qEZXh05Y+C5pWw77yM5Lya6KKrc2VuZOeahOS8oOWPguimhueblgogICAgICoKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJzZXQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldCgpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHZhciBvcHRpb25zID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiB7fTsKICAgICAgdGhpcy5vcHRpb25zID0gX29iamVjdFNwcmVhZDIoX29iamVjdFNwcmVhZDIoe30sIHRoaXMub3B0aW9ucyksIG9wdGlvbnMpOwoKICAgICAgdGhpcy5faW5pdENvb2tpZSh0aGlzLm9wdGlvbnMpOwoKICAgICAgdGhpcy5faW5pdFViY1VybCh0aGlzLm9wdGlvbnMpOyAvLyDphY3nva5zZXJ2ZXJJZCxzb3VyY2UoaWRmcm9tKSxwYWdlCgoKICAgICAgdGhpcy51YmNQYXJhbXMgPSBtZXJnZSh0aGlzLnViY1BhcmFtcywgewogICAgICAgIGFjdGlvbmRhdGE6IHsKICAgICAgICAgIGlkOiB0aGlzLm9wdGlvbnMuc2VydmVySWQsCiAgICAgICAgICBjb250ZW50OiB7CiAgICAgICAgICAgIHNvdXJjZTogdGhpcy5vcHRpb25zLnNvdXJjZSB8fCB0aGlzLm9wdGlvbnMuaWRmcm9tIHx8IGdldFVybFF1ZXJ5KCdzb3VyY2UnKSB8fCBnZXRVcmxRdWVyeSgnaWRmcm9tJyksCiAgICAgICAgICAgIHBhZ2U6IHRoaXMub3B0aW9ucy5wYWdlLAogICAgICAgICAgICBmcm9tOiB0aGlzLm9wdGlvbnMuZnJvbSwKICAgICAgICAgICAgdHlwZTogdGhpcy5vcHRpb25zLnR5cGUsCiAgICAgICAgICAgIGV4dDogX29iamVjdFNwcmVhZDIoewogICAgICAgICAgICAgIGFwcHR5cGU6IHRoaXMub3B0aW9ucy5hcHB0eXBlCiAgICAgICAgICAgIH0sIHRoaXMub3B0aW9ucy5leHQpCiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KTsKCiAgICAgIGlmICgrdGhpcy5vcHRpb25zLnNlcnZlcklkKSB7CiAgICAgICAgdGhpcy5sb2dJbml0ZWQgPSB0cnVlOwogICAgICB9IC8vIOWIneWni+WMlm1lcmdlTG9nZ2VyCgoKICAgICAgaWYgKCF0aGlzLm1lcmdlTG9nZ2VyKSB7CiAgICAgICAgdGhpcy5tZXJnZUxvZ2dlciA9IG5ldyBNZXJnZUxvZ2dlcih7CiAgICAgICAgICBsb2dGbjogZnVuY3Rpb24gbG9nRm4ocGFyYW1zTGlzdCkgewogICAgICAgICAgICByZXR1cm4gX3RoaXMuX3NlbmRNZXJnZShwYXJhbXNMaXN0LCB7CiAgICAgICAgICAgICAgdXNlWGhyOiB0cnVlLAogICAgICAgICAgICAgIHNlbmRNZXRob2Q6ICdwb3N0JwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQoKICAgICAgaWYgKHRoaXMub3B0aW9ucy5sb2dNZXJnZU9wdCkgewogICAgICAgIC8vIOS/ruaUuW1lcmdlTG9nZ2Vy6YCJ6aG5CiAgICAgICAgdGhpcy5tZXJnZUxvZ2dlci5zZXQodGhpcy5vcHRpb25zLmxvZ01lcmdlT3B0KTsKICAgICAgfSAvLyDliJ3lp4vljJZyZXRyeUxvZ2dlcgoKCiAgICAgIGlmICh0aGlzLm9wdGlvbnMubG9nRXJyUmV0cnkgJiYgIXRoaXMucmV0cnlMb2dnZXIpIHsKICAgICAgICB0aGlzLnJldHJ5TG9nZ2VyID0gbmV3IFJldHJ5TG9nZ2VyKHsKICAgICAgICAgIGxvZ0ZuOiBmdW5jdGlvbiBsb2dGbih1cmwsIGxvZ0RhdGEpIHsKICAgICAgICAgICAgbG9nRGF0YS5hY3Rpb25kYXRhLm1ldGFkYXRhLnVwbG9hZFRpbWVTdGFtcCA9IERhdGUubm93KCk7CiAgICAgICAgICAgIHJldHVybiBzbWFydFNlbmQodXJsLCBsb2dEYXRhLCB7CiAgICAgICAgICAgICAgdXNlWGhyOiB0cnVlCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIOWPkemAgeaZrumAmueCuQogICAgICogQHByaXZhdGUKICAgICAqIEBwYXJhbSAge09iamVjdH0gcGFyYW1zICDmiZPngrnoh6rlrprkuYnlj4LmlbAKICAgICAqIEBwYXJhbSAge09iamVjdH0gb3B0aW9ucyDpop3lpJblj4LmlbAKICAgICAqIEBwYXJhbSAge2Jvb2xlYW59IG9wdGlvbnMudXNlU2VuZEJlYWNvbiDmmK/lkKbkvb/nlKhTZW5kQmVhY29uIEFQSeWPkemAgeivt+axggogICAgICogQHBhcmFtICB7Ym9vbGVhbn0gW29wdGlvbnMudXNlWGhyXSDmmK/lkKbkvb/nlKhYaHLlj5HpgIHor7fmsYIKICAgICAqIEBwYXJhbSAge3N0cmluZ30gW29wdGlvbnMuc2VuZE1ldGhvZF0g5Y2V5p2h6K+35rGC5Y+R6YCB5pa55byPIGdldC9wb3N077yM6buY6K6kZ2V077yM6YWN5ZCIdXNlWGhy5L2/55SoCiAgICAgKiBAcmV0dXJuIHtQcm9taXNlfSBwcm9taXNlIOaJk+eCueaIkOWKn+WPkemAgei/lOWbnnRoZW4KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJfc2VuZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX3NlbmQoKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgdmFyIHBhcmFtcyA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDoge307CiAgICAgIHZhciBvcHRpb25zID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiB7fTsKICAgICAgdmFyIGxvZ0RhdGEgPSB7fTsKICAgICAgdmFyIG5vdyA9IERhdGUubm93KCk7IC8vIOS6i+S7tuaJk+eCueato+W4uOWkhOeQhgoKICAgICAgdmFyIGJhaWR1SWQgPSBnZXRDb29raWVCeU5hbWUoJ0JBSURVSUQnKTsKCiAgICAgIGlmIChiYWlkdUlkICYmIHRoaXMub3B0aW9ucy5sb2dFcnJSZXRyeSkgewogICAgICAgIC8vIOiOt+W+l+ayoeacieWKoG1ldGFkYXRh55qEbG9nRGF0YQogICAgICAgIGxvZ0RhdGEgPSBtZXJnZSh0aGlzLnViY1BhcmFtcywgewogICAgICAgICAgYWN0aW9uZGF0YTogewogICAgICAgICAgICB0aW1lc3RhbXA6IG5vdywKICAgICAgICAgICAgY29udGVudDogcGFyYW1zCiAgICAgICAgICB9CiAgICAgICAgfSk7IC8vIOmAmui/h2JhaWR1SWTlkoxsb2dEYXRh6K6h566X5pGY6KaB5YC877yIbG9nRGF0YemHjOmdouW3sue7j+WMheWQq+S6huW9k+WJjeaXtumXtOaIs++8iQoKICAgICAgICB2YXIgbG9nZ2VySWQgPSBzaGEyNTYoYmFpZHVJZCArIEpTT04uc3RyaW5naWZ5KGxvZ0RhdGEpKTsKICAgICAgICBsb2dEYXRhLmFjdGlvbmRhdGEubWV0YWRhdGEgPSB7CiAgICAgICAgICBtZDU6IGxvZ2dlcklkLAogICAgICAgICAgdXBsb2FkVGltZVN0YW1wOiBub3cKICAgICAgICB9OwogICAgICAgIHJldHVybiBzbWFydFNlbmQodGhpcy51YmNVcmwsIGxvZ0RhdGEsIF9vYmplY3RTcHJlYWQyKF9vYmplY3RTcHJlYWQyKHt9LCBvcHRpb25zKSwge30sIHsKICAgICAgICAgIHVzZVhocjogdHJ1ZQogICAgICAgIH0pKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgICAvLyDmiZPngrnmiJDlip/lkI7pgJrnn6VyZXRyeUxvZ2dlcgogICAgICAgICAgX3RoaXMyLnJldHJ5TG9nZ2VyLmFjdGl2ZSgpOwoKICAgICAgICAgIHJldHVybiBkYXRhOwogICAgICAgIH0pWyJjYXRjaCJdKGZ1bmN0aW9uIChlcnIpIHsKICAgICAgICAgIC8v5ZCR6Zif5YiX5Lit5Yqg5LiA5p2h5pel5b+XCiAgICAgICAgICBfdGhpczIucmV0cnlMb2dnZXIuYWRkTG9nKHsKICAgICAgICAgICAgdXJsOiBfdGhpczIudWJjVXJsLAogICAgICAgICAgICBsb2dnZXJEYXRhOiBsb2dEYXRhLAogICAgICAgICAgICBsb2dnZXJJZDogbG9nZ2VySWQKICAgICAgICAgIH0pOwoKICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnIpOwogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIGxvZ0RhdGEgPSBtZXJnZSh0aGlzLnViY1BhcmFtcywgewogICAgICAgICAgYWN0aW9uZGF0YTogewogICAgICAgICAgICB0aW1lc3RhbXA6IG5vdywKICAgICAgICAgICAgY29udGVudDogcGFyYW1zCiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIHNtYXJ0U2VuZCh0aGlzLnViY1VybCwgbG9nRGF0YSwgb3B0aW9ucyk7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICog5Y+R6YCB5ZCI5bm254K5CiAgICAgKiBAcHJpdmF0ZQogICAgICogQHBhcmFtICB7QXJyYXl9IHBhcmFtc0xpc3QgIOaJk+eCueiHquWumuS5ieWPguaVsAogICAgICogQHBhcmFtICB7T2JqZWN0fSBvcHRpb25zIOmineWkluWPguaVsAogICAgICogQHBhcmFtICB7Ym9vbGVhbn0gW29wdGlvbnMudXNlU2VuZEJlYWNvbl0g5piv5ZCm5L2/55SoU2VuZEJlYWNvbiBBUEnlj5HpgIHor7fmsYIKICAgICAqIEBwYXJhbSAge2Jvb2xlYW59IFtvcHRpb25zLnVzZVhocl0g5piv5ZCm5L2/55SoWGhy5Y+R6YCB6K+35rGCCiAgICAgKiBAcGFyYW0gIHtzdHJpbmd9IFtvcHRpb25zLnNlbmRNZXRob2RdIOWNleadoeivt+axguWPkemAgeaWueW8jyBnZXQvcG9zdO+8jOm7mOiupGdldO+8jOmFjeWQiHVzZVhocuS9v+eUqAogICAgICogQHJldHVybiB7UHJvbWlzZX0gcHJvbWlzZSDmiZPngrnmiJDlip/lj5HpgIHov5Tlm550aGVuCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiX3NlbmRNZXJnZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX3NlbmRNZXJnZSgpIHsKICAgICAgdmFyIHBhcmFtc0xpc3QgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IFtdOwogICAgICB2YXIgb3B0aW9ucyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDoge307CiAgICAgIHZhciBsb2dEYXRhID0ge307CiAgICAgIHZhciBub3cgPSBEYXRlLm5vdygpOyAvLyDkuovku7bmiZPngrnmraPluLjlpITnkIYKCiAgICAgIHZhciBhY3Rpb25kYXRhID0gdGhpcy51YmNQYXJhbXMuYWN0aW9uZGF0YTsKICAgICAgdmFyIGRhdGEgPSBwYXJhbXNMaXN0Lm1hcChmdW5jdGlvbiAocGFyYW1zKSB7CiAgICAgICAgdmFyIHRlbXBMb2dEYXRhID0gbWVyZ2UoYWN0aW9uZGF0YSwgewogICAgICAgICAgdGltZXN0YW1wOiBub3csCiAgICAgICAgICBjb250ZW50OiBwYXJhbXMKICAgICAgICB9KTsKICAgICAgICByZXR1cm4gdGVtcExvZ0RhdGE7CiAgICAgIH0pOwogICAgICBsb2dEYXRhID0gX29iamVjdFNwcmVhZDIoX29iamVjdFNwcmVhZDIoe30sIENPTkZJR19NRVJHRS5ERUZBVUxUX0xPR19EQVRBKSwge30sIHsKICAgICAgICBkYXRhOiBkYXRhCiAgICAgIH0pOwogICAgICByZXR1cm4gc21hcnRTZW5kKHRoaXMudWJjTWVyZ2VVcmwsIGxvZ0RhdGEsIG9wdGlvbnMpOwogICAgfQogICAgLyoqCiAgICAgKiDlj5HpgIHmtYHlvI/ngrkKICAgICAqIEBwcml2YXRlCiAgICAgKiBAcGFyYW0gIHtPYmplY3R9IHBhcmFtcyAg5omT54K56Ieq5a6a5LmJ5Y+C5pWwCiAgICAgKiBAcGFyYW0gIHtPYmplY3R9IHRpbWluZyAg5pe26ZW/55u45YWz5Y+C5pWwCiAgICAgKiBAcGFyYW0gIHtPYmplY3R9IG9wdGlvbnMg6aKd5aSW5Y+C5pWwCiAgICAgKiBAcGFyYW0gIHtib29sZWFufSBvcHRpb25zLnVzZVNlbmRCZWFjb24g5piv5ZCm5L2/55SoU2VuZEJlYWNvbiBBUEnlj5HpgIHor7fmsYIKICAgICAqIEByZXR1cm4ge1Byb21pc2V9IHByb21pc2Ug5omT54K55oiQ5Yqf5Y+R6YCB6L+U5ZuedGhlbgogICAgICovCgogIH0sIHsKICAgIGtleTogIl9zZW5kRmxvdyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX3NlbmRGbG93KCkgewogICAgICB2YXIgcGFyYW1zID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiB7fTsKICAgICAgdmFyIHRpbWluZyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDoge307CiAgICAgIHZhciBvcHRpb25zID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgJiYgYXJndW1lbnRzWzJdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMl0gOiB7fTsgLy8g5rWB5byP5omT54K55Y+C5pWw5aSE55CGCgogICAgICB2YXIgbG9nRGF0YSA9IHRoaXMuX2dldEZsb3dEYXRhKHBhcmFtcywgdGltaW5nKTsKCiAgICAgIHJldHVybiBzbWFydFNlbmQodGhpcy51YmNVcmwsIGxvZ0RhdGEsIG9wdGlvbnMpOwogICAgfQogICAgLyoqCiAgICAgKiBzZW5kCiAgICAgKiBAZXhhbXBsZQogICAgICogdWJjbG9nZ2VyLnNlbmQoewogICAgICogICAgIHBhZ2U6ICd5X2VudF9sb2dpbicsCiAgICAgKiAgICAgdHlwZTogJ2xvZ2luX2NsaycsCiAgICAgKiAgICAgdmFsdWU6ICdsb2dpbicsCiAgICAgKiAgICAgZXh0OiB7CiAgICAgKiAgICAgICAgIHAxOiAnbG9naW4nCiAgICAgKiAgICAgfQogICAgICogfSkKICAgICAqIEBwYXJhbSAge09iamVjdH0gcGFyYW1zICDmiZPngrnoh6rlrprkuYnlj4LmlbAKICAgICAqIEBwYXJhbSAge09iamVjdH0gW29wdGlvbnNdIOmineWklumAiemhuQogICAgICogQHBhcmFtICB7Ym9vbGVhbn0gW29wdGlvbnMudXNlU2VuZEJlYWNvbl0g5piv5ZCm5L2/55SoU2VuZEJlYWNvbiBBUEnlj5HpgIHor7fmsYIKICAgICAqIEBwYXJhbSAge2Jvb2xlYW59IFtvcHRpb25zLnVzZVhocl0g5piv5ZCm5L2/55SoWGhy5Y+R6YCB6K+35rGCCiAgICAgKiBAcGFyYW0gIHtzdHJpbmd9IFtvcHRpb25zLnNlbmRNZXRob2RdIOWNleadoeivt+axguWPkemAgeaWueW8jyBnZXQvcG9zdO+8jOm7mOiupGdldO+8jOmFjeWQiHVzZVhocuS9v+eUqAogICAgICogQHJldHVybiB7UHJvbWlzZX0gcHJvbWlzZSDmiZPngrnmiJDlip/lj5HpgIHov5Tlm550aGVuCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAic2VuZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2VuZCgpIHsKICAgICAgdmFyIF90aGlzJG9wdGlvbnMsIF90aGlzJG9wdGlvbnMkbG9nTWVyZzsKCiAgICAgIHZhciBwYXJhbXMgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IHt9OwogICAgICB2YXIgb3B0aW9ucyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxID8gYXJndW1lbnRzWzFdIDogdW5kZWZpbmVkOwoKICAgICAgaWYgKCF0aGlzLmxvZ0luaXRlZCkgewogICAgICAgIHRocm93ICdVQkMgU0RLIHNlcnZlcklkIGNhbiBub3QgYmUgZW1wdHkhJzsKICAgICAgfQoKICAgICAgb3B0aW9ucyA9IF9vYmplY3RTcHJlYWQyKHsKICAgICAgICB1c2VTZW5kQmVhY29uOiB0aGlzLm9wdGlvbnMudXNlU2VuZEJlYWNvbiwKICAgICAgICB1c2VYaHI6IHRoaXMub3B0aW9ucy51c2VYaHIsCiAgICAgICAgb3B0aW9uczogdGhpcy5vcHRpb25zLnNlbmRNZXRob2QKICAgICAgfSwgb3B0aW9ucyk7CgogICAgICBpZiAoKF90aGlzJG9wdGlvbnMgPSB0aGlzLm9wdGlvbnMpICE9PSBudWxsICYmIF90aGlzJG9wdGlvbnMgIT09IHZvaWQgMCAmJiAoX3RoaXMkb3B0aW9ucyRsb2dNZXJnID0gX3RoaXMkb3B0aW9ucy5sb2dNZXJnZU9wdCkgIT09IG51bGwgJiYgX3RoaXMkb3B0aW9ucyRsb2dNZXJnICE9PSB2b2lkIDAgJiYgX3RoaXMkb3B0aW9ucyRsb2dNZXJnLmlmQXV0b01lcmdlKSB7CiAgICAgICAgdGhpcy5tZXJnZUxvZ2dlci5hZGQocGFyYW1zKTsKICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIHRoaXMuX3NlbmQocGFyYW1zLCBvcHRpb25zKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBzZW5kTWVyZ2VMb2cKICAgICAqIEBleGFtcGxlCiAgICAgKiB1YmNsb2dnZXIuc2VuZE1lcmdlTG9nKHsKICAgICAqICAgICBwYWdlOiAneV9lbnRfbG9naW4nLAogICAgICogICAgIHR5cGU6ICdsb2dpbl9jbGsnLAogICAgICogICAgIHZhbHVlOiAnbG9naW4nLAogICAgICogICAgIGV4dDogewogICAgICogICAgICAgICBwMTogJ2xvZ2luJwogICAgICogICAgIH0KICAgICAqIH0pCiAgICAgKiBAcGFyYW0gIHtPYmplY3R9IHBhcmFtcyAg5omT54K56Ieq5a6a5LmJ5Y+C5pWwCiAgICAgKiBAcmV0dXJuIHtQcm9taXNlfSBwcm9taXNlIOaJk+eCueaIkOWKn+WPkemAgei/lOWbnnRoZW4KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJzZW5kTWVyZ2VMb2ciLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNlbmRNZXJnZUxvZygpIHsKICAgICAgdmFyIHBhcmFtcyA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDoge307CgogICAgICBpZiAoIXRoaXMubG9nSW5pdGVkKSB7CiAgICAgICAgdGhyb3cgJ1VCQyBTREsgc2VydmVySWQgY2FuIG5vdCBiZSBlbXB0eSEnOwogICAgICB9CgogICAgICB0aGlzLm1lcmdlTG9nZ2VyLmFkZChwYXJhbXMpOwogICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7CiAgICB9CiAgICAvKioKICAgICAqIF9nZXRGbG93RGF0YQogICAgICoKICAgICAqIEBwcml2YXRlCiAgICAgKiBAc2VlIOa1geW8j+aJk+eCueWtl+auteagvOW8j++8mmh0dHA6Ly93aWtpLmJhaWR1LmNvbS9wYWdlcy92aWV3cGFnZS5hY3Rpb24/cGFnZUlkPTMzNzM0NzczOSNpZC0lRTYlOTclQTUlRTUlQkYlOTclRTglQTclODQlRTglOEMlODMtMi4zLjMlRTYlQjUlODElRTclQjElQkIlRTUlOUUlOEIlRTYlOTclQTUlRTUlQkYlOTclRTUlQUQlOTclRTYlQUUlQjUlRTglQTclODQlRTglOEMlODMlRTIlODAlOTQlRTYlOTclQjYlRTklOTUlQkYKICAgICAqIEBwYXJhbSB7T2JqZWN0fSBjb250ZW50IOaJk+eCueiHquWumuS5ieWPguaVsAogICAgICogQHBhcmFtIHtPYmplY3R9IHRpbWluZyDml7bplb/nm7jlhbPlj4LmlbAKICAgICAqIEByZXR1cm4ge09iamVjdH0gbG9nRGF0YSDmiZPngrnmlbDmja4KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJfZ2V0Rmxvd0RhdGEiLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9nZXRGbG93RGF0YShjb250ZW50LCB0aW1pbmcpIHsKICAgICAgdmFyIF90aGlzJHViY1BhcmFtcywgX3RoaXMkdWJjUGFyYW1zJGFjdGlvOwoKICAgICAgdmFyIHJlc3VsdExvZ0RhdGEgPSB7fTsKICAgICAgdmFyIHN0YXJ0dGltZSA9IHRpbWluZy5zdGFydHRpbWUsCiAgICAgICAgICBkdXJhdGlvbiA9IHRpbWluZy5kdXJhdGlvbiwKICAgICAgICAgIGVuZHRpbWUgPSB0aW1pbmcuZW5kdGltZTsKICAgICAgdmFyIG5vdyA9IERhdGUubm93KCk7IC8vIOWwhnRoaXMudWJjUGFyYW1zPy5hY3Rpb25kYXRhPy5jb250ZW50IOmHjOmdoiDlkJHkuIvnp7vliqjliLAgcmVzdWx0TG9nRGF0YS5hY3Rpb25kYXRhPy5jb250ZW50Lm9wdGlvbgoKICAgICAgcmVzdWx0TG9nRGF0YSA9IG1lcmdlKHRoaXMudWJjUGFyYW1zLCB7CiAgICAgICAgYWN0aW9uZGF0YTogewogICAgICAgICAgY29udGVudDogJy0nCiAgICAgICAgfQogICAgICB9KTsKICAgICAgcmVzdWx0TG9nRGF0YSA9IG1lcmdlKHJlc3VsdExvZ0RhdGEsIHsKICAgICAgICBhY3Rpb25kYXRhOiB7CiAgICAgICAgICB0aW1lc3RhbXA6IG5vdywKICAgICAgICAgIHN0YXJ0dGltZTogc3RhcnR0aW1lLAogICAgICAgICAgZW5kdGltZTogZW5kdGltZSwKICAgICAgICAgIHR5cGU6IDEsCiAgICAgICAgICBjb250ZW50OiB7CiAgICAgICAgICAgIGR1cmF0aW9uOiBkdXJhdGlvbiwKICAgICAgICAgICAgb3B0aW9uOiBtZXJnZSgoX3RoaXMkdWJjUGFyYW1zID0gdGhpcy51YmNQYXJhbXMpID09PSBudWxsIHx8IF90aGlzJHViY1BhcmFtcyA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF90aGlzJHViY1BhcmFtcyRhY3RpbyA9IF90aGlzJHViY1BhcmFtcy5hY3Rpb25kYXRhKSA9PT0gbnVsbCB8fCBfdGhpcyR1YmNQYXJhbXMkYWN0aW8gPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzJHViY1BhcmFtcyRhY3Rpby5jb250ZW50LCBjb250ZW50KQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7CiAgICAgIHJldHVybiByZXN1bHRMb2dEYXRhOwogICAgfQogICAgLyoqCiAgICAgKiBzdGFydFRpbWluZ0xvZyDlvIDlp4sKICAgICAqIEBleGFtcGxlCiAgICAgKiB1YmNsb2dnZXIuc3RhcnRUaW1pbmdMb2coJ3RpbWluZzEnLHsKICAgICAqICAgICBwYWdlOiAneV9lbnRfbG9naW4nLAogICAgICogICAgIHR5cGU6ICdsb2dpbl9jbGsnLAogICAgICogICAgIHZhbHVlOiAnbG9naW4nLAogICAgICogICAgIGV4dDogewogICAgICogICAgICAgICBwMTogJ2xvZ2luJwogICAgICogICAgIH0KICAgICAqIH0pCiAgICAgKiBAZXhhbXBsZQogICAgICogdWJjbG9nZ2VyLnN0YXJ0VGltaW5nTG9nKCd0aW1pbmcxJyx7CiAgICAgKiAgICAgcGFnZTogJ3lfZW50X2xvZ2luJywKICAgICAqIH0sewogICAgICogICAgIHVzZVNlbmRCZWFjb246IHRydWUKICAgICAqIH0KICAgICAqIEBwYXJhbSAgeyp9IFtsYWJlbD1kZWZhdWx0XSAg5pe26ZW/5omT54K55b+F6aG75oul5pyJ5ZSv5LiA55qE5ZCN5a2X77yM6buY6K6kZGVmYXVsdAogICAgICogQHBhcmFtICB7T2JqZWN0fSBbcGFyYW1zXSAg5omT54K56Ieq5a6a5LmJ5Y+C5pWwCiAgICAgKiBAcGFyYW0gIHtPYmplY3R9IFtvcHRpb25zXSAg5omT54K56K6+572u77yM6KaG55uW5YWo5bGA6K6+572uCiAgICAgKiBAcGFyYW0gIHtib29sZWFufSBbb3B0aW9ucy5pZkhlYXJ0YmVhdFRpbWVdICDmmK/lkKbpgJrov4flv4Pot7PmiZPngrkKICAgICAqIEBwYXJhbSAge2Jvb2xlYW59IFtvcHRpb25zLnVzZVNlbmRCZWFjb25dICDmmK/lkKbkvb/nlKggU2VuZEJlYWNvbiBBUEkKICAgICAqIEBwYXJhbSAge251bWJlcn0gW29wdGlvbnMuZHVyYXRpb25dICDlv4Pot7PmiZPngrnnmoTpl7TpmpTvvIzljZXkvY1zCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAic3RhcnRUaW1pbmdMb2ciLAogICAgdmFsdWU6IGZ1bmN0aW9uIHN0YXJ0VGltaW5nTG9nKCkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIHZhciBsYWJlbCA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogJ2RlZmF1bHQnOwogICAgICB2YXIgcGFyYW1zID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiB7fTsKICAgICAgdmFyIG9wdGlvbnMgPSBhcmd1bWVudHMubGVuZ3RoID4gMiA/IGFyZ3VtZW50c1syXSA6IHVuZGVmaW5lZDsKICAgICAgdmFyIHRpbWVyID0gdGhpcy50aW1lck1hcC5nZXQobGFiZWwpOyAvLyDlpoLmnpzkuI3lrZjlnKjml7bplb/miZPngrnvvIzliJnliJvlu7rkuIDkuKrmiZPngrkKCiAgICAgIGlmICghdGltZXIpIHsKICAgICAgICB0aW1lciA9IG5ldyBUaW1lTG9nZ2VyKF9vYmplY3RTcHJlYWQyKF9vYmplY3RTcHJlYWQyKHsKICAgICAgICAgIGlmSGVhcnRiZWF0VGltZTogdGhpcy5vcHRpb25zLmlmSGVhcnRiZWF0VGltZSwKICAgICAgICAgIGR1cmF0aW9uOiB0aGlzLm9wdGlvbnMuZHVyYXRpb24KICAgICAgICB9LCBvcHRpb25zKSwge30sIHsKICAgICAgICAgIC8vIOagueaNruaXtumVv+ebuOWFs+WPguaVsO+8jOWPkemAgeaJk+eCuQogICAgICAgICAgbG9nRm46IGZ1bmN0aW9uIGxvZ0ZuKHRpbWluZykgewogICAgICAgICAgICBfdGhpczMuX3NlbmRGbG93KHBhcmFtcywgdGltaW5nLCBfb2JqZWN0U3ByZWFkMih7CiAgICAgICAgICAgICAgdXNlU2VuZEJlYWNvbjogX3RoaXMzLm9wdGlvbnMudXNlU2VuZEJlYWNvbgogICAgICAgICAgICB9LCBvcHRpb25zKSk7CiAgICAgICAgICB9CiAgICAgICAgfSkpOwogICAgICAgIHRoaXMudGltZXJNYXAuc2V0KGxhYmVsLCB0aW1lcik7CiAgICAgIH0KCiAgICAgIGlmICh0aW1lci5mbGFnID09PSAnUlVOTklORycpIHsKICAgICAgICBjb25zb2xlLndhcm4oInRpbWVMb2dnZXJbIi5jb25jYXQobGFiZWwsICJdIGlzIHJ1bm5pbmciKSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB0aW1lci5zdGFydCgpOwogICAgfQogICAgLyoqCiAgICAgKiBwYXVzZVRpbWluZ0xvZyDlgZzmraLmiZPngrks5L+d55WZ6K+l5pe26ZW/54K555qE5Y+C5pWwLOWPr+iiq+mHjeaWsOWQr+WKqAogICAgICogQGV4YW1wbGUKICAgICAqIHViY2xvZ2dlci5wYXVzZVRpbWluZ0xvZygndGltaW5nMScpOwogICAgICogQHBhcmFtIHsqfSBbbGFiZWw9ZGVmYXVsdF0gIOaXtumVv+aJk+eCueW/hemhu+aLpeacieWUr+S4gOeahOWQjeWtl++8jOm7mOiupGRlZmF1bHQKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJwYXVzZVRpbWluZ0xvZyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcGF1c2VUaW1pbmdMb2coKSB7CiAgICAgIHZhciBsYWJlbCA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogJ2RlZmF1bHQnOwogICAgICB2YXIgdGltZXIgPSB0aGlzLnRpbWVyTWFwLmdldChsYWJlbCk7CgogICAgICBpZiAodGltZXIpIHsKICAgICAgICB0aW1lci5zdG9wKCk7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogc3RvcFRpbWluZ0xvZyDlgZzmraLml7bplb/orqHnrpcKICAgICAqIEBleGFtcGxlCiAgICAgKiB1YmNsb2dnZXIuc3RvcFRpbWluZ0xvZygndGltaW5nMScpOwogICAgICogQHBhcmFtIHsqfSBbbGFiZWw9ZGVmYXVsdF0gIOaXtumVv+aJk+eCueW/hemhu+aLpeacieWUr+S4gOeahOWQjeWtl++8jOm7mOiupGRlZmF1bHQKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJzdG9wVGltaW5nTG9nIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzdG9wVGltaW5nTG9nKCkgewogICAgICB2YXIgbGFiZWwgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6ICdkZWZhdWx0JzsKICAgICAgdmFyIHRpbWVyID0gdGhpcy50aW1lck1hcC5nZXQobGFiZWwpOwoKICAgICAgaWYgKHRpbWVyKSB7CiAgICAgICAgdGltZXIuc3RvcCgpOwogICAgICAgIHRoaXMudGltZXJNYXBbImRlbGV0ZSJdKGxhYmVsKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBfcmVnaXN0ZXJQYWdlVmlzaWJpbGl0eSDlnKjpobXpnaLliIfmjaLml7bmmoLlgZzml7bplb/orqHnrpcKICAgICAqIEBwcml2YXRlCiAgICAgKiBAZGVzYyDpobXpnaLlsZXnjrBiZWdpbgogICAgICogQGRlc2Mg6aG16Z2i56a75byAL+WIh+WQjuWPsGVuZAogICAgICovCgogIH0sIHsKICAgIGtleTogIl9yZWdpc3RlclBhZ2VWaXNpYmlsaXR5IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVnaXN0ZXJQYWdlVmlzaWJpbGl0eSgpIHsKICAgICAgdmFyIF90aGlzNCA9IHRoaXM7CgogICAgICByZWdlc3RQYWdlVmlzaWJpbGl0eUV2ZW50KGZ1bmN0aW9uIChpc0hpZGRlbikgewogICAgICAgIGlmIChpc0hpZGRlbikgewogICAgICAgICAgX3RoaXM0LnRpbWVyTWFwLmZvckVhY2goZnVuY3Rpb24gKHRpbWVyKSB7CiAgICAgICAgICAgIGlmICh0aW1lciAmJiB0aW1lci5mbGFnID09PSAnUlVOTklORycpIHsKICAgICAgICAgICAgICB0aW1lci5hdXRvU3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKCiAgICAgICAgICBfdGhpczQubWVyZ2VMb2dnZXIgJiYgX3RoaXM0Lm1lcmdlTG9nZ2VyLmNsZWFyQWxsKCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIF90aGlzNC50aW1lck1hcC5mb3JFYWNoKGZ1bmN0aW9uICh0aW1lcikgewogICAgICAgICAgICBpZiAodGltZXIgJiYgdGltZXIuZmxhZyA9PT0gJ0FVVE9fU1RPUCcpIHsKICAgICAgICAgICAgICB0aW1lci5zdGFydCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogICAgLyoqCiAgICAgKiBnZXRWZXJzaW9uIOiOt+W+l+W9k+WJjXNka+eJiOacrAogICAgICogQHJldHVybiB7c3RyaW5nfSDlvZPliY1zZGvniYjmnKwKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJnZXRWZXJzaW9uIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRWZXJzaW9uKCkgewogICAgICByZXR1cm4gdmVyc2lvbjsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJfcmVnaXN0ZXJCZXRhIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVnaXN0ZXJCZXRhKCkgewogICAgICB2YXIgX3RoaXM1ID0gdGhpczsgLy8g5Y+q5Zyo5omL55m+5Lit5Yqg5YWl5Yik5pat54Gw5bqm5YyF55qE6YC76L6RCgoKICAgICAgaWYgKGlzQm94KCkgJiYgIWlzU3dhbigpKSB7CiAgICAgICAgaXNCZXRhKCkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgICBpZiAocmVzICE9PSBudWxsICYmIHJlcyAhPT0gdm9pZCAwICYmIHJlcy5pc0JldGEpIHsKICAgICAgICAgICAgX3RoaXM1LmlzQmV0YSA9IHRydWU7IC8vIOS/ruaUuXViYyB1cmwKCiAgICAgICAgICAgIF90aGlzNS5zZXQoKTsKICAgICAgICAgIH0KICAgICAgICB9KVsiY2F0Y2giXShmdW5jdGlvbiAoKSB7Ly8gc2FmZQogICAgICAgICAgLy8g5LiN5pSv5oyB6L+Z5Liqc2NoZW1h77yM5oiW6ICF6Z2e5omL55m+77yM5LiN5YGa5Lu75L2V5pON5L2cCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICB9XSk7CgogIHJldHVybiBVYmNMb2dnZXI7Cn0oKTsKLyoqCiAqIEBmaWxlIGVzIOaWh+S7tuWFpeWPowogKiBAYXV0aG9yIGNoYW5neXVxaW5nQGJhaWR1LmNvbQogKi8KCgp2YXIgVWJjTG9nZ2VyID0gVWJjTG9nZ2VyJDE7CmV4cG9ydHMuVWJjTG9nZ2VyID0gVWJjTG9nZ2VyOwp2YXIgdWJjTG9nZ2VyID0gbmV3IFViY0xvZ2dlciQxKCk7CmV4cG9ydHMudWJjTG9nZ2VyID0gdWJjTG9nZ2VyOw=="},{"version":3,"sources":["/Users/a2012/Desktop/list/node_modules/@baidu/feed-baselog/node_modules/@baidu/ubc-report-sdk/dist/ubc-report-sdk.esm.js"],"names":["ownKeys","object","enumerableOnly","keys","Object","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread2","target","i","arguments","length","source","forEach","key","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","_typeof","obj","Symbol","iterator","constructor","prototype","_classCallCheck","instance","Constructor","TypeError","_defineProperties","props","descriptor","configurable","writable","_toPropertyKey","_createClass","protoProps","staticProps","value","_toPrimitive","input","hint","prim","toPrimitive","undefined","res","call","String","Number","arg","getUa","window","navigator","userAgent","e","isBox","ua","IS_LITE_BOX","test","IS_KANDUODUO_BOX","isSwan","getLocation","document","location","href","protocol","origin","pathname","stringify","query","search","hasOwnProperty","JSON","encodeURIComponent","slice","renderUrl","url","indexOf","isObject","type","getUrlQuery","reg","RegExp","regResult","exec","getUrl","params","realParams","item","getCookieByName","sKey","cookie","decodeURIComponent","replace","merge","other","reduce","acc","Array","isArray","getProtocol","includes","CONFIG","UBC_URL","TEST_UBC_URL","DEFAULT_LOG_DATA","cateid","actiondata","id","timestamp","content","page","from","ext","apptype","DEFAULT_QUERY","action","v","appname","cfrom","smfw","CONFIG_MERGE","data","sid","sn","createImg","src","img","createElement","width","height","callbackWaitingTime","imgPing","param","Promise","resolve","reject","isCallbacked","setTimeout","onload","onerror","beaconSend","options","isDataInBody","sendMethod","isSendSuccess","sendBeacon","xhrSend","method","oReq","XMLHttpRequest","addEventListener","status","open","withCredentials","setRequestHeader","send","smartSend","useXhr","useSendBeacon","regestPageVisibilityEvent","handler","hidden","visibilityChange","msHidden","webkitHidden","baiduboxappvisibilitychange","handleVisibilityChange","version","uaRegMap","appid","getAppByName","defaultApp","find","_item","MergeLogger","_ref","_ref$logFn","logFn","logArray","mergeNumMax","mergeInterval","timeId","set","_ref2","add","logData","_this","clearAll","clearTimeout","TimeLogger","_ref$ifHeartbeatTime","ifHeartbeatTime","_ref$duration","duration","starttime","Date","now","intervalId","flag","sendLog","endtime","start","setInterval","stop","clearInterval","autoStop","maxStorageLength","isStorageInit","retryLogLists","setStorage","getStorage","path","pre","cur","time","list","localStorage","setItem","clearStorage","_retryLogLists$origin","parse","getItem","RetryLogger","retryLogList","_getInitErrLogs","retryTimesMax","retryLogListMax","_retryIntervalTimer","logs","Map","map","failTimes","sendCountDown","_getDelayTime","timeMap","Math","floor","random","active","_this2","size","_retryIntervalTimerHandler","addLog","loggerData","loggerId","next","removeLog","updateLog","get","curFailTimes","_this3","logItem","_sendLog","_this4","then","sha256","ascii","rightRotate","amount","maxWord","pow","lengthProperty","j","result","words","asciiBitLength","hash","h","k","primeCounter","isComposite","candidate","charCodeAt","w","oldHash","w15","w2","a","temp1","temp2","concat","b","toString","invokeByIframe","schema","node","style","display","body","appendChild","removeChild","LOW_EXIST","message","isBeta","match","BOX_VERSION","scheme","callback","rejectData","UbcLogger$1","UbcLogger","ubcParams","logInited","timerMap","mergeLogger","retryLogger","_initUbcParams","assign","testMode","_registerPageVisibility","_registerBeta","ubcDefaultLogData","_initCookie","_initUbcUrl","queryParams","beta","debug","ubcUrl","testUrl","ubcMergeUrl","serverId","idfrom","paramsList","_sendMerge","logMergeOpt","logErrRetry","metadata","uploadTimeStamp","_send","baiduId","md5","err","tempLogData","_sendFlow","timing","_getFlowData","_this$options","_this$options$logMerg","ifAutoMerge","sendMergeLog","_this$ubcParams","_this$ubcParams$actio","resultLogData","option","startTimingLog","label","timer","console","warn","pauseTimingLog","stopTimingLog","isHidden","getVersion","_this5","ubcLogger"],"mappings":"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","sourcesContent":["import { versionCompare, toGlobalFunc } from '@baidu/eop-utils';\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    enumerableOnly && (symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    })), keys.push.apply(keys, symbols);\n  }\n  return keys;\n}\nfunction _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = null != arguments[i] ? arguments[i] : {};\n    i % 2 ? ownKeys(Object(source), !0).forEach(function (key) {\n      _defineProperty(target, key, source[key]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) {\n      Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n    });\n  }\n  return target;\n}\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, _typeof(obj);\n}\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor);\n  }\n}\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}\nfunction _defineProperty(obj, key, value) {\n  key = _toPropertyKey(key);\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}\nfunction _toPrimitive(input, hint) {\n  if (typeof input !== \"object\" || input === null) return input;\n  var prim = input[Symbol.toPrimitive];\n  if (prim !== undefined) {\n    var res = prim.call(input, hint || \"default\");\n    if (typeof res !== \"object\") return res;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (hint === \"string\" ? String : Number)(input);\n}\nfunction _toPropertyKey(arg) {\n  var key = _toPrimitive(arg, \"string\");\n  return typeof key === \"symbol\" ? key : String(key);\n}\n\n/**\n * @file 工具方法\n * @author wangbing11(wangbing11@baidu.com)\n */\n\nvar getUa = function getUa() {\n  try {\n    return window.navigator.userAgent;\n  } catch (e) {\n    return '';\n  }\n};\nvar isBox = function isBox() {\n  var ua = getUa();\n  var IS_LITE_BOX = / (lite|info) baiduboxapp\\//i.test(ua);\n  var IS_KANDUODUO_BOX = / mission baiduboxapp\\//i.test(ua);\n  // IS_BOX 标识是否手百基础版内，不能是Lite、不是看多多\n  return / baiduboxapp\\//i.test(ua) && !IS_LITE_BOX && !IS_KANDUODUO_BOX;\n};\nvar isSwan = function isSwan() {\n  var ua = getUa();\n  return /swan/i.test(ua);\n};\nvar getLocation = function getLocation() {\n  try {\n    return document.location;\n  } catch (e) {\n    return {\n      href: '',\n      protocol: 'https:',\n      origin: '',\n      pathname: ''\n    };\n  }\n};\n\n/**\n * 字符串化query\n *\n * [注]：\n * 默认：如果`value`是数组，其`toString`会自动转为逗号分隔的字符串\n * 这里：如果 是 Array 和 Object 参数 都进行 JSON.stringify + encodeURIComponent 了\n *\n * @param {Object} query 查询条件\n * @return {string}\n */\nfunction stringify() {\n  var query = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  if (!query) {\n    return '';\n  }\n  var search = '';\n  for (var key in query) {\n    if (query.hasOwnProperty(key)) {\n      var value = query[key];\n      if (value == null) {\n        value = '';\n      } else if (_typeof(value) === 'object') {\n        value = JSON.stringify(value);\n      }\n      search += '&' + encodeURIComponent(key) + '=' + encodeURIComponent(value);\n    }\n  }\n  return search.slice(1);\n}\n\n/**\n * 在url上加指定参数\n *\n * @param  {string} url  url\n * @param {Object} query 参数对象\n * @example\n * {\n *    a: 1\n * }\n * @return {string}    添加参数后的url\n */\nfunction renderUrl() {\n  var url = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n  var query = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  return url + (~url.indexOf('?') ? '&' : '?') + stringify(query);\n}\n\n/**\n * isObject\n *\n * @param {*} value value\n * @return {boolean} 如果是对象则返回 true, 否则 false\n */\nfunction isObject(value) {\n  // Avoid a V8 JIT bug in Chrome 19-20.\n  // See https://code.google.com/p/v8/issues/detail?id=2291 for more details.\n  var type = _typeof(value);\n  return type === 'function' || !!value && type === 'object';\n}\n\n/**\n * getUrlQuery  从url中获取query对象\n *\n * @param   {Object} key urlQuery中获得key对应的参数，如果不传则返回整个query对象\n * @return  {string | Object} queryStr 或 整个query对象\n */\nvar getUrlQuery = function getUrlQuery(key) {\n  var url = getLocation().href;\n  var reg = new RegExp('[\\\\?&]([^\\\\?&\\\\=\\\\/]+)=([^\\\\?\\\\&\\\\=\\\\/]*)', 'g');\n  var query = {};\n  var regResult;\n  while ((regResult = reg.exec(url)) !== null) {\n    query[regResult[1]] = regResult[2];\n  }\n  if (key) {\n    return query[key];\n  } else {\n    return query;\n  }\n};\n\n/**\n * getUrl\n *\n * @param   {string}  url       请求url\n * @param   {Object}  params    参数\n * @return  {string}  更新url(过滤为空的参数)\n */\nvar getUrl = function getUrl(url, params) {\n  var realParams = {};\n  Object.keys(params).forEach(function (item) {\n    // TODO params[item]是不是有可能为0\n    params[item] && (realParams[item] = params[item]);\n  });\n  if (Object.keys(realParams).length === 0) {\n    return url;\n  }\n  return renderUrl(url, realParams);\n};\n\n/**\n * 获得key对应的cookie值\n * @param {string} sKey cookie的key\n * @return {string} cookie的value\n */\nvar getCookieByName = function getCookieByName(sKey) {\n  var cookie = document.cookie || '';\n  return decodeURIComponent(cookie.replace(new RegExp('(?:(?:^|.*;)\\\\s*' + encodeURIComponent(sKey).replace(/[-.+*]/g, '\\\\$&') + '\\\\s*\\\\=\\\\s*([^;]*).*$)|^.*$'), '$1')) || '';\n};\n\n/**\n * 获得key对应的cookie值\n * @param {any} source merge的第一个对象\n * @param {any} other merge的第二个对象\n * @return {any} merge后的对象\n */\nvar merge = function merge(source, other) {\n  if (!isObject(source) || !isObject(other)) {\n    return other === undefined ? source : other;\n  }\n  // 合并两个对象的 key，另外要区分数组的初始值为 []\n  return Object.keys(_objectSpread2(_objectSpread2({}, source), other)).reduce(function (acc, key) {\n    // 递归合并 value\n    acc[key] = merge(source[key], other[key]);\n    return acc;\n  }, Array.isArray(source) ? [] : {});\n};\n\n/**\n * @file ubcLog的conf配置\n * @author songzimei<songzimei@baidu.com>\n */\n\nvar getProtocol = function getProtocol() {\n  if (['http:', 'https:'].includes(getLocation().protocol)) {\n    return getLocation().protocol;\n  }\n  return 'https:';\n};\nvar CONFIG = {\n  UBC_URL: getProtocol() + '//h2tcbox.baidu.com/ztbox',\n  TEST_UBC_URL: 'http://bjyz-mco-searchbox201609-m12xi3-044.bjyz.baidu.com:8080/ztbox',\n  DEFAULT_LOG_DATA: {\n    cateid: '99',\n    actiondata: {\n      // 外部填写（ubcID）\n      id: '0',\n      // 日志类型：0—事件类（web类）1—流类型（客户端)\n      type: '0',\n      timestamp: 0,\n      content: {\n        // 页面名称\n        page: '-',\n        // 区块位置\n        type: '-',\n        // 页面来源\n        value: '-',\n        // 资源来源\n        source: 'default',\n        // 日志类型\n        from: 'act',\n        // 扩展字段\n        ext: {\n          apptype: '-'\n        }\n      }\n    }\n  },\n  DEFAULT_QUERY: {\n    action: 'zpblog',\n    v: '2.0',\n    appname: 'baiduboxapp',\n    from: '',\n    cfrom: '',\n    smfw: ''\n  }\n};\nvar CONFIG_MERGE = {\n  UBC_URL: getLocation().protocol + '//h2tcbox.baidu.com/ztbox',\n  TEST_UBC_URL: 'http://bjyz-mco-searchbox201609-m12xi3-044.bjyz.baidu.com:8080/ztbox',\n  DEFAULT_LOG_DATA: {\n    cateid: '101',\n    data: []\n  },\n  DEFAULT_QUERY: {\n    action: 'mpblog',\n    v: '2.0',\n    appname: 'baiduboxapp',\n    from: '',\n    cfrom: '',\n    smfw: '',\n    sid: '',\n    sn: ''\n  }\n};\n\n/**\n * @file send 方法\n * @author wangbing11(wangbing11@baidu.com)\n */\nvar createImg = function createImg(src) {\n  var img = document.createElement('img');\n  img.width = 1;\n  img.height = 1;\n  img.src = src;\n  return img;\n};\n\n// 回调函数等待时间\nvar callbackWaitingTime = 100;\n\n/**\n * 使用图片来发请求\n *\n * @param {string} url 上报服务地址\n * @param {Object} param 上报的数据\n * @return {Promise} 结束回调\n */\nfunction imgPing(url, param) {\n  return new Promise(function (resolve, reject) {\n    // 生成URL\n    url = renderUrl(url, {\n      data: param\n    });\n    var img = createImg(url);\n    var isCallbacked = false;\n\n    // 等待 100 ms， 100ms后如果回调函数还没有执行，就立即执行回调\n    setTimeout(function () {\n      if (!isCallbacked) {\n        resolve();\n        isCallbacked = true;\n      }\n    }, callbackWaitingTime);\n    img.onload = img.onerror = function () {\n      img = null;\n      // 上报成功后，如果回调函数还没有执行，就执行回调函数\n      if (!isCallbacked) {\n        resolve();\n        isCallbacked = true;\n      }\n    };\n  });\n}\n\n/**\n * 使用Navigator.sendBeacon来发请求\n *\n * @param {string} url 上报服务地址\n * @param {Object} param 上报的数据\n * @param {Object} options 上报格式\n * @return {Promise} 结束回调\n */\nfunction beaconSend(url, param, options) {\n  return new Promise(function (resolve, reject) {\n    var isDataInBody = options.sendMethod === 'post';\n    var isSendSuccess;\n    if (isDataInBody) {\n      isSendSuccess = window.navigator.sendBeacon(renderUrl(url, {\n        data: param\n      }));\n    } else {\n      isSendSuccess = window.navigator.sendBeacon(url, 'data=' + encodeURIComponent(JSON.stringify(param)));\n    }\n\n    // 生成URL\n    if (isSendSuccess) {\n      resolve();\n    } else {\n      reject();\n    }\n  });\n}\nfunction xhrSend(url, param) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  var method = options.sendMethod === 'post' ? 'POST' : 'GET';\n  url = method === 'POST' ? url : renderUrl(url, {\n    data: param\n  });\n  return new Promise(function (resolve, reject) {\n    var oReq = new XMLHttpRequest();\n    oReq.addEventListener('loadend', function () {\n      if (oReq.status === 200) {\n        resolve();\n      } else {\n        reject();\n      }\n    });\n    oReq.open(method, url);\n    oReq.withCredentials = true;\n    if (method === 'POST') {\n      oReq.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\n      oReq.send('data=' + encodeURIComponent(JSON.stringify(param)));\n    } else {\n      oReq.send();\n    }\n  });\n}\n\n/**\n * 使用图片来发请求\n *\n * @param {string} url 上报服务地址\n * @param {Object} param 上报的数据\n * @param {Object} [options] 额外参数\n * @param {Object} [options.useSendBeacon] 是否使用sendBeancon\n * @param {boolean} [options.useXhr] 是否使用useXhr\n * @param {string} [options.sendMethod] post/get\n * @return {Promise} 结束回调\n */\nfunction smartSend(url, param) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  if (options.useXhr) {\n    return xhrSend(url, param, options);\n  }\n  // 与数据RD沟通，待数据组升级后可启用-在好看和全民端sendBeacon无效\n  if (typeof window.navigator.sendBeacon === 'function' && options.useSendBeacon) {\n    return beaconSend(url, param, options);\n  }\n  return imgPing(url, param);\n}\n\n/**\n * @file send 方法\n * @author wangbing11(wangbing11@baidu.com)\n */\n\n// Set the name of the hidden property and the change event for visibility\n\nfunction regestPageVisibilityEvent(handler) {\n  try {\n    var hidden;\n    var visibilityChange;\n    if (typeof document.hidden !== 'undefined') {\n      // Opera 12.10 and Firefox 18 and later support\n      hidden = 'hidden';\n      visibilityChange = 'visibilitychange';\n    } else if (typeof document.msHidden !== 'undefined') {\n      hidden = 'msHidden';\n      visibilityChange = 'msvisibilitychange';\n    } else if (typeof document.webkitHidden !== 'undefined') {\n      hidden = 'webkitHidden';\n      visibilityChange = 'webkitvisibilitychange';\n    } else if (typeof document.baiduboxappvisibilitychange !== 'undefined') {\n      hidden = 'webkitHidden';\n      visibilityChange = 'webkitvisibilitychange';\n    }\n    var handleVisibilityChange = function handleVisibilityChange() {\n      handler(!!document[hidden]);\n    };\n    if (typeof document.addEventListener === 'undefined' || hidden === undefined) {\n      return;\n    }\n    // Handle page visibility change\n    document.addEventListener(visibilityChange, handleVisibilityChange, false);\n  } catch (e) {}\n}\n\nvar version = \"3.3.3\";\n\n/**\n * @file 通过UA获得当前宿主信息\n * @author changyuqing\n */\nvar uaRegMap = [{\n  // name: '看多多',\n  appname: 'baiduboxmission',\n  reg: /\\bmission\\sbaiduboxapp\\b/i,\n  appid: \"10006\"\n}, {\n  // name: '百度APP极速版',\n  appname: 'baiduboxlite',\n  reg: /\\b(?:lite|info) baiduboxapp\\b/i,\n  appid: \"10001\"\n}, {\n  // name: '百度APP',\n  appname: 'baiduboxapp',\n  reg: /\\bbaiduboxapp\\b/i,\n  appid: \"1\"\n}, {\n  // name: '百度贴吧',\n  appname: 'tieba',\n  reg: /\\btieba\\b/i,\n  appid: \"11001\"\n}, {\n  // name: '好看视频',\n  appname: 'haokan',\n  reg: /\\bhaokan\\b/i,\n  appid: \"11000\"\n}, {\n  // name: '全民小视频',\n  appname: 'quanmin',\n  reg: /\\bbdminivideo\\b/i,\n  appid: \"12022\"\n}, {\n  // name: '百度地图',\n  appname: 'bdmap',\n  reg: /\\bbaidumap_/i,\n  appid: \"11006\"\n}, {\n  // name: '百度网盘',\n  appname: 'wangpan',\n  reg: /\\bnetdisk;/i,\n  appid: \"12018\"\n}, {\n  // name: '宝宝知道',\n  appname: 'askmybaby',\n  reg: /\\bmybaby\\//i,\n  appid: \"12019\"\n}, {\n  // name: '西番',\n  appname: 'xifan',\n  reg: /\\bbdxifan\\//i,\n  appid: \"12006\"\n}, {\n  appid: \"12031\",\n  // name: '百度手机助手',\n  appname: 'sowhat'\n}, {\n  appid: \"12010\",\n  // name: '柠檬爱美',\n  appname: 'lemon',\n  reg: /lemonapp/i\n}, {\n  appid: \"12015\",\n  // name: '百家号APP',\n  appname: 'baijiahao'\n}, {\n  appid: \"12012\",\n  // name: '番乐',\n  appname: 'fanle'\n}, {\n  appid: \"12013\",\n  // name: '古物潮玩',\n  appname: 'zhaocaimao'\n}, {\n  appid: \"12014\",\n  // name: '分玩',\n  appname: 'gamenow'\n}, {\n  appid: \"12016\",\n  // name: '爱奇艺',\n  appname: 'iqiyi'\n}, {\n  appid: \"12017\",\n  // name: '百度百科',\n  appname: 'baike'\n}, {\n  appid: \"12023\",\n  // name: '新流',\n  appname: 'flow'\n}, {\n  appid: \"12026\",\n  // name: 'Robotaxi约车',\n  appname: 'dutaxi'\n}, {\n  appid: \"12011\",\n  // name: '有驾APP',\n  appname: 'youjia'\n}, {\n  appid: \"12020\",\n  // name: '内容联盟',\n  appname: 'feedsunion'\n}, {\n  appid: \"12021\",\n  // name: '一刻相册',\n  appname: 'album'\n}, {\n  appid: \"12024\",\n  // name: '页游平台',\n  appname: 'webgame'\n}, {\n  appid: \"12027\",\n  // name: 'HMI乘客端',\n  appname: 'hmi_passenger'\n}, {\n  appid: \"12028\",\n  // name: '百度文库',\n  appname: 'bdwenku'\n}, {\n  appid: \"12029\",\n  // name: '百度翻译',\n  appname: 'fanyi'\n}, {\n  appid: \"12030\",\n  // name: '百度知道',\n  appname: 'iknow'\n}, {\n  appid: \"12025\",\n  // name: '度晓晓',\n  appname: 'duxiaoxiao'\n}, {\n  appid: \"12032\",\n  // name: '百度汉语',\n  appname: 'baiduhanyu'\n}, {\n  appid: \"12034\",\n  // name: '百度经验',\n  appname: 'exp'\n}, {\n  appid: \"12036\",\n  // name: 'APP DEMO',\n  appname: 'demo'\n}, {\n  appid: \"12037\",\n  // name: '百度阅读',\n  appname: 'baiduyuedu'\n}, {\n  appid: \"12038\",\n  // name: '健康管理',\n  appname: 'cdm'\n}, {\n  appid: \"12040\",\n  // name: '微叭伴聊',\n  appname: 'weiba'\n}, {\n  appid: \"12041\",\n  // name: '百度视频版',\n  appname: 'baiduboxvision'\n}, {\n  appid: \"12042\",\n  // name: '嘻哈',\n  appname: 'hiphop'\n}, {\n  appid: \"12043\",\n  // name: 'robobus控制终端',\n  appname: 'robobus-panel'\n}, {\n  appid: \"12044\",\n  // name: '文库大学生版',\n  appname: 'wenkustudent'\n}, {\n  appid: \"12045\",\n  // name: '百度PC直播',\n  appname: 'pc_live'\n}, {\n  appid: \"12049\",\n  // name: '云上百度',\n  appname: 'yunshangbaidu'\n}, {\n  appid: \"12050\",\n  // name: '百度文库PC客户端',\n  appname: 'baiduwenku_pc'\n}, {\n  appid: \"12051\",\n  // name: '音磁',\n  appname: 'yinci'\n}, {\n  appid: \"12052\",\n  // name: '小说书城',\n  appname: 'novel'\n}, {\n  appid: \"12054\",\n  // name: '有噗',\n  appname: 'yoopu'\n}, {\n  appid: \"12057\",\n  // name: '音啵',\n  appname: 'yinbo'\n}, {\n  appid: \"12062\",\n  // name: '爱企查',\n  appname: 'aiqicha'\n}, {\n  appid: \"12066\",\n  // name: '轻竹健康',\n  appname: 'Bamboo_Health'\n}, {\n  appid: \"12067\",\n  // name: '轻竹健康医生版',\n  appname: 'Bamboo_Health_Dr'\n}, {\n  appid: \"12073\",\n  // name: '小度',\n  appname: 'superduer'\n}, {\n  appid: \"12074\",\n  // name: '百度健康',\n  appname: 'baidujiankangapp'\n}, {\n  appid: \"12075\",\n  // name: '百度爱番番',\n  appname: 'bdcrm_aifanfan'\n}, {\n  appid: \"12077\",\n  // name: '拇指医生(医生版)',\n  appname: 'muzhidoctor'\n}, {\n  appid: \"12079\",\n  // name: 'Apollo GO',\n  appname: 'apollogo'\n}, {\n  appid: \"12080\",\n  // name: '律临',\n  appname: 'lvlin'\n}, {\n  appid: \"12083\",\n  // name: '爱采购卖家版',\n  appname: 'aipurchase'\n}, {\n  appid: \"12088\",\n  // name: '百度CarLife',\n  appname: 'BaiDuCarLife'\n}, {\n  appid: \"12090\",\n  // name: '百度健康tt',\n  appname: 'baidujiankangtt'\n}, {\n  appid: \"12092\",\n  // name: '如流',\n  appname: 'infoflow',\n  reg: /\\bbaiduhi/i\n}, {\n  appid: \"12094\",\n  // name: 'hmi driver',\n  appname: 'hmi_driver'\n}, {\n  appid: \"12095\",\n  // name: '百度VR智慧云展',\n  appname: 'vr_expo'\n}, {\n  appid: \"12096\",\n  // name: '内容电商小程序',\n  appname: 'content_ecommerce'\n}, {\n  appid: \"12097\",\n  // name: '百度VR播控服务',\n  appname: 'play_control'\n}, {\n  appid: \"12098\",\n  // name: '爱采购买家版',\n  appname: 'aipurchaser'\n}, {\n  appid: \"12101\",\n  // name: '地图淘金',\n  appname: 'ditutaojin'\n}, {\n  appid: \"12102\",\n  // name: '高精定位SDK',\n  appname: 'hp_location'\n}, {\n  appid: \"12106\",\n  // name: '一起吧',\n  appname: 'chatroom'\n}, {\n  appid: \"12107\",\n  // name: 'Gaia数据App',\n  appname: 'gaia'\n}, {\n  appid: \"12108\",\n  // name: 'UBI商业数据App',\n  appname: 'ubi'\n}, {\n  appid: \"12109\",\n  // name: '一局',\n  appname: 'yiju'\n}, {\n  appid: \"12111\",\n  // name: '全功能AI开发平台',\n  appname: 'bml'\n}, {\n  appid: \"12112\",\n  // name: '智慧家庭助手',\n  appname: 'aihome'\n}, {\n  appid: \"12113\",\n  // name: '智慧家庭助手-孩子端',\n  appname: 'aihome_children'\n}, {\n  appid: \"12114\",\n  // name: '百度手机卫士',\n  appname: 'mobsecurity'\n}, {\n  appid: \"12117\",\n  // name: '百度APP大字版',\n  appname: 'tomas'\n}, {\n  appid: \"12118\",\n  // name: 'flutter中台',\n  appname: 'baidu_flutter'\n}, {\n  appid: \"12120\",\n  // name: '播客',\n  appname: 'wepod'\n}, {\n  appid: \"12121\",\n  // name: 'YY直播_非百度',\n  appname: 'yy'\n}, {\n  appid: \"12122\",\n  // name: '萌懂教育',\n  appname: 'kidedu'\n}, {\n  appid: \"12123\",\n  // name: '网盘极速版',\n  appname: 'wangpan_faster'\n}, {\n  appid: \"12124\",\n  // name: '随声',\n  appname: 'wepod_mobile'\n}, {\n  appid: \"12125\",\n  // name: '百度VR教育桌面应用',\n  appname: 'baidu_vr_classroom_launcher'\n}, {\n  appid: '12407',\n  // 好看急速版\n  appname: 'bdhkvideo'\n}];\n/**\n * 通过appname或者ua获得对应的appid\n * @param {string} [appname] 传入的appname\n * @link http://app.baidu-int.com/console/application/clientlist\n */\nvar getAppByName = function getAppByName() {\n  var appname = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n  var defaultApp = {\n    appname: 'other',\n    appid: \"12133\"\n  };\n  if (appname) {\n    var item = uaRegMap.find(function (item) {\n      return appname === item.appname;\n    });\n    return item ? item : defaultApp;\n  } else {\n    var ua = getUa();\n    var _item = uaRegMap.find(function (item) {\n      if (item.reg) {\n        return item.reg.test(ua);\n      } else {\n        return ua.search(item.appname) !== -1;\n      }\n    });\n    return _item ? _item : defaultApp;\n  }\n};\n\n/**\n * @file MergeLogger\n *\n * @author changyuqing@baidu.com\n */\n\nvar MergeLogger = /*#__PURE__*/function () {\n  function MergeLogger(_ref) {\n    var _ref$logFn = _ref.logFn,\n      logFn = _ref$logFn === void 0 ? function () {} : _ref$logFn;\n    _classCallCheck(this, MergeLogger);\n    this.logFn = logFn;\n    this.logArray = [];\n    this.mergeNumMax = 5;\n    this.mergeInterval = 5;\n    this.timeId = null;\n  }\n  _createClass(MergeLogger, [{\n    key: \"set\",\n    value: function set(_ref2) {\n      var mergeNumMax = _ref2.mergeNumMax,\n        mergeInterval = _ref2.mergeInterval;\n      if (mergeNumMax) {\n        this.mergeNumMax = mergeNumMax;\n      }\n      if (mergeInterval) {\n        this.mergeInterval = mergeInterval;\n      }\n    }\n  }, {\n    key: \"add\",\n    value: function add(logData) {\n      var _this = this;\n      this.logArray.push(logData);\n      if (this.logArray.length === 1) {\n        // 如果是进入队列的第一个日志，此时开启一个定时器\n        this.timeId = setTimeout(function () {\n          _this.clearAll();\n        }, this.mergeInterval * 1000);\n      } else if (this.logArray.length >= this.mergeNumMax) {\n        // 如果进入队列的日志个数达到上限，就直接发送\n        this.clearAll();\n      }\n    }\n  }, {\n    key: \"clearAll\",\n    value: function clearAll() {\n      if (this.logArray.length > 0) {\n        // 如果队列里面存在待发送的日志，调用发送函数进行发送\n        this.logFn(this.logArray);\n        // 清空日志队列\n        this.logArray = [];\n      }\n      if (this.timeId) {\n        clearTimeout(this.timeId);\n        this.timeId = null;\n      }\n    }\n  }]);\n  return MergeLogger;\n}();\n\n/**\n * @file TimeLogger\n *\n * @author changyuqing@baidu.com\n */\n\nvar TimeLogger = /*#__PURE__*/function () {\n  /**\n   * @constructor TimeLogger\n   * @param  {Object} [options]  打点设置，覆盖全局设置\n   * @param  {boolean} [options.ifHeartbeatTime]  是否通过心跳打点\n   * @param  {number} [options.duration]  心跳打点的间隔，单位s\n   * @param  {Function} [options.logFn]  向外抛事件的函数\n   */\n  function TimeLogger(_ref) {\n    var _ref$ifHeartbeatTime = _ref.ifHeartbeatTime,\n      ifHeartbeatTime = _ref$ifHeartbeatTime === void 0 ? true : _ref$ifHeartbeatTime,\n      _ref$duration = _ref.duration,\n      duration = _ref$duration === void 0 ? 3 : _ref$duration,\n      _ref$logFn = _ref.logFn,\n      logFn = _ref$logFn === void 0 ? function () {} : _ref$logFn;\n    _classCallCheck(this, TimeLogger);\n    this.starttime = Date.now(); // 开始时间\n    this.ifHeartbeatTime = ifHeartbeatTime; // 是否心跳打点\n    this.logFn = logFn; // 打点方法\n    this.intervalId = null;\n    this.duration = duration;\n    this.flag = 'STOP'; // 状态有 RUNNING STOP AUTO_STOP\n  }\n  _createClass(TimeLogger, [{\n    key: \"sendLog\",\n    value: function sendLog() {\n      if (this.ifHeartbeatTime) {\n        this.logFn({\n          starttime: this.starttime,\n          duration: this.duration\n        });\n      } else {\n        var endtime = Date.now();\n        this.logFn({\n          starttime: this.starttime,\n          duration: (endtime - this.starttime) / 1000,\n          endtime: endtime\n        });\n      }\n    }\n  }, {\n    key: \"start\",\n    value: function start() {\n      var _this = this;\n      if (this.flag !== 'RUNNING') {\n        this.flag = 'RUNNING';\n        this.starttime = Date.now();\n        if (this.ifHeartbeatTime) {\n          this.sendLog();\n          this.intervalId = setInterval(function () {\n            _this.sendLog();\n          }, this.duration * 1000);\n        }\n      }\n    }\n  }, {\n    key: \"stop\",\n    value: function stop() {\n      if (this.flag === 'RUNNING') {\n        if (this.ifHeartbeatTime) {\n          this.sendLog();\n          clearInterval(this.intervalId);\n          this.intervalId = null;\n        } else {\n          this.sendLog();\n        }\n        this.flag = 'STOP';\n      }\n    }\n  }, {\n    key: \"autoStop\",\n    value: function autoStop() {\n      if (this.flag === 'RUNNING') {\n        this.stop();\n        this.flag = 'AUTO_STOP';\n      }\n    }\n  }]);\n  return TimeLogger;\n}();\n\n/**\n * @file 打点重试机制\n * @author changyuqing@baidu.com\n *\n */\nvar maxStorageLength = 5;\nvar isStorageInit = false;\nvar origin = '';\nvar retryLogLists = null;\nfunction setStorage(value) {\n  if (!isStorageInit) {\n    getStorage();\n  }\n  var now = Date.now();\n  if (!retryLogLists[origin]) {\n    // retryLogLists 中不存在当前页面对应的列表\n    // 如果retryLogLists里面存放过多，则删除最旧的记录\n    if (retryLogLists.length >= maxStorageLength) {\n      var path = Object.keys(retryLogLists).reduce(function (pre, cur) {\n        if (retryLogLists[cur] !== 'length' && retryLogLists[cur].time <= pre.time) {\n          return {\n            time: retryLogLists[cur].time,\n            path: cur\n          };\n        }\n        return pre;\n      }, {\n        time: now,\n        path: ''\n      }).path;\n      delete retryLogLists[path];\n    } else {\n      retryLogLists.length++;\n    }\n  }\n  retryLogLists[origin] = {\n    list: value,\n    time: now\n  };\n  localStorage.setItem('RETRY_LOG_LIST', JSON.stringify(retryLogLists));\n}\nfunction clearStorage() {\n  if (!isStorageInit) {\n    getStorage();\n  }\n  if (retryLogLists[origin]) {\n    delete retryLogLists[origin];\n    retryLogLists.length--;\n  }\n  localStorage.setItem('RETRY_LOG_LIST', JSON.stringify(retryLogLists));\n}\nfunction getStorage() {\n  var _retryLogLists$origin;\n  if (!isStorageInit) {\n    isStorageInit = true;\n    origin = getLocation().origin + getLocation().pathname;\n  }\n  try {\n    retryLogLists = JSON.parse(localStorage.getItem('RETRY_LOG_LIST')) || {\n      length: 0\n    };\n  } catch (e) {\n    retryLogLists = {\n      length: 0\n    };\n  }\n  return ((_retryLogLists$origin = retryLogLists[origin]) === null || _retryLogLists$origin === void 0 ? void 0 : _retryLogLists$origin.list) || [];\n}\nvar RetryLogger = /*#__PURE__*/function () {\n  function RetryLogger(_ref) {\n    var _ref$logFn = _ref.logFn,\n      logFn = _ref$logFn === void 0 ? function () {} : _ref$logFn;\n    _classCallCheck(this, RetryLogger);\n    this.logFn = logFn;\n    this.retryLogList = this._getInitErrLogs();\n    this.retryTimesMax = 3; // 最大重发次数\n    this.retryLogListMax = 5; // 重试队列最大长度\n    this._retryIntervalTimer = null;\n  }\n\n  // 从storage中读取遗留的日志\n  _createClass(RetryLogger, [{\n    key: \"_getInitErrLogs\",\n    value: function _getInitErrLogs() {\n      var _this = this;\n      var logs = getStorage();\n      return new Map(logs.map(function (item) {\n        return [item[0], _objectSpread2(_objectSpread2({}, item[1]), {}, {\n          failTimes: 1,\n          sendCountDown: _this._getDelayTime(item.failTimes)\n        })];\n      }));\n    }\n  }, {\n    key: \"_getDelayTime\",\n    value: function _getDelayTime(failTimes) {\n      // 延迟重发时间的配置。连续失败次数越多，发送延迟越久\n      var timeMap = {\n        0: 1,\n        // s\n        1: 1,\n        2: 5\n      };\n      return timeMap[failTimes] || 10 + Math.floor(Math.random() * 5 + 1);\n    }\n  }, {\n    key: \"active\",\n    value: function active() {\n      var _this2 = this;\n      if (!this._retryIntervalTimer && this.retryLogList.size > 0) {\n        this._retryIntervalTimer = setInterval(function () {\n          _this2._retryIntervalTimerHandler();\n        }, 1000);\n      }\n    }\n  }, {\n    key: \"addLog\",\n    value: function addLog(_ref2) {\n      var url = _ref2.url,\n        loggerData = _ref2.loggerData,\n        loggerId = _ref2.loggerId;\n      this.retryLogList.set(loggerId, {\n        url: url,\n        loggerData: loggerData,\n        loggerId: loggerId,\n        failTimes: 1,\n        sendCountDown: this._getDelayTime(1)\n      });\n      // 超出最大长度时 取出队列中最久的一条\n      if (this.retryLogList.size > this.retryLogListMax) {\n        var key = this.retryLogList.keys().next().value;\n        this.retryLogList[\"delete\"](key);\n      }\n      this.active();\n      // 把更新的数据更新到本地存储\n      setStorage(Array.from(this.retryLogList));\n    }\n  }, {\n    key: \"removeLog\",\n    value: function removeLog(loggerId) {\n      if (!loggerId) {\n        return;\n      }\n      if (this.retryLogList[\"delete\"](loggerId)) {\n        if (this.retryLogList.size === 0) {\n          clearStorage();\n        } else {\n          // 更新本地缓存\n          setStorage(this.retryLogList);\n        }\n      }\n    }\n  }, {\n    key: \"updateLog\",\n    value: function updateLog(loggerId) {\n      if (!loggerId) {\n        return;\n      }\n      var item = this.retryLogList.get(loggerId);\n      if (item) {\n        var curFailTimes = item.failTimes;\n        // 如果超过最大重试次数 则不再重发 从队列中删除\n        if (curFailTimes + 1 > this.retryTimesMax) {\n          this.removeLog(loggerId);\n        } else {\n          item.failTimes = curFailTimes + 1;\n          item.sendCountDown = this._getDelayTime(item.failTimes);\n        }\n      }\n    }\n  }, {\n    key: \"_retryIntervalTimerHandler\",\n    value: function _retryIntervalTimerHandler() {\n      var _this3 = this;\n      this.retryLogList.forEach(function (logItem) {\n        // 倒计时为-1时 表示该条日志正在被重新发送\n        if (logItem.sendCountDown < 0) {\n          return;\n        } else if (+logItem.sendCountDown === 0) {\n          // 倒计时已到 执行再次发送\n          logItem.sendCountDown = -1; // 设置其正在方法\n          _this3._sendLog(logItem);\n        } else {\n          // 倒计时计时 -1\n          logItem.sendCountDown = logItem.sendCountDown - 1;\n        }\n      });\n      if (this.retryLogList.size === 0) {\n        clearInterval(this._retryIntervalTimer);\n        this._retryIntervalTimer = null;\n      }\n    }\n  }, {\n    key: \"_sendLog\",\n    value: function _sendLog(logItem) {\n      var _this4 = this;\n      this.logFn(logItem.url, logItem.loggerData).then(function () {\n        _this4.removeLog(logItem.loggerId);\n      })[\"catch\"](function () {\n        _this4.updateLog(logItem.loggerId);\n      });\n    }\n  }]);\n  return RetryLogger;\n}();\n\n/**\n * @file sha256 简化的sha256算法\n * @author geraintluff\n * @link https://github.com/geraintluff/sha256\n */\n\nvar sha256 = function sha256(ascii) {\n  function rightRotate(value, amount) {\n    return value >>> amount | value << 32 - amount;\n  }\n  var maxWord = Math.pow(2, 32);\n  var lengthProperty = 'length';\n  var i, j; // Used as a counter across the whole file\n  var result = '';\n  var words = [];\n  var asciiBitLength = ascii[lengthProperty] * 8;\n\n  //* caching results is optional - remove/add slash from front of this line to toggle\n  // Initial hash value: first 32 bits of the fractional parts of the square roots of the first 8 primes\n  // (we actually calculate the first 64, but extra values are just ignored)\n  var hash = sha256.h = sha256.h || [];\n  // Round constants: first 32 bits of the fractional parts of the cube roots of the first 64 primes\n  var k = sha256.k = sha256.k || [];\n  var primeCounter = k[lengthProperty];\n  /*/\n   var hash = [], k = [];\n   var primeCounter = 0;\n   //*/\n\n  var isComposite = {};\n  for (var candidate = 2; primeCounter < 64; candidate++) {\n    if (!isComposite[candidate]) {\n      for (i = 0; i < 313; i += candidate) {\n        isComposite[i] = candidate;\n      }\n      hash[primeCounter] = Math.pow(candidate, .5) * maxWord | 0;\n      k[primeCounter++] = Math.pow(candidate, 1 / 3) * maxWord | 0;\n    }\n  }\n  ascii += '\\x80'; // Append Ƈ' bit (plus zero padding)\n  while (ascii[lengthProperty] % 64 - 56) ascii += '\\x00'; // More zero padding\n  for (i = 0; i < ascii[lengthProperty]; i++) {\n    j = ascii.charCodeAt(i);\n    if (j >> 8) return; // ASCII check: only accept characters in range 0-255\n    words[i >> 2] |= j << (3 - i) % 4 * 8;\n  }\n  words[words[lengthProperty]] = asciiBitLength / maxWord | 0;\n  words[words[lengthProperty]] = asciiBitLength;\n\n  // process each chunk\n  for (j = 0; j < words[lengthProperty];) {\n    var w = words.slice(j, j += 16); // The message is expanded into 64 words as part of the iteration\n    var oldHash = hash;\n    // This is now the undefined working hash\", often labelled as variables a...g\n    // (we have to truncate as well, otherwise extra entries at the end accumulate\n    hash = hash.slice(0, 8);\n    for (i = 0; i < 64; i++) {\n      // let i2 = i + j;\n      // Expand the message into 64 words\n      // Used below if\n      var w15 = w[i - 15],\n        w2 = w[i - 2];\n\n      // Iterate\n      var a = hash[0],\n        e = hash[4];\n      var temp1 = hash[7] + (rightRotate(e, 6) ^ rightRotate(e, 11) ^ rightRotate(e, 25)) // S1\n      + (e & hash[5] ^ ~e & hash[6]) // ch\n      + k[i]\n      // Expand the message schedule if needed\n      + (w[i] = i < 16 ? w[i] : w[i - 16] + (rightRotate(w15, 7) ^ rightRotate(w15, 18) ^ w15 >>> 3) // s0\n      + w[i - 7] + (rightRotate(w2, 17) ^ rightRotate(w2, 19) ^ w2 >>> 10) // s1\n      | 0);\n      // This is only used once, so *could* be moved below, but it only saves 4 bytes and makes things unreadble\n      var temp2 = (rightRotate(a, 2) ^ rightRotate(a, 13) ^ rightRotate(a, 22) // S0\n      ) + (a & hash[1] ^ a & hash[2] ^ hash[1] & hash[2]); // maj\n\n      hash = [temp1 + temp2 | 0].concat(hash); // We don't bother trimming off the extra ones, they're harmless as long as we're truncating when we do the slice()\n      hash[4] = hash[4] + temp1 | 0;\n    }\n    for (i = 0; i < 8; i++) {\n      hash[i] = hash[i] + oldHash[i] | 0;\n    }\n  }\n  for (i = 0; i < 8; i++) {\n    for (j = 3; j + 1; j--) {\n      var b = hash[i] >> j * 8 & 255;\n      result += (b < 16 ? 0 : '') + b.toString(16);\n    }\n  }\n  return result;\n};\n\nfunction invokeByIframe(schema) {\n  var node = document.createElement('iframe'); // tslint:disable-line\n  node.style.display = 'none';\n  node.src = schema;\n  var body = document.body;\n  body.appendChild(node);\n  // 销毁 iframe\n  setTimeout(function () {\n    body.removeChild(node);\n    node = null;\n  }, 0);\n}\n\n/**\n * @file App灰度包判断 （限手百）\n * @author liuyaqian02 <liuyaqian02@baidu.com>\n */\nvar LOW_EXIST = {\n  status: 101,\n  message: '该版本不支持此端能力'\n};\n/**\n * @see http://es.baidu-int.com/#/apidetail/1809\n * @resolve {Object} data 端返回的data参数\n * @resolve {String} data.isBata 是否为灰度包 true|false\n *\n * @reject {Object} rejectData 端返回的失败回调信息\n * @reject {String} rejectData.status 失败状态码\n * @reject {String} rejectData.message 失败说明\n */\nfunction isBeta() {\n  return new Promise(function (resolve, reject) {\n    var ua = getUa();\n    var match = /baiduboxapp\\/([\\d+.]+)/.exec(ua);\n    var BOX_VERSION = match && match[1] || '0';\n    // 版本小于12.20.0.0，提示101 该版本不支持此端能力\n    if (versionCompare(BOX_VERSION, '12.20.0.0') < 0) {\n      reject(LOW_EXIST);\n      return;\n    }\n    var scheme = \"baiduboxapp://app/isBeta?callback=\".concat(toGlobalFunc(callback));\n    invokeByIframe(scheme);\n    function callback(res) {\n      res = JSON.parse(res);\n      // 请求成功回调值\n      if (+res.status === 0) {\n        resolve(res.data);\n      }\n      // 请求失败\n      else {\n        var rejectData = {\n          status: res.status,\n          message: res.message\n        };\n        reject(rejectData);\n      }\n    }\n  });\n}\n\n/**\n *\n * @constructor ubc业务日志类\n * @description ubc业务日志类\n *\n * @example\n * new Ubclogger({\n *     serverId:123,\n *     idfrom:'res_fuli',\n *     page:'index'\n * })\n */\nvar UbcLogger$1 = /*#__PURE__*/function () {\n  /**\n   * Create a UbcLogger\n   *\n   * @class UbcLogger\n   * @param {Object} [options]                        初始化入参\n   * @param {number} [options.serverId]               活动serverId\n   * @param {string} [options.page]                   页面page名称\n   * @param {string} [options.type]                   打点type\n   * @param {string} [options.from]                   日志类型\n   * @param {Object} [options.queryParams]            ubcUrl上的query(appname,from,cfrom,smfw)\n   * @param {boolean} [options.testMode=false]        true走线下地址; false或者为空走线上ubc地址，目前日志平台采用新校验方式，不需要走线下地址\n   * @param {string} [options.testUrl]                打点数据上传地址;传入后，打点数据将发送至该地址\n   * @param {string} [options.source]                 资源位source\n   * @param {string} [options.idfrom]                 资源位idfrom(等价于资源位source，优先级更高)\n   * @param {boolean} [options.ifHeartbeatTime=true]  时长打点是否为心跳点，默认为true\n   * @param {boolean} [options.useSendBeacon=false]   使用SendBeacon API进行打点\n   * @param {Object} [options.logMergeOpt]            日志合并参数配置\n   * @param {Object} [options.logMergeOpt.ifAutoMerge] 是否开启自动合并，默认不开启\n   * @param {Object} [options.logMergeOpt.mergeNumMax] 最大日志合并数量\n   * @param {Object} [options.logMergeOpt.mergeInterval] 合并时间间隔\n   * @param {boolean} [options.logErrRetry]            是否开启日志重试\n   * @param {Object} [options.ext]               公共的ext参数，会被send的传参覆盖\n   *\n   *\n   */\n  function UbcLogger() {\n    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    _classCallCheck(this, UbcLogger);\n    // ubcLog\n    this.ubcParams = {};\n    // 是否初始化\n    this.logInited = false;\n    // set后的options\n    this.options = {};\n\n    // 时长打点\n    this.timerMap = new Map();\n    // 合并打点\n    this.mergeLogger = null;\n    // 打点重试机制\n    this.retryLogger = null;\n\n    // 当前宿主端是否是beta包\n    this.isBeta = false;\n    this._initUbcParams();\n    // 初始化设置参数\n    this.set(Object.assign({\n      duration: 3,\n      ifHeartbeatTime: true,\n      testMode: false,\n      useSendBeacon: false,\n      useXhr: false,\n      sendMethod: 'get',\n      apptype: getAppByName().appid\n    }, options));\n\n    // 注册页面可见性\n    this._registerPageVisibility();\n    this._registerBeta();\n  }\n\n  /**\n   * _initUbcParams\n   *\n   * @private\n   */\n  _createClass(UbcLogger, [{\n    key: \"_initUbcParams\",\n    value: function _initUbcParams() {\n      this.ubcParams = {};\n      this.ubcDefaultLogData = CONFIG.DEFAULT_LOG_DATA;\n      // merge默认数据\n      this.ubcParams = merge(this.ubcParams, this.ubcDefaultLogData);\n    }\n  }, {\n    key: \"_initCookie\",\n    value: function _initCookie() {\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      // 设置cookie\n      if (options.testMode) {\n        document.cookie = 'bd_logap_verify=1;domain=.baidu.com;path=/';\n      }\n    }\n\n    /**\n     * _initUbcUrl\n     *\n     * @private\n     * @param {Object} options  options入参\n     */\n  }, {\n    key: \"_initUbcUrl\",\n    value: function _initUbcUrl() {\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      // 获取ubcUrl\n      var query = options.queryParams || {};\n      if (this.isBeta) {\n        query = _objectSpread2({\n          beta: 1\n        }, query);\n      }\n\n      // 线下环境带上debug标示\n      if (options.testMode) {\n        query = _objectSpread2({\n          debug: 1\n        }, query);\n      }\n\n      // beta=1\n      this.ubcUrl = getUrl(options.testMode ? options.testUrl ? options.testUrl : CONFIG.UBC_URL : CONFIG.UBC_URL, merge(CONFIG.DEFAULT_QUERY, query));\n      this.ubcMergeUrl = getUrl(options.testMode ? options.testUrl ? options.testUrl : CONFIG_MERGE.UBC_URL : CONFIG_MERGE.UBC_URL, merge(CONFIG_MERGE.DEFAULT_QUERY, query));\n    }\n\n    /**\n     * set\n     * options可不填，缺省字段会以上次设置的为准\n     * @example\n     * ubclogger.set({\n     *     serverId:123,\n     *     idfrom:'res_fuli',\n     *     page:'index'\n     * })\n     * @param {Object} [options]                  初始化入参\n     * @param {number} [options.serverId]               活动serverId\n     * @param {string} [options.page]                   页面page名称\n     * @param {string} [options.from]                   日志类型\n     * @param {Object} [options.queryParams]            ubcUrl上的query(appname,from,cfrom,smfw)\n     * @param {string} [options.testMode]         true走校验模式; false或者为空走线上ubc地址\n     * @param {string} [options.testUrl]                打点数据上传地址;传入后，打点数据将发送至该地址（需要testMode=true）\n     * @param {string} [options.source]                 资源位source\n     * @param {string} [options.idfrom]                 资源位idfrom(等价于资源位source，优先级更高)\n     * @param {boolean} [options.ifHeartbeatTime]  时长打点是否为心跳点\n     * @param {boolean} [options.useSendBeacon]   使用SendBeacon API进行打点，默认false\n     * @param {boolean} [options.useXhr]   使用xhr进行打点,默认false\n     * @param {string} [options.sendMethod]   单条请求发送方式 get/post，默认get，配合useXhr使用\n     * @param {Object} [options.logMergeOpt]            日志合并参数配置\n     * @param {boolean} [options.logMergeOpt.ifAutoMerge] 是否开启自动合并，默认不开启\n     * @param {number} [options.logMergeOpt.mergeNumMax] 最大日志合并数量。默认5条\n     * @param {number} [options.logMergeOpt.mergeInterval] 合并时间间隔，默认5s,单位s\n     * @param {boolean} [options.logErrRetry]            是否开启日志重试\n     * @param {Object} [options.ext]               公共的ext参数，会被send的传参覆盖\n     *\n     */\n  }, {\n    key: \"set\",\n    value: function set() {\n      var _this = this;\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      this.options = _objectSpread2(_objectSpread2({}, this.options), options);\n      this._initCookie(this.options);\n      this._initUbcUrl(this.options);\n\n      // 配置serverId,source(idfrom),page\n      this.ubcParams = merge(this.ubcParams, {\n        actiondata: {\n          id: this.options.serverId,\n          content: {\n            source: this.options.source || this.options.idfrom || getUrlQuery('source') || getUrlQuery('idfrom'),\n            page: this.options.page,\n            from: this.options.from,\n            type: this.options.type,\n            ext: _objectSpread2({\n              apptype: this.options.apptype\n            }, this.options.ext)\n          }\n        }\n      });\n      if (+this.options.serverId) {\n        this.logInited = true;\n      }\n      // 初始化mergeLogger\n      if (!this.mergeLogger) {\n        this.mergeLogger = new MergeLogger({\n          logFn: function logFn(paramsList) {\n            return _this._sendMerge(paramsList, {\n              useXhr: true,\n              sendMethod: 'post'\n            });\n          }\n        });\n      }\n      if (this.options.logMergeOpt) {\n        // 修改mergeLogger选项\n        this.mergeLogger.set(this.options.logMergeOpt);\n      }\n\n      // 初始化retryLogger\n      if (this.options.logErrRetry && !this.retryLogger) {\n        this.retryLogger = new RetryLogger({\n          logFn: function logFn(url, logData) {\n            logData.actiondata.metadata.uploadTimeStamp = Date.now();\n            return smartSend(url, logData, {\n              useXhr: true\n            });\n          }\n        });\n      }\n    }\n\n    /**\n     * 发送普通点\n     * @private\n     * @param  {Object} params  打点自定义参数\n     * @param  {Object} options 额外参数\n     * @param  {boolean} options.useSendBeacon 是否使用SendBeacon API发送请求\n     * @param  {boolean} [options.useXhr] 是否使用Xhr发送请求\n     * @param  {string} [options.sendMethod] 单条请求发送方式 get/post，默认get，配合useXhr使用\n     * @return {Promise} promise 打点成功发送返回then\n     */\n  }, {\n    key: \"_send\",\n    value: function _send() {\n      var _this2 = this;\n      var params = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var logData = {};\n      var now = Date.now();\n      // 事件打点正常处理\n      var baiduId = getCookieByName('BAIDUID');\n      if (baiduId && this.options.logErrRetry) {\n        // 获得没有加metadata的logData\n        logData = merge(this.ubcParams, {\n          actiondata: {\n            timestamp: now,\n            content: params\n          }\n        });\n        // 通过baiduId和logData计算摘要值（logData里面已经包含了当前时间戳）\n        var loggerId = sha256(baiduId + JSON.stringify(logData));\n        logData.actiondata.metadata = {\n          md5: loggerId,\n          uploadTimeStamp: now\n        };\n        return smartSend(this.ubcUrl, logData, _objectSpread2(_objectSpread2({}, options), {}, {\n          useXhr: true\n        })).then(function (data) {\n          // 打点成功后通知retryLogger\n          _this2.retryLogger.active();\n          return data;\n        })[\"catch\"](function (err) {\n          //向队列中加一条日志\n          _this2.retryLogger.addLog({\n            url: _this2.ubcUrl,\n            loggerData: logData,\n            loggerId: loggerId\n          });\n          return Promise.reject(err);\n        });\n      } else {\n        logData = merge(this.ubcParams, {\n          actiondata: {\n            timestamp: now,\n            content: params\n          }\n        });\n        return smartSend(this.ubcUrl, logData, options);\n      }\n    }\n\n    /**\n     * 发送合并点\n     * @private\n     * @param  {Array} paramsList  打点自定义参数\n     * @param  {Object} options 额外参数\n     * @param  {boolean} [options.useSendBeacon] 是否使用SendBeacon API发送请求\n     * @param  {boolean} [options.useXhr] 是否使用Xhr发送请求\n     * @param  {string} [options.sendMethod] 单条请求发送方式 get/post，默认get，配合useXhr使用\n     * @return {Promise} promise 打点成功发送返回then\n     */\n  }, {\n    key: \"_sendMerge\",\n    value: function _sendMerge() {\n      var paramsList = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var logData = {};\n      var now = Date.now();\n      // 事件打点正常处理\n      var actiondata = this.ubcParams.actiondata;\n      var data = paramsList.map(function (params) {\n        var tempLogData = merge(actiondata, {\n          timestamp: now,\n          content: params\n        });\n        return tempLogData;\n      });\n      logData = _objectSpread2(_objectSpread2({}, CONFIG_MERGE.DEFAULT_LOG_DATA), {}, {\n        data: data\n      });\n      return smartSend(this.ubcMergeUrl, logData, options);\n    }\n\n    /**\n     * 发送流式点\n     * @private\n     * @param  {Object} params  打点自定义参数\n     * @param  {Object} timing  时长相关参数\n     * @param  {Object} options 额外参数\n     * @param  {boolean} options.useSendBeacon 是否使用SendBeacon API发送请求\n     * @return {Promise} promise 打点成功发送返回then\n     */\n  }, {\n    key: \"_sendFlow\",\n    value: function _sendFlow() {\n      var params = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var timing = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      // 流式打点参数处理\n      var logData = this._getFlowData(params, timing);\n      return smartSend(this.ubcUrl, logData, options);\n    }\n\n    /**\n     * send\n     * @example\n     * ubclogger.send({\n     *     page: 'y_ent_login',\n     *     type: 'login_clk',\n     *     value: 'login',\n     *     ext: {\n     *         p1: 'login'\n     *     }\n     * })\n     * @param  {Object} params  打点自定义参数\n     * @param  {Object} [options] 额外选项\n     * @param  {boolean} [options.useSendBeacon] 是否使用SendBeacon API发送请求\n     * @param  {boolean} [options.useXhr] 是否使用Xhr发送请求\n     * @param  {string} [options.sendMethod] 单条请求发送方式 get/post，默认get，配合useXhr使用\n     * @return {Promise} promise 打点成功发送返回then\n     */\n  }, {\n    key: \"send\",\n    value: function send() {\n      var _this$options, _this$options$logMerg;\n      var params = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var options = arguments.length > 1 ? arguments[1] : undefined;\n      if (!this.logInited) {\n        throw 'UBC SDK serverId can not be empty!';\n      }\n      options = _objectSpread2({\n        useSendBeacon: this.options.useSendBeacon,\n        useXhr: this.options.useXhr,\n        options: this.options.sendMethod\n      }, options);\n      if ((_this$options = this.options) !== null && _this$options !== void 0 && (_this$options$logMerg = _this$options.logMergeOpt) !== null && _this$options$logMerg !== void 0 && _this$options$logMerg.ifAutoMerge) {\n        this.mergeLogger.add(params);\n        return Promise.resolve();\n      } else {\n        return this._send(params, options);\n      }\n    }\n\n    /**\n     * sendMergeLog\n     * @example\n     * ubclogger.sendMergeLog({\n     *     page: 'y_ent_login',\n     *     type: 'login_clk',\n     *     value: 'login',\n     *     ext: {\n     *         p1: 'login'\n     *     }\n     * })\n     * @param  {Object} params  打点自定义参数\n     * @return {Promise} promise 打点成功发送返回then\n     */\n  }, {\n    key: \"sendMergeLog\",\n    value: function sendMergeLog() {\n      var params = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      if (!this.logInited) {\n        throw 'UBC SDK serverId can not be empty!';\n      }\n      this.mergeLogger.add(params);\n      return Promise.resolve();\n    }\n\n    /**\n     * _getFlowData\n     *\n     * @private\n     * @see 流式打点字段格式：http://wiki.baidu.com/pages/viewpage.action?pageId=337347739#id-%E6%97%A5%E5%BF%97%E8%A7%84%E8%8C%83-2.3.3%E6%B5%81%E7%B1%BB%E5%9E%8B%E6%97%A5%E5%BF%97%E5%AD%97%E6%AE%B5%E8%A7%84%E8%8C%83%E2%80%94%E6%97%B6%E9%95%BF\n     * @param {Object} content 打点自定义参数\n     * @param {Object} timing 时长相关参数\n     * @return {Object} logData 打点数据\n     */\n  }, {\n    key: \"_getFlowData\",\n    value: function _getFlowData(content, timing) {\n      var _this$ubcParams, _this$ubcParams$actio;\n      var resultLogData = {};\n      var starttime = timing.starttime,\n        duration = timing.duration,\n        endtime = timing.endtime;\n      var now = Date.now();\n\n      // 将this.ubcParams?.actiondata?.content 里面 向下移动到 resultLogData.actiondata?.content.option\n      resultLogData = merge(this.ubcParams, {\n        actiondata: {\n          content: '-'\n        }\n      });\n      resultLogData = merge(resultLogData, {\n        actiondata: {\n          timestamp: now,\n          starttime: starttime,\n          endtime: endtime,\n          type: 1,\n          content: {\n            duration: duration,\n            option: merge((_this$ubcParams = this.ubcParams) === null || _this$ubcParams === void 0 ? void 0 : (_this$ubcParams$actio = _this$ubcParams.actiondata) === null || _this$ubcParams$actio === void 0 ? void 0 : _this$ubcParams$actio.content, content)\n          }\n        }\n      });\n      return resultLogData;\n    }\n\n    /**\n     * startTimingLog 开始\n     * @example\n     * ubclogger.startTimingLog('timing1',{\n     *     page: 'y_ent_login',\n     *     type: 'login_clk',\n     *     value: 'login',\n     *     ext: {\n     *         p1: 'login'\n     *     }\n     * })\n     * @example\n     * ubclogger.startTimingLog('timing1',{\n     *     page: 'y_ent_login',\n     * },{\n     *     useSendBeacon: true\n     * }\n     * @param  {*} [label=default]  时长打点必须拥有唯一的名字，默认default\n     * @param  {Object} [params]  打点自定义参数\n     * @param  {Object} [options]  打点设置，覆盖全局设置\n     * @param  {boolean} [options.ifHeartbeatTime]  是否通过心跳打点\n     * @param  {boolean} [options.useSendBeacon]  是否使用 SendBeacon API\n     * @param  {number} [options.duration]  心跳打点的间隔，单位s\n     */\n  }, {\n    key: \"startTimingLog\",\n    value: function startTimingLog() {\n      var _this3 = this;\n      var label = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'default';\n      var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var options = arguments.length > 2 ? arguments[2] : undefined;\n      var timer = this.timerMap.get(label);\n      // 如果不存在时长打点，则创建一个打点\n      if (!timer) {\n        timer = new TimeLogger(_objectSpread2(_objectSpread2({\n          ifHeartbeatTime: this.options.ifHeartbeatTime,\n          duration: this.options.duration\n        }, options), {}, {\n          // 根据时长相关参数，发送打点\n          logFn: function logFn(timing) {\n            _this3._sendFlow(params, timing, _objectSpread2({\n              useSendBeacon: _this3.options.useSendBeacon\n            }, options));\n          }\n        }));\n        this.timerMap.set(label, timer);\n      }\n      if (timer.flag === 'RUNNING') {\n        console.warn(\"timeLogger[\".concat(label, \"] is running\"));\n        return;\n      }\n      timer.start();\n    }\n\n    /**\n     * pauseTimingLog 停止打点,保留该时长点的参数,可被重新启动\n     * @example\n     * ubclogger.pauseTimingLog('timing1');\n     * @param {*} [label=default]  时长打点必须拥有唯一的名字，默认default\n     */\n  }, {\n    key: \"pauseTimingLog\",\n    value: function pauseTimingLog() {\n      var label = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'default';\n      var timer = this.timerMap.get(label);\n      if (timer) {\n        timer.stop();\n      }\n    }\n\n    /**\n     * stopTimingLog 停止时长计算\n     * @example\n     * ubclogger.stopTimingLog('timing1');\n     * @param {*} [label=default]  时长打点必须拥有唯一的名字，默认default\n     */\n  }, {\n    key: \"stopTimingLog\",\n    value: function stopTimingLog() {\n      var label = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'default';\n      var timer = this.timerMap.get(label);\n      if (timer) {\n        timer.stop();\n        this.timerMap[\"delete\"](label);\n      }\n    }\n\n    /**\n     * _registerPageVisibility 在页面切换时暂停时长计算\n     * @private\n     * @desc 页面展现begin\n     * @desc 页面离开/切后台end\n     */\n  }, {\n    key: \"_registerPageVisibility\",\n    value: function _registerPageVisibility() {\n      var _this4 = this;\n      regestPageVisibilityEvent(function (isHidden) {\n        if (isHidden) {\n          _this4.timerMap.forEach(function (timer) {\n            if (timer && timer.flag === 'RUNNING') {\n              timer.autoStop();\n            }\n          });\n          _this4.mergeLogger && _this4.mergeLogger.clearAll();\n        } else {\n          _this4.timerMap.forEach(function (timer) {\n            if (timer && timer.flag === 'AUTO_STOP') {\n              timer.start();\n            }\n          });\n        }\n      });\n    }\n\n    /**\n     * getVersion 获得当前sdk版本\n     * @return {string} 当前sdk版本\n     */\n  }, {\n    key: \"getVersion\",\n    value: function getVersion() {\n      return version;\n    }\n  }, {\n    key: \"_registerBeta\",\n    value: function _registerBeta() {\n      var _this5 = this;\n      // 只在手百中加入判断灰度包的逻辑\n      if (isBox() && !isSwan()) {\n        isBeta().then(function (res) {\n          if (res !== null && res !== void 0 && res.isBeta) {\n            _this5.isBeta = true;\n            // 修改ubc url\n            _this5.set();\n          }\n        })[\"catch\"](function () {\n          // safe\n          // 不支持这个schema，或者非手百，不做任何操作\n        });\n      }\n    }\n  }]);\n  return UbcLogger;\n}();\n\n/**\n * @file es 文件入口\n * @author changyuqing@baidu.com\n */\nvar UbcLogger = UbcLogger$1;\nvar ubcLogger = new UbcLogger$1();\n\nexport { UbcLogger, ubcLogger };\n"]}]}
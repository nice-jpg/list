/**
 * @file onVisibilitychange
 * @author zhangtingting12 <zhangtingting12@baidu.com>
 */

/**
 * 视图可见状态切换
 * @param {object} 页面可见回调，及不可见回调
 */
export default ({showCb, hiddenCb, show, hidden, hide}) => {
    showCb = showCb || show;
    hiddenCb = hiddenCb || hidden || hide;
    let state = '';
    let visibilityChange = '';
    if (typeof document.visibilityState !== 'undefined') {
        state = 'visibilityState';
        visibilityChange = 'visibilitychange';
    }
    else if (typeof document.webkitVisibilityState !== 'undefined') {
        state = 'webkitVisibilityState';
        visibilityChange = 'webkitvisibilitychange';
    }

    if (!visibilityChange) {
        /* eslint-disable no-console */
        console.log('browser donot supports the Page Visibility API.');
        /* eslint-enable no-console */
        return;
    }
    // safari 7 和其他现代浏览器生效 android 4.4及以上生效
    document.addEventListener(visibilityChange, () => {
        if (document[state] === 'visible') {
            showCb && showCb();
        }
        else {
            hiddenCb && hiddenCb();
        }
    }, false);
};

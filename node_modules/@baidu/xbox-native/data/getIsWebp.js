/**
 * @file 获取是否支持 webp
 * @module data
 * @author wangyongqing <wangyongqing01@baidu.com>
 */

import register from '../register';
import {get} from './index';
import versionCompare from '@baidu/xbox/version_compare';
import getBoxVersion from '@baidu/xbox/get-box-version';
const boxVersion = getBoxVersion();

register('feed/getIsWebp', {
    v: 10,
    hasCB: true,
    versionRange: ['9.0.5'],
    notSupport: ['ios'],
    notSupportFrame: ['search'],
    androidliteVersionRange: ['3.6'],
    iosinfoVersionRange: ['1.3.1.10'],
    iosmissionVersionRange: ['1.0'],
    androidmissionVersionRange: ['1.0'],
    filter() {
        return {
            module: 'feed',
            action: 'isWebp'
        };
    },
    thunk(res) {
        if (versionCompare(boxVersion, '9.2') >= 0 || !!res.status) {
            let data;
            if (res.status === '0') {
                data = res.data.result;
            } else {
                data = {};
            }
            return {
                status: res.status,
                data: data,
                message: res.message
            };
        }

        return {
            status: 0,
            data: res.result
        };
    }
});
/**
 * getIsWebp
 * @function getIsWebp
 */
export default () =>
    get({
        name: 'feed-isWebp'
    });

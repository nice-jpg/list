
/**
 * @file Created on Thu Nov 15 2018
 * @module data
 * @author wangyongqing <wangyongqing01@baidu.com>
 */

import register from '../register';
import {get} from './index';
import {getParams} from '../utils';
import {prompt as androidCmd} from '../android';
import iosInvoke from '../ios';
import {isMatrix, isIOS} from '../detect';
import stringify from '../stringify';

register('utils/getFavorInfo', {
    androidlite: {
        versionRange: ['2.2.2']
    },
    androidinfo: {
        versionRange: ['1.0']
    },
    iosinfo: {
        versionRange: ['1.1']
    },
    androidmission: {
        versionRange: ['1.0']
    },
    iosmission: {
        versionRange: ['1.0']
    },
    ios: {
        versionRange: ['8.1'],
        hasCB: false,
        filter(module, action, data) {
            return {
                module: 'Common',
                action: 'updateFavorInfo',
                extData: {
                    minver: '8.1.0.0'
                }
            };
        }
    },
    android: {
        versionRange: ['7.7'],
        hasCB: false,
        filter(module, action, data) {
            return {
                module: 'Bdbox_android_utils',
                action: 'updateCollectionStatus'
            };
        }
    }
});
/**
 * 获取 getFavorInfo
 * @function getFavorInfo
 */
export default (data = {}) => {
    if (isMatrix('baiduboxvision')) {
        if (isIOS()) {
            return iosInvoke(`baiduboxapp://Common?action=updateFavorInfo&params=${stringify(data, true)}`);
        } else {
            androidCmd('Bdbox_android_utils', 'updateCollectionStatus', [stringify(data)]);
        }
    }

    return get(getParams('utils-favorInfo', data));
};

# fs-danmaku-h-mo

移动端水平弹幕组件

## 入参

| 属性              | 是否必须 | 说明                           | 类型          | 默认值 |
| ----------------- | -------- | ------------------------------ | ------------- | ------ |
| list              | 必须     | 初始弹幕列表                   | DanmakuItem[] | `[]`   |
| speed             | 非必须   | 动画速度                       | number        | `75`   |
| sourceData        | 必须     | 弹幕点赞、弹幕发布接口所需参数 | SourceData    | `-`    |
| commentTip        | 非必须   | 发布器引导文案                 | string        | `-`    |
| publisherBtnStyle | 非必须   | 发布器按钮样式                 | string        | `-`    |
| publisherStyle    | 非必须   | 发布器样式                     | string        | `-`    |
| isGray            | 非必须   | 是否置灰                       | boolean       | false  |

### 单条弹幕 DanmakuItem

| 名称      | 是否必须 | 说明               | 类型    | 默认值 |
| --------- | -------- | ------------------ | ------- | ------ |
| replyId   | 必须     | 弹幕 id            | string  | -      |
| content   | 必须     | 弹幕内容           | string  | -      |
| uname     | 非必须   | 用户名             | string  | -      |
| avatar    | 必须     | 用户头像           | string  | -      |
| isUped    | 必须     | 是否已点赞         | boolean | false  |
| likeCount | 非必须   | 点赞数             | string  | 0      |
| isSelf    | 非必须   | 是否是用户本人发的 | boolean | -      |
| listUrl   | 非必须   | 点击调转 url       | string  | -      |

### SourceData

| 名称     | 是否必须 | 说明      | 类型   | 默认值 |
| -------- | -------- | --------- | ------ | ------ |
| source   | ''       | 打点用    | string | -      |
| appid    | true     | appid     | string | -      |
| threadid | true     | thread_id | string | -      |

## 事件

| 事件                         | 说明                     | 函数签名                                                                                 |
| ---------------------------- | ------------------------ | ---------------------------------------------------------------------------------------- |
| LIKE_DANMAKU_H_MO_SUCCESS    | 单条弹幕点赞成功         | eventDispatch(LIKE_DANMAKU_H_MO_SUCCESS, payload: LIKE_DANMAKU_H_MO_PAYLOAD): void       |
| LIKE_DANMAKU_H_MO_ERROR      | 单条弹幕点赞失败         | eventDispatch(LIKE_DANMAKU_H_MO_ERROR, payload: LIKE_DANMAKU_H_MO_PAYLOAD): void         |
| PUBLISH_DANMAKU_H_MO_SUCCESS | 弹幕发布成功             | eventDispatch(PUBLISH_DANMAKU_H_MO_SUCCESS, payload: PUBLISH_DANMAKU_H_MO_PAYLOAD): void |
| PUBLISH_DANMAKU_H_MO_ERROR   | 弹幕发布失败             | eventDispatch(PUBLISH_DANMAKU_H_MO_ERROR, payload: PUBLISH_DANMAKU_H_MO_PAYLOAD): void   |
| PUBLISH_DANMAKU_H_MO         | 弹幕发布（点击发布按钮） | eventDispatch(PUBLISH_DANMAKU_H_MO, payload: PUBLISH_DANMAKU_H_MO_PAYLOAD): void         |
| PULISHER_DANMAKU_H_MO_AROUSE | 弹幕发布框调起           | eventDispatch(PULISHER_DANMAKU_H_MO_AROUSE): void                                        |
| CLICK_DANMAKU_H_ITEM_MO      | 单条弹幕点击             | eventDispatch(CLICK_DANMAKU_H_ITEM_MO, payload: CLICK_DANMAKU_H_ITEM_MO_PAYLOAD): void   |
| SHOW_DANMAKU_H_MO            | 弹幕展现事件             | eventDispatch(SHOW_DANMAKU_H_MO): void                                                   |

## 实例

```typescript
// 引入
import {Component} from 'san';
import DanmakuH, {
    CLICK_DANMAKU_H_ITEM_MO,
    CLICK_DANMAKU_H_ITEM_MO_PAYLOAD,
    LIKE_DANMAKU_H_MO_ERROR,
    LIKE_DANMAKU_H_MO_PAYLOAD,
    LIKE_DANMAKU_H_MO_SUCCESS,
    PUBLISH_DANMAKU_H_MO_ERROR,
    PUBLISH_DANMAKU_H_MO_PAYLOAD,
    PUBLISH_DANMAKU_H_MO_SUCCESS,
    PULISHER_DANMAKU_H_MO_AROUSE,
    PUBLISH_DANMAKU_H_MO,
    SHOW_DANMAKU_H_MO
} from '@baidu/fs-danmaku-h-mo';

// 方法
export default class Demo extends Component {
    static template = /* html */ `
        <danmaku-h
            speed="{{speed}}"
            list="{{list}}"
            source-data="{{sourceData}}"
        />
    `;

    static components = {
        'danmaku-h': DanmakuH
    };

    static messages: I.Messages = {
        [LIKE_DANMAKU_H_MO_SUCCESS]({value}:{value: LIKE_DANMAKU_H_MO_PAYLOAD}) {
            // 点赞成功事件处理
        };
        [LIKE_DANMAKU_H_MO_ERROR]({value}:{value: LIKE_DANMAKU_H_MO_PAYLOAD}) {
            // 点赞失败事件处理
        };
        [PUBLISH_DANMAKU_H_MO_SUCCESS]({value}:{value: PUBLISH_DANMAKU_H_MO_PAYLOAD}) {
            // 发布事件成功处理
        };
        [PUBLISH_DANMAKU_H_MO_ERROR]({value}:{value: PUBLISH_DANMAKU_H_MO_PAYLOAD}) {
            // 发布失败事件处理
        };
        [PUBLISH_DANMAKU_H_MO]({value}:{value: PUBLISH_DANMAKU_H_MO_PAYLOAD}) {
            // 点击发送按钮事件
        };
        [PULISHER_DANMAKU_H_MO_AROUSE]() {
            // 调起发布框
        };
        [SHOW_DANMAKU_H_MO]() {
            // 弹幕展现事件
        };
        [CLICK_DANMAKU_H_ITEM_MO]({value}:{value: CLICK_DANMAKU_H_ITEM_MO_PAYLOAD}) {
            // 单条弹幕点击事件
        };
    };

    initData() {
        return {
            list: [],
            speed: 75,
            publisherStyle: '',
            publisherBtnStyle: '',
            commentTip: '',
            sourceData: {
                appid: '21515138',
                threadid: '1070000044969715',
            },
        };
    }
}
```

## 调试

项目根目录执行 `yarn preview fs-danmaku-h-mo --mo`

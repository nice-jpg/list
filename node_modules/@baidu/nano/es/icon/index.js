/**
 * @file 组件 icon 图标
 * @author baozhixin <baozhixin@baidu.com>
 */

import './style/index.less';
import {Component, DataTypes} from 'san';
import isNumeric from '../utils/is-numeric';
import pr2rem from '../utils/pr2rem';

const prefixCls = 's-icon';
const sizeType = [
    'xs', // 54pr
    'sm', // 66pr
    'md', // 78pr
    'lg', // 90pr
    'xl', // 102pr
    'xxl' // 120pr
];

export default class Icon extends Component {
    // eslint-disable-next-line
    static template = /*html*/ `
        <svg class="{{iconClass}}" style="{{iconStyle}}">
            {{use | raw}}
        </svg>
    `;

    static dataTypes = {
        color: DataTypes.string,
        size: DataTypes.oneOfType([
            DataTypes.number,
            DataTypes.oneOf(sizeType)
        ]),
        type: DataTypes.string
    };

    static computed = {
        iconClass() {
            const size = this.data.get('size');
            return [
                prefixCls,
                `${prefixCls}-${size}`
            ];
        },
        iconStyle() {
            let ret = {};
            const color = this.data.get('color');
            const size = this.data.get('size');
            if (color) {
                ret.color = color;
            }
            if (isNumeric(size)) {
                const width = `${pr2rem(size)}rem`;
                ret.width = ret.height = width;
            }
            return ret;
        },
        use() {
            const type = this.data.get('type');
            return `<use xlink:href="#${type}"/>`;
        }
    };

    initData() {
        return {
            size: 'lg'
        };
    }
}

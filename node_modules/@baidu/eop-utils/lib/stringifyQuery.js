"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.stringifyQuery = void 0;

var _stringifyArgs = require("./stringifyArgs");

var _toGlobalFunc = require("./toGlobalFunc");

var _getVariableType = require("./getVariableType");

/**
 * @file 将 query 请求对象字符串化
 * @author weijiaxun <weijiaxun@baidu.com>
 */

/**
 * 将 query 请求对象中的 value 全部转换成 string 类型
 *
 * @param {Object} query query 对象
 * @param {boolean} stringify 是否使用 JSON.stringify 处理 value 中的对象
 * @return {Object} 转换后的 query 对象
 */
var stringifyQuery = function stringifyQuery(query, stringify) {
  if (query === void 0) {
    query = {};
  }

  if (stringify === void 0) {
    stringify = true;
  }

  return Object.keys(query).reduce(function (result, key) {
    var value = query[key];

    switch ((0, _getVariableType.getVariableType)(value)) {
      case 'null':
      case 'undefined':
        result[key] = '';
        break;

      case 'array':
        result[key] = stringify ? JSON.stringify((0, _stringifyArgs.stringifyArgs)(value, false)) : (0, _stringifyArgs.stringifyArgs)(value, false);
        break;

      case 'object':
        result[key] = stringify ? JSON.stringify(stringifyQuery(value, false)) : stringifyQuery(value, false);
        break;

      case 'function':
        result[key] = (0, _toGlobalFunc.toGlobalFunc)(value);
        break;

      default:
        result[key] = value;
    }

    return result;
  }, {});
};

exports.stringifyQuery = stringifyQuery;
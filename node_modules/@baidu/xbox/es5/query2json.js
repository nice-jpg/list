"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _decodeUriComponent = _interopRequireDefault(require("./decode-uri-component"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

/**
 * @file 对传入url query 部分转成json格式
 * @author wangyongqing <wangyongqing01@baidu.com>
 */

/**
 * 对传入url query 部分转成json格式
 * @function query2json
 * @param {string} url  - 待处理的url
 * @param {boolean} [safe = true]- 是否启用安全 decode 模式，默认 true
 * @return {Object} obj - 返回处理后的json
 */
var _default = function _default(url) {
  var safe = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;
  var locse = url.split('?');
  var search = locse[1] ? locse[1] : locse[0];
  var pairs = search.split('&');
  var result = {};
  pairs.forEach(function (pair) {
    pair = pair.split('=');

    if (pair[0].length > 0) {
      var resultPair = '';

      try {
        resultPair = (safe ? (0, _decodeUriComponent.default)(pair[1]) : decodeURIComponent(pair[1])) || '';
      } catch (e) {
        console.log(e);
      }

      result[pair[0]] = resultPair;
    }
  });
  return result;
};

exports.default = _default;
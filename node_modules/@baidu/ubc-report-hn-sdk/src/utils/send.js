/**
 * @file send 方法
 * @author wangbing11(wangbing11@baidu.com)
 */
import axios from "axios";

/**
 * 使用图片来发请求
 *
 * @param {string} url 上报服务地址
 * @param {Object} logData 上报的数据
 * @param {Object} [options] 额外参数
 * @param {Object} [options.useSendBeacon] 是否使用sendBeancon
 * @param {Object} [options.useXhr] 是否使用useXhr
 * @return {Promise} 结束回调
 */
export function smartSend(url, logData, options = {}) {
    let method = 'get';
    let params = {data: logData};
    let data = {};
    let axiosParams = options.axiosParams || {};
    if ((axiosParams.method + '').toLowerCase() === 'post') {
        method = 'post';
        data = 'data=' + encodeURIComponent(JSON.stringify(logData));
        params = {};
    }
    return axios({
        headers: {
            'Content-Type': 'application/x-www-form-urlencoded',
        },
        url,
        method,
        params,
        data,
        ...axiosParams
    });
}

/**
 * @file 公共方法
 * @author okaychen<chenglong13@baidu.com>
 */
const toString = Object.prototype.toString;

export const getTag = <T>(value: T): String => {
    if (value == null) {
        return value === undefined ? '[object Undefined]' : '[object Null]';
    }
    return toString.call(value);
}

export const isObjectLike = <T>(value: T): Boolean => {
    return typeof value === 'object' && value !== null;
}

/**
 * 是否为string原始类型
 */
export const isString = <U>(value: U): Boolean => {
    const type = typeof value;
    return type === 'string'
        || (type === 'object'
            && value != null
            && !Array.isArray(value)
            && getTag(value) == '[object String]'
        );
}

/**
 * 是否为普通对象
 */
export const isPlainObject = <P>(value: P): Boolean => {
    if (!isObjectLike(value) || getTag(value) != '[object Object]') {
        return false;
    }
    if (Object.getPrototypeOf(value) === null) {
        return true;
    }
    let proto = value;
    while (Object.getPrototypeOf(proto) !== null) {
        proto = Object.getPrototypeOf(proto);
    };
    return Object.getPrototypeOf(value) === proto;
}
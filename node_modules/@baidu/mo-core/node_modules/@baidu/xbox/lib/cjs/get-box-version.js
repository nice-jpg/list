"use strict";
/**
 * @file 获取手百版本
 * @author wangyongqing01
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.getVersion = exports.getMainVersion = exports.getBoxVersion = void 0;
var get_global_object_1 = require("./get-global-object");
var is_box_1 = require("./is-box");
var is_matrix_1 = require("./is-matrix");
var ua_1 = require("./ua");
/**
 * 获取手百的版本号
 *
 * @param [subName=''] 手百矩阵产品标识，取值如：''|lite|pro|info
 * @param ua 传入的 userAgent，如果不传则取 navigator.userAgent
 * @return 返回手百的版本号
 * @example
 * getBoxVersion('lite') // 2.0.1
 * getBoxVersion() // 11.1.0
 */
function getBoxVersion(subName, ua) {
    if (subName === void 0) { subName = ''; }
    if (ua === void 0) { ua = ua_1.UA; }
    if (subName === 'main') {
        subName = '';
    }
    if (get_global_object_1.globalObject === null || get_global_object_1.globalObject === void 0 ? void 0 : get_global_object_1.globalObject.baiduboxapp_version) {
        return get_global_object_1.globalObject.baiduboxapp_version;
    }
    if ((0, is_box_1.isBox)(subName, ua) || (0, is_matrix_1.isMatrix)(subName, ua)) {
        var res = /(baiduboxapp|baiduboxvision)\/([\d.]+)/.exec(ua);
        if (res) {
            return res[2];
        }
        else if ((res = /([\d+.]+)_(?:diordna|enohpi)_/.exec(ua))) {
            // 老版本手百
            return res[1].split('.').reverse().join('.');
        }
    }
    return '0';
}
exports.getBoxVersion = getBoxVersion;
/**
 * 获取大版本号
 */
function getMainVersion(str, subName, ua) {
    if (subName === void 0) { subName = ''; }
    if (ua === void 0) { ua = ua_1.UA; }
    str = str || getBoxVersion(subName, ua);
    if (str && typeof str === 'string') {
        var match = /\d+\.\d+/.exec(str);
        if (match) {
            return match[0];
        }
    }
    return 0;
}
exports.getMainVersion = getMainVersion;
/**
 * 获取手百版本，不建议使用，因为不区分手百矩阵产品
 */
function getVersion() {
    console.warn("[xbox/getVersion]\u4E0D\u5EFA\u8BAE\u4F7F\u7528\uFF0C\u56E0\u4E3A\u4E0D\u80FD\u533A\u5206\u662F\u4EC0\u4E48\u7248\u672C\u624B\u767E\n\u8BF7\u4F7F\u7528 getBoxVersion(subName) \u65B9\u6CD5\n    ");
    var pro = getBoxVersion('pro');
    var lite = getBoxVersion('lite');
    var info = getBoxVersion('info');
    var mission = getBoxVersion('mission');
    var main = getBoxVersion();
    return pro || info || lite || mission || main;
}
exports.getVersion = getVersion;

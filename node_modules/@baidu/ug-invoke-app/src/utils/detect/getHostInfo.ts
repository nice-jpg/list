/**
 * @file ua parser
 * @author zhangsiyuan(zhangsiyuan@baidu.com)
 */
import {Browser, browserMap} from '../../config/app/browserMap';
import {Brand, brandMap} from '../../config/app/brandMap';
import {IS_ANDROID, IS_IOS} from './os';

export type Os = 'ios' | 'android' | '-';

export function getHostInfo() {
    const ua = navigator.userAgent;
    const os = IS_IOS ? 'ios' : IS_ANDROID ? 'android' : '-';
    // 返回值默认-
    const res: {browser: Browser, brand: Brand, os: Os} = {
        browser: '-',
        brand: '-',
        os,
    };
    // 正则匹配一下browser name
    for (const [browser, browserReg] of browserMap) {
        if (browserReg.test(ua)) {
            res.browser = browser;
            break;
        }
    }

    // 正则匹配一下brand
    for (let [brand, brandReg] of Object.entries(brandMap) as Array<[Brand, RegExp]>) {
        if (brandReg.test(ua)) {
            res.brand = brand;
            break;
        }
    }
    return res;
}

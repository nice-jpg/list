module.exports = function () {
  /**
  * @file
  * @author renzhonghua
  */

  /* istanbul ignore next */
  var invoke = require("boxjs/dist/core/invoke");
  /* istanbul ignore next */


  return {
    delete: function (key, value, abtest) {
      /* istanbul ignore next */
      var data = {
        key: key,
        data: encodeURIComponent(JSON.stringify(value))
      };
      /* istanbul ignore next */

      return invoke('storage/delete', data, abtest);
    },
    get: function (key, domain, abtest) {
      /* istanbul ignore next */
      var data = {
        key: key,
        domain: domain
      };
      /* istanbul ignore next */

      return invoke('storage/get', data, abtest);
    },
    set: function (key, value, domain, abtest) {
      /* istanbul ignore next */
      var data = {
        key: key,
        data: JSON.stringify(value),
        // setstorage加上encodeURIComponent会导致无法执行callback
        trustedDomains: domain
      };
      /* istanbul ignore next */

      return invoke('storage/set', data, abtest);
    }
  };
}();